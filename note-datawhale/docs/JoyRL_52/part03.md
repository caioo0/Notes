# æ·±åº¦å­¦ä¹ åŸºç¡€

> ï¼ˆæœ¬å­¦ä¹ ç¬”è®°æ¥æºäºŽDataWhale-ç¬¬52æœŸç»„é˜Ÿå­¦ä¹ ï¼š[å¼ºåŒ–å­¦ä¹ ](https://linklearner.com/datawhale-homepage/#/learn/detail/91)ï¼‰ , [Bç«™è§†é¢‘è®²è§£](https://www.bilibili.com/video/BV1HZ4y1v7eX) è§‚çœ‹åœ°å€

## æ·±åº¦å­¦ä¹ å’Œå¼ºåŒ–å­¦ä¹ 

å¼ºåŒ–å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„ç»“åˆé€šå¸¸è¢«ç§°ä¸ºæ·±åº¦å¼ºåŒ–å­¦ä¹ ï¼ˆDeep Reinforcement Learning, DRLï¼‰ã€‚

æ·±åº¦å­¦ä¹ è¢«ç”¨æ¥è¡¨ç¤ºå’Œå­¦ä¹ æ™ºèƒ½ä½“çš„ç­–ç•¥æˆ–è€…çŽ¯å¢ƒæ¨¡åž‹

è€Œå¼ºåŒ–å­¦ä¹ è´Ÿè´£é€šè¿‡ä¸ŽçŽ¯å¢ƒçš„äº¤äº’æ¥ä¼˜åŒ–è¿™äº›ç­–ç•¥ã€‚

1. **ç­–ç•¥è¡¨ç¤ºä¸Žå­¦ä¹ **ï¼šæ·±åº¦ç½‘ç»œç”¨äºŽè¡¨ç¤ºæ™ºèƒ½ä½“çš„ç­–ç•¥ï¼Œå³ç»™å®šä¸€ä¸ªçŠ¶æ€ï¼Œåº”è¯¥é‡‡å–ä»€ä¹ˆè¡ŒåŠ¨ã€‚é€šè¿‡å¤§é‡çš„è®­ç»ƒæ•°æ®ï¼Œç½‘ç»œå¯ä»¥å­¦ä¹ å¤æ‚çš„çŠ¶æ€-è¡ŒåŠ¨æ˜ å°„ã€‚
2. **å€¼å‡½æ•°ä¼°è®¡**ï¼šå€¼å‡½æ•°æ˜¯è¯„ä¼°ç»™å®šçŠ¶æ€æˆ–çŠ¶æ€-è¡ŒåŠ¨å¯¹çš„å¥½åçš„æ–¹æ³•ã€‚æ·±åº¦ç½‘ç»œå¯ä»¥ç”¨äºŽå­¦ä¹ è¿™äº›å€¼å‡½æ•°ï¼Œæä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„å‡½æ•°é€¼è¿‘å™¨æ¥ä¼°è®¡å€¼å‡½æ•°ã€‚
3. **æ¨¡åž‹å­¦ä¹ **ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ™ºèƒ½ä½“å¯èƒ½éœ€è¦å­¦ä¹ çŽ¯å¢ƒçš„æ¨¡åž‹ã€‚æ·±åº¦ç½‘ç»œå¯ä»¥ç”¨æ¥å­¦ä¹ è¿™ç§æ¨¡åž‹ï¼Œä½¿æ™ºèƒ½ä½“èƒ½å¤Ÿé¢„æµ‹çŽ¯å¢ƒçš„åŠ¨æ€ã€‚

![image-20231120151147598](.\img\image-20231120151147598.png)

## æ·±åº¦å­¦ä¹ æ¨¡åž‹

### 2.1 çº¿æ€§å›žå½’

çº¿æ€§å›žå½’æ˜¯ä¸€ç§æœ‰ç›‘ç£çš„å­¦ä¹ ç®—æ³•ï¼Œæ—¨åœ¨é‡‡ç”¨çº¿æ€§æ–¹æ³•æ¥å»ºæ¨¡å› å˜é‡å’Œè‡ªå˜é‡ä¹‹é—´çš„å…³ç³»ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒçš„ç›®æ ‡æ˜¯æ‹Ÿåˆä¸€æ¡æœ€å¥½åœ°æ•æ‰æ•°æ®å…³ç³»çš„çº¿æ€§è¶‹åŠ¿çº¿ï¼Œå¹¶ä¸”ï¼Œä»Žè¿™æ¡çº¿ï¼Œå®ƒå¯ä»¥é¢„æµ‹ç›®æ ‡å€¼å¯èƒ½æ˜¯ä»€ä¹ˆã€‚


![image-20231120152006545](.\img\image-20231120152006545.png)


**çº¿æ€§å›žå½’å¦‚ä½•å·¥ä½œçš„å‘¢?**

1. æ‹Ÿåˆæ•°æ®ï¼ˆå¦‚ä¸Šå›¾æ‰€ç¤ºï¼‰ã€‚

2. è®¡ç®—ç‚¹ä¹‹é—´çš„è·ç¦»ï¼ˆå›¾ä¸Šçš„çº¢ç‚¹æ˜¯ç‚¹ï¼Œç»¿çº¿æ˜¯è·ç¦»ï¼‰ï¼Œç„¶åŽæ±‚å¹³æ–¹ï¼Œç„¶åŽæ±‚å’Œï¼ˆè¿™äº›å€¼æ˜¯å¹³æ–¹çš„ï¼Œä»¥ç¡®ä¿è´Ÿå€¼ä¸ä¼šäº§ç”Ÿé”™è¯¯çš„å€¼å¹¶é˜»ç¢è®¡ç®—ï¼‰ã€‚è¿™æ˜¯ç®—æ³•çš„è¯¯å·®ï¼Œæˆ–è€…æ›´å¥½åœ°ç§°ä¸ºæ®‹å·®

3. å­˜å‚¨è¿­ä»£çš„æ®‹å·®

4. åŸºäºŽä¸€ä¸ªä¼˜åŒ–ç®—æ³•ï¼Œä½¿å¾—è¯¥çº¿ç¨å¾®â€œç§»åŠ¨â€ï¼Œä»¥ä¾¿è¯¥çº¿å¯ä»¥æ›´å¥½åœ°æ‹Ÿåˆæ•°æ®ã€‚

5. é‡å¤æ­¥éª¤2-5ï¼Œç›´åˆ°è¾¾åˆ°ç†æƒ³çš„ç»“æžœï¼Œæˆ–è€…å‰©ä½™è¯¯å·®å‡å°åˆ°é›¶ã€‚

è¿™ç§æ‹Ÿåˆç›´çº¿çš„æ–¹æ³•ç§°ä¸º**æœ€å°äºŒä¹˜æ³•**ã€‚


**çº¿æ€§å›žå½’æ•°å­¦å…¬å¼**

è‹¥ç”¨ $x_i^k$è¡¨ç¤ºç¬¬$ð‘˜$ä¸ªæ ·æœ¬çš„ç¬¬$ð‘–$ä¸ªå±žæ€§ï¼Œåˆ™çº¿æ€§æ¨¡åž‹ä¸€èˆ¬å½¢å¼ä¸ºï¼š

$$
f(x^k) = w_1x_1^k +  w_2x_2^k + ... +  w_mx_m^k +b = \sum^{m}_{i=1}w_ix_i^k + b
$$




çº¿æ€§å›žå½’å­¦ä¹ çš„å¯¹è±¡å°±æ˜¯æƒé‡å‘é‡ð‘¤å’Œåç½®å‘é‡ð‘ã€‚å¦‚æžœç”¨æœ€å°å‡æ–¹ è¯¯å·®æ¥è¡¡é‡é¢„æµ‹å€¼ä¸Žæ ·æœ¬æ ‡ç­¾çš„å·®è·ï¼Œé‚£ä¹ˆçº¿æ€§å›žå½’å­¦ä¹ çš„ç›®æ ‡å¯ä»¥è¡¨ç¤ºä¸ºï¼š

$$
(w^*ï¼Œb^*) = argmin_(w,b)\sum^{n}_{k=1}(f(x^k) - y^k)^2 = argmin_(w,b)\sum^{n}{k=1}(w^Tx^k + b -y^k)^2
$$

### 2.2 æ¢¯åº¦ä¸‹é™ï¼ˆgradient descentï¼‰


æ¢¯åº¦ä¸‹é™æ ¸å¿ƒå†…å®¹æ˜¯å¯¹è‡ªå˜é‡è¿›è¡Œä¸æ–­çš„æ›´æ–°ï¼ˆé’ˆå¯¹wå’Œbæ±‚åå¯¼ï¼‰ï¼Œä½¿å¾—ç›®æ ‡å‡½æ•°ä¸æ–­é€¼è¿‘æœ€å°å€¼çš„è¿‡ç¨‹ï¼š
$$
      w \leftarrow w - a \frac{\partial{L}}{\partial{w}}
$$

$$
b \rightarrow b - a \frac{\partial{L}}{\partial{b}}
$$


ç®€å†™å½¢å¼ï¼š$y=w^Tx+b$

å¹¿ä¹‰çº¿æ€§æ¨¡åž‹ï¼š$y=g^{-1}(w^Tx_b)$ï¼Œå…¶ä¸­$g(\cdot)$æ—¶å•è°ƒå¯å¾®å‡½æ•°ã€‚

### 2.3 é€»è¾‘å›žå½’

é€»è¾‘å›žå½’ï¼ˆLR,Logistic Regressionï¼‰æ˜¯ä¼ ç»Ÿæœºå™¨å­¦ä¹ ä¸­çš„ä¸€ç§åˆ†ç±»æ¨¡åž‹ï¼Œç”±äºŽLRç®—æ³•å…·æœ‰ç®€å•ã€é«˜æ•ˆã€æ˜“äºŽå¹¶è¡Œä¸”åœ¨çº¿å­¦ä¹ ï¼ˆåŠ¨æ€æ‰©å±•ï¼‰çš„ç‰¹ç‚¹ï¼Œåœ¨å·¥ä¸šç•Œå…·æœ‰éžå¸¸å¹¿æ³›çš„åº”ç”¨ã€‚

é€»è¾‘å›žå½’é€šè¿‡åœ¨çº¿æ€§å›žå½’æ¨¡åž‹ä¸­å¼•å…¥Sigmoidå‡½æ•°ï¼Œå°†çº¿æ€§å›žå½’çš„ä¸ç¡®å®šèŒƒå›´çš„è¿žç»­è¾“å‡ºå€¼æ˜ å°„åˆ°ï¼ˆ0ï¼Œ1ï¼‰èŒƒå›´å†…ï¼Œæˆä¸ºä¸€ä¸ªæ¦‚çŽ‡é¢„æµ‹é—®é¢˜ã€‚

LRç›®æ ‡å‡½æ•°ï¼š

$$
h_{\theta}(x) = g(\theta^TX)
$$

å…¶ä¸­Sigmoidå‡½æ•°g(z)çš„å®šä¹‰å¦‚ä¸‹ï¼š

$$
g(z) = \frac{1}{1+e^{-z}}
$$

Sigmoidå‡½æ•°çš„å‡½æ•°å›¾åƒä¸ºï¼š

![image-20231120152142193](.\img\image-20231120152142193.png)

### **2.4 å…¨è¿žæŽ¥ç¥žç»ç½‘ç»œ**

å…¨è¿žæŽ¥ç½‘ç»œï¼ˆfully connected networkï¼‰ä¹Ÿç§°ä½œå¤šå±‚æ„ŸçŸ¥æœºï¼ˆfully connected networkï¼‰ï¼Œä¹Ÿç§°ä½œå¤šå±‚æ„ŸçŸ¥æœºï¼ˆ$\text{multi-layer perceptronï¼ŒMLP}$ï¼‰ï¼Œæ˜¯æœ€åŸºç¡€çš„æ·±åº¦ç¥žç»ç½‘ç»œæ¨¡åž‹ã€‚

å…¨è¿žæŽ¥ç½‘ç»œç”±å¤šå±‚ç»“æž„çš„æ„ŸçŸ¥å™¨é€’é˜¶ç»„æˆçš„è¾“å…¥å€¼å‘å‰ä¼ æ’­çš„ç½‘ç»œï¼Œä¹Ÿè¢«ç§°ä¸º**å‰é¦ˆç½‘ç»œ**æˆ–**æ­£å‘ä¼ æ’­ç½‘ç»œ**ã€‚

ä»¥ä¸‰å±‚ç»“æž„çš„å¤šå±‚æ„ŸçŸ¥å™¨ä¸ºä¾‹ï¼Œå®ƒç”±è¾“å…¥å±‚ã€ä¸­é—´å±‚åŠè¾“å‡ºå±‚ç»„æˆ

- ä¸ŽM-Pæ¨¡åž‹ç›¸åŒï¼Œä¸­é—´å±‚çš„æ„ŸçŸ¥å™¨é€šè¿‡æƒé‡ä¸Žè¾“å…¥å±‚çš„å„å•å…ƒç›¸è¿žæŽ¥ï¼Œé€šè¿‡é˜ˆå€¼å‡½æ•°è®¡ç®—ä¸­é—´å±‚å„å•å…ƒçš„è¾“å‡ºå€¼
- ä¸­é—´å±‚ä¸Žè¾“å‡ºå±‚ä¹‹é—´åŒæ ·æ˜¯é€šè¿‡æƒé‡ç›¸è¿žæŽ¥




####  MLPç¥žç»ç½‘ç»œçš„ç»“æž„å’ŒåŽŸç†

MLPåŒ…æ‹¬åŒ…æ‹¬ä¸‰å±‚ï¼š**è¾“å…¥å±‚ã€éšå±‚å’Œè¾“å‡ºå±‚**

MLPç¥žç»ç½‘ç»œä¸åŒå±‚ä¹‹é—´æ˜¯**å…¨è¿žæŽ¥**çš„ï¼ˆ**å…¨è¿žæŽ¥**çš„æ„æ€å°±æ˜¯ï¼šä¸Šä¸€å±‚çš„ä»»ä½•ä¸€ä¸ªç¥žç»å…ƒä¸Žä¸‹ä¸€å±‚çš„æ‰€æœ‰ç¥žç»å…ƒéƒ½æœ‰è¿žæŽ¥ï¼‰ã€‚


![image-20231120153613271](C:\Users\Jochoi\AppData\Roaming\Typora\typora-user-images\image-20231120153613271.png)



ç¥žç»ç½‘ç»œä¸‰ä¸ªåŸºæœ¬è¦ç´ ï¼š**æƒé‡**ã€**åç½®**å’Œ**æ¿€æ´»å‡½æ•°**

**æƒé‡:** ç¥žç»å…ƒä¹‹é—´çš„è¿žæŽ¥å¼ºåº¦ç”±æƒé‡è¡¨ç¤ºï¼Œæƒé‡çš„å¤§å°è¡¨ç¤ºå¯èƒ½æ€§çš„å¤§å°

**åç½®ï¼š** åç½®çš„è®¾ç½®æ˜¯ä¸ºäº†æ­£ç¡®åˆ†ç±»æ ·æœ¬ï¼Œæ˜¯æ¨¡åž‹ä¸­ä¸€ä¸ªé‡è¦çš„å‚æ•°ï¼Œå³ä¿è¯é€šè¿‡è¾“å…¥ç®—å‡ºçš„è¾“å‡ºå€¼ä¸èƒ½éšä¾¿æ¿€æ´»ã€‚

**æ¿€æ´»å‡½æ•°:** èµ·éžçº¿æ€§æ˜ å°„çš„ä½œç”¨ï¼Œå…¶å¯å°†ç¥žç»å…ƒçš„è¾“å‡ºå¹…åº¦é™åˆ¶åœ¨ä¸€å®šèŒƒå›´å†…ï¼Œä¸€èˆ¬é™åˆ¶åœ¨ï¼ˆ-1 - 1ï¼‰æˆ–ï¼ˆ0 - 1ï¼‰ä¹‹é—´ã€‚æœ€å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°æ˜¯Sigmoidå‡½æ•°ï¼Œå…¶å¯å°†ï¼ˆ-âˆžï¼Œ+âˆžï¼‰çš„æ•°æ˜ å°„åˆ°ï¼ˆ0 - 1ï¼‰çš„èŒƒå›´å†…ã€‚

### 2.5  å·ç§¯ç¥žç»ç½‘ç»œ

å…¨è¿žæŽ¥ç¥žç»ç½‘ç»œ

- å‚æ•°æ•°é‡å¤ªå¤š 
- æ²¡æœ‰åˆ©ç”¨åƒç´ ä¹‹é—´çš„ä½ç½®ä¿¡æ¯
- ç½‘ç»œå±‚æ•°é™åˆ¶
- æ‰€éœ€å†…å­˜å’Œè®¡ç®—é‡å·¨å¤§ã€‚

å·ç§¯ç¥žç»ç½‘ç»œ

- å±€éƒ¨è¿žæŽ¥: æ¯ä¸ªç¥žç»å…ƒä¸å†å’Œä¸Šä¸€å±‚çš„æ‰€æœ‰ç¥žç»å…ƒç›¸è¿žï¼Œè€Œåªå’Œä¸€å°éƒ¨åˆ†ç¥žç»å…ƒç›¸è¿žã€‚è¿™æ ·å°±å‡å°‘äº†å¾ˆå¤šå‚æ•°ã€‚
- æƒå€¼å…±äº«:ä¸€ç»„è¿žæŽ¥å¯ä»¥å…±äº«åŒä¸€ä¸ªæƒé‡ï¼Œè€Œä¸æ˜¯æ¯ä¸ªè¿žæŽ¥æœ‰ä¸€ä¸ªä¸åŒçš„æƒé‡ï¼Œè¿™æ ·åˆå‡å°‘äº†å¾ˆå¤šå‚æ•°
- ä¸‹é‡‡æ · : ä½¿ç”¨Poolingæ¥å‡å°‘æ¯å±‚çš„æ ·æœ¬æ•°ï¼Œè¿›ä¸€æ­¥å‡å°‘å‚æ•°æ•°é‡ï¼ŒåŒæ—¶è¿˜å¯ä»¥æå‡æ¨¡åž‹çš„é²æ£’æ€§ã€‚


#### å·ç§¯ï¼ˆConvolutionï¼‰


å·ç§¯ï¼ˆConvolutionï¼‰ï¼Œä¹Ÿå«è¤¶ç§¯ï¼Œæ˜¯åˆ†æžæ•°å­¦ä¸­ä¸€ç§é‡è¦çš„è¿ç®—ï¼Ž

##### 1.å·ç§¯åˆ†ç±»:

**è¿žç»­å·ç§¯ï¼š**  

$(f*g)(n)= \int^{\infty}_{-\infty}f(\tau)g(n-\tau)d\tau ï¼Œ n=\tau + (n-\tau)$


**ç¦»æ•£å·ç§¯ï¼š**  

$(f*g)(n)= \sum^{\infty}_{\tau=-\infty}f(\tau)g(n-\tau) ï¼Œ n=\tau + (n-\tau)$


**å·ç§¯åº”ç”¨åœºæ™¯**

- ç»Ÿè®¡å­¦ä¸­åŠ æƒå¹³å‡æ³•
- æ¦‚çŽ‡è®ºä¸­ä¸¤ä¸ªç‹¬ç«‹å˜é‡ä¹‹å’Œæ¦‚çŽ‡å¯†åº¦çš„è®¡ç®—
- ä¿¡å·å¤„ç†ä¸­çš„çº¿æ€§ç³»ç»Ÿ
- ç‰©ç†å­¦çš„çº¿æ€§ç³»ç»Ÿ
- å›¾åƒå¤„ç†ä¸­çš„åº”ç”¨(å·ç§¯ç¥žç»ç½‘ç»œ)


å…¶ä»–å·ç§¯ï¼š

- è½¬ç½®å·ç§¯/å¾®æ­¥å·ç§¯ï¼šä½Žç»´ç‰¹å¾æ˜ å°„åˆ°é«˜ç»´ç‰¹å¾

- ç©ºæ´žå·ç§¯ï¼šä¸ºäº†å¢žåŠ è¾“å‡ºå•å…ƒçš„æ„Ÿå—é‡Žï¼Œé€šè¿‡ç»™å·ç§¯æ ¸æ’å…¥â€œç©ºæ´žâ€æ¥å˜ç›¸åœ°å¢žåŠ å…¶å¤§å°ã€‚


å®žé™…åº”ç”¨ä¸­å·ç§¯ç½‘ç»œä¸­çš„å·ç§¯æ ¸å¸¸è§ä¸ºç¦»æ•£å·ç§¯è¿ç®—.




åœ¨ä¿¡å·å¤„ç†æˆ–å›¾åƒå¤„ç†ä¸­ï¼Œç»å¸¸ä½¿ç”¨ä¸€ç»´æˆ–äºŒç»´å·ç§¯ï¼Ž

##### 2.ä¸€ç»´å·ç§¯

ä¸€ç»´å·ç§¯ç»å¸¸ç”¨åœ¨ä¿¡å·å¤„ç†ä¸­ï¼Œç”¨äºŽè®¡ç®—ä¿¡å·çš„å»¶è¿Ÿç´¯ç§¯. 


å‡è®¾ä¸€ä¸ªä¿¡å·å‘ç”Ÿå™¨æ¯ä¸ªæ—¶åˆ» $ð‘¡$ äº§ç”Ÿä¸€ä¸ªä¿¡å· $ð‘¥_ð‘¡$ï¼Œå…¶ä¿¡æ¯çš„è¡°å‡çŽ‡ä¸º $ð‘¤_ð‘˜$ï¼Œå³åœ¨ $ð‘˜ âˆ’ 1$ ä¸ªæ—¶é—´æ­¥é•¿
åŽï¼Œä¿¡æ¯ä¸ºåŽŸæ¥çš„$ð‘¤_ð‘˜$ å€ï¼Žå‡è®¾$ð‘¤_1 = 1, ð‘¤_2 = 1/2, ð‘¤_3 = 1/4$ï¼Œé‚£ä¹ˆåœ¨æ—¶åˆ» $ð‘¡$ æ”¶åˆ°çš„ä¿¡å· $ð‘¦_ð‘¡$ ä¸ºå½“å‰æ—¶åˆ»äº§ç”Ÿçš„ä¿¡æ¯å’Œä»¥å‰æ—¶åˆ»å»¶è¿Ÿä¿¡æ¯çš„å åŠ 

$$
ð‘¦_ð‘¡ = 1 Ã— ð‘¥_ð‘¡ + 1/2 Ã— ð‘¥_{ð‘¡âˆ’1} + 1/4 Ã— ð‘¥_{ð‘¡âˆ’2}   \\
= ð‘¤_1 Ã— ð‘¥_ð‘¡ + ð‘¤_2 Ã— ð‘¥_{ð‘¡âˆ’1} + ð‘¤_3 Ã— ð‘¥_{ð‘¡âˆ’2}  \\
= \sum^{3}_{ð‘˜=1}ð‘¤_ð‘˜ð‘¥_{ð‘¡âˆ’ð‘˜+1}.
$$

æˆ‘ä»¬æŠŠ$ð‘¤_1, ð‘¤_2, â‹¯$ç§°ä¸º`æ»¤æ³¢å™¨`ï¼ˆFilterï¼‰æˆ–`å·ç§¯æ ¸`ï¼ˆConvolution Kernelï¼‰ï¼Ž

å‡è®¾æ»¤æ³¢å™¨é•¿åº¦ä¸º$ð¾$ï¼Œå®ƒå’Œä¸€ä¸ªä¿¡å·åºåˆ—$ð‘¥_1, ð‘¥_2, â‹¯$çš„**å·ç§¯**ä¸º


$$
ð‘¦_ð‘¡ =  \sum^{k}_{ð‘˜=1}ð‘¤_ð‘˜ð‘¥_{ð‘¡âˆ’ð‘˜+1}.
$$


##### 3 äºŒç»´å·ç§¯

äºŒç»´å·ç§¯è¿ç®—ï¼šç»™å®šäºŒç»´çš„å›¾åƒ$I$ä½œä¸ºè¾“å…¥ï¼ŒäºŒç»´å·ç§¯æ ¸$K$ï¼Œå·ç§¯è¿ç®—å¯è¡¨ç¤ºä¸º 
$$
S(i,j)=(Iâˆ—K)(i,j)=âˆ‘mâˆ‘nI(iâˆ’m,jâˆ’n)K(m,n)
$$
å·ç§¯æ ¸éœ€è¦è¿›è¡Œä¸Šä¸‹ç¿»è½¬å’Œå·¦å³åè½¬ï¼Œ`å´æ©è¾¾çš„è¯´æ³•ï¼ŒRNNä¸­äºŒç»´å·ç§¯æ ¸å¯ä»¥ä¸å¿…åšä»»ä½•ç¿»è½¬,å¹¶ä¸å½±å“ç»“æžœ`


å·ç§¯é€šå¸¸æœ‰ä¸‰ç§ç±»åž‹ï¼šfullå·ç§¯ã€sameå·ç§¯å’Œvalidå·ç§¯.è¿™é‡Œå°±ä¸å¤šå±•å¼€,æƒ³äº†è§£å¯ä»¥é˜…è¯»ä¹¦ç±:[å›¾è§£æ·±åº¦å­¦ä¹ ä¸Žç¥žç»ç½‘ç»œï¼šä»Žå¼ é‡åˆ°TensorFlowå®žçŽ°](https://github.com/XQLuck/DeepLearning-Notes/blob/master/Books/%E3%80%8A%E5%9B%BE%E8%A7%A3%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B8%8E%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%EF%BC%9A%E4%BB%8E%E5%BC%A0%E9%87%8F%E5%88%B0TensorFlow%E5%AE%9E%E7%8E%B0%E3%80%8B_%E5%BC%A0%E5%B9%B3_2018-09-01.pdf)


#### å·ç§¯ç¥žç»ç½‘ç»œåŸºæœ¬åŽŸç†

å·ç§¯ç¥žç»ç½‘ç»œçš„åŸºæœ¬ç»“æž„å¤§è‡´åŒ…æ‹¬ï¼š`å·ç§¯å±‚`ã€`æ¿€æ´»å‡½æ•°`ã€`æ± åŒ–å±‚`ã€`å…¨è¿žæŽ¥å±‚`ã€`è¾“å‡ºå±‚`ç­‰ã€‚

##### 1 å·ç§¯å±‚


å·ç§¯å±‚çš„è¿ç®—è¿‡ç¨‹å¦‚ä¸‹å›¾ï¼Œç”¨ä¸€ä¸ªå·ç§¯æ ¸æ‰«å®Œæ•´å¼ å›¾ç‰‡ï¼š

![image-20231120152813412](.\img\image-20231120152813412.png)

è¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªè¿‡æ»¤å™¨ï¼ˆå·ç§¯æ ¸ï¼‰æ¥è¿‡æ»¤å›¾åƒçš„å„ä¸ªå°åŒºåŸŸï¼Œä»Žè€Œå¾—åˆ°è¿™äº›å°åŒºåŸŸçš„ç‰¹å¾å€¼ã€‚


**æ­¥é•¿ï¼ˆStrideï¼‰**

Strideçš„ä½œç”¨ï¼šæ˜¯æˆå€ç¼©å°å°ºå¯¸ï¼Œè€Œè¿™ä¸ªå‚æ•°çš„å€¼å°±æ˜¯ç¼©å°çš„å…·ä½“å€æ•°ï¼Œæ¯”å¦‚æ­¥å¹…ä¸º2ï¼Œè¾“å‡ºå°±æ˜¯è¾“å…¥çš„1/2ï¼›æ­¥å¹…ä¸º3ï¼Œè¾“å‡ºå°±æ˜¯è¾“å…¥çš„1/3ã€‚ä»¥æ­¤ç±»æŽ¨ã€‚

ã€å·ç§¯æ ¸çš„å¤§å°ä¸€èˆ¬ä¸ºå¥‡æ•° * å¥‡æ•°ã€‘ $1* 1ï¼Œ3* 3ï¼Œ5 * 5ï¼Œ7 * 7$ éƒ½æ˜¯æœ€å¸¸è§çš„ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆæ²¡æœ‰ å¶æ•° * å¶æ•°ï¼Ÿ

```md
 å¥‡æ•°å·ç§¯æ ¸ä¸­å¿ƒåªæœ‰ä¸€åˆ—ï¼Œå¯ä»¥æ»¡è¶³ä¸¤è¾¹å¯¹ç§°ï¼Œæ¯”è¾ƒå®¹æ˜“åˆ¤æ–­ã€‚å¥½åƒè·Ÿåž‚ç›´è¾¹ç¼˜å’Œæ°´å¹³è¾¹ç¼˜æœ‰å…³ã€‚
```

**æ•°æ®å¡«å……ï¼ˆpaddingï¼‰**

ä¸¤ç§paddingï¼š

- valid paddingï¼šä¸è¿›è¡Œä»»ä½•å¤„ç†ï¼Œåªä½¿ç”¨åŽŸå§‹å›¾åƒï¼Œä¸å…è®¸å·ç§¯æ ¸è¶…å‡ºåŽŸå§‹å›¾åƒè¾¹ç•Œ
- same paddingï¼šè¿›è¡Œå¡«å……ï¼Œå…è®¸å·ç§¯æ ¸è¶…å‡ºåŽŸå§‹å›¾åƒè¾¹ç•Œï¼Œå¹¶ä½¿å¾—å·ç§¯åŽç»“æžœçš„å¤§å°ä¸ŽåŽŸæ¥çš„ä¸€è‡´


**æ„Ÿå—é‡Ž**

åœ¨å¤„ç†å›¾åƒè¿™æ ·çš„é«˜ç»´åº¦è¾“å…¥æ—¶ï¼Œè®©æ¯ä¸ªç¥žç»å…ƒéƒ½ä¸Žå‰ä¸€å±‚ä¸­çš„æ‰€æœ‰ç¥žç»å…ƒè¿›è¡Œå…¨è¿žæŽ¥æ˜¯ä¸çŽ°å®žçš„ã€‚ç›¸åï¼Œæˆ‘ä»¬è®©æ¯ä¸ªç¥žç»å…ƒåªä¸Žè¾“å…¥æ•°æ®çš„ä¸€ä¸ªå±€éƒ¨åŒºåŸŸè¿žæŽ¥ã€‚è¯¥è¿žæŽ¥çš„ç©ºé—´å¤§å°å«åšç¥žç»å…ƒçš„æ„Ÿå—é‡Žï¼ˆreceptive fieldï¼‰ï¼Œå®ƒçš„å°ºå¯¸æ˜¯ä¸€ä¸ªè¶…å‚æ•°ï¼ˆå…¶å®žå°±æ˜¯æ»¤æ³¢å™¨çš„ç©ºé—´å°ºå¯¸ï¼‰ã€‚åœ¨æ·±åº¦æ–¹å‘ä¸Šï¼Œè¿™ä¸ªè¿žæŽ¥çš„å¤§å°æ€»æ˜¯å’Œè¾“å…¥é‡çš„æ·±åº¦ç›¸ç­‰ã€‚éœ€è¦å†æ¬¡å¼ºè°ƒçš„æ˜¯ï¼Œæˆ‘ä»¬å¯¹å¾…ç©ºé—´ç»´åº¦ï¼ˆå®½å’Œé«˜ï¼‰ä¸Žæ·±åº¦ç»´åº¦æ˜¯ä¸åŒçš„ï¼šè¿žæŽ¥åœ¨ç©ºé—´ï¼ˆå®½é«˜ï¼‰ä¸Šæ˜¯å±€éƒ¨çš„ï¼Œä½†æ˜¯åœ¨æ·±åº¦ä¸Šæ€»æ˜¯å’Œè¾“å…¥æ•°æ®çš„æ·±åº¦ä¸€è‡´ï¼Œè¿™ä¸€ç‚¹ä¼šåœ¨ä¸‹é¢ä¸¾ä¾‹å…·ä½“è¯´æ˜Žã€‚


![image-20231120152838378](.\img\image-20231120152838378.png)


åœ¨å›¾ 2 ä¸­å±•çŽ°çš„å·ç§¯ç¥žç»ç½‘ç»œçš„ä¸€éƒ¨åˆ†ï¼Œå…¶ä¸­çš„çº¢è‰²ä¸ºè¾“å…¥æ•°æ®ï¼Œå‡è®¾è¾“å…¥æ•°æ®ä½“å°ºå¯¸ä¸º[32x32x3]ï¼ˆæ¯”å¦‚CIFAR-10çš„RGBå›¾åƒï¼‰ï¼Œå¦‚æžœæ„Ÿå—é‡Žï¼ˆæˆ–æ»¤æ³¢å™¨å°ºå¯¸ï¼‰æ˜¯5x5ï¼Œé‚£ä¹ˆå·ç§¯å±‚ä¸­çš„æ¯ä¸ªç¥žç»å…ƒä¼šæœ‰è¾“å…¥æ•°æ®ä½“ä¸­[5x5x3]åŒºåŸŸçš„æƒé‡ï¼Œå…±5x5x3=75ä¸ªæƒé‡ï¼ˆè¿˜è¦åŠ ä¸€ä¸ªåå·®å‚æ•°ï¼‰ã€‚æ³¨æ„è¿™ä¸ªè¿žæŽ¥åœ¨æ·±åº¦ç»´åº¦ä¸Šçš„å¤§å°å¿…é¡»ä¸º3ï¼Œå’Œè¾“å…¥æ•°æ®ä½“çš„æ·±åº¦ä¸€è‡´ã€‚å…¶ä¸­è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œå¯¹åº”ä¸€ä¸ªæ„Ÿå—é‡Žæœ‰75ä¸ªæƒé‡ï¼Œè¿™75ä¸ªæƒé‡æ˜¯é€šè¿‡å­¦ä¹ è¿›è¡Œæ›´æ–°çš„ï¼Œæ‰€ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šè¿™äº›æƒå€¼ä¹‹é—´æ˜¯ä¸ç›¸ç­‰ï¼ˆä¹Ÿå°±å¯¹äºŽåŒä¸€ä¸ªå·ç§¯æ ¸ï¼Œå®ƒå¯¹äºŽä¸Žå®ƒè¿žæŽ¥çš„è¾“å…¥çš„æ¯ä¸€å±‚çš„æƒé‡éƒ½æ˜¯ç‹¬ç‰¹çš„ï¼Œä¸æ˜¯åŒæ ·çš„æƒé‡é‡å¤è¾“å…¥å±‚å±‚æ•°é‚£ä¹ˆå¤šæ¬¡å°±å¯ä»¥çš„ï¼‰ã€‚åœ¨è¿™é‡Œç›¸å½“äºŽå‰é¢çš„æ¯ä¸€ä¸ªå±‚å¯¹åº”ä¸€ä¸ªä¼ ç»Ÿæ„ä¹‰ä¸Šçš„å·ç§¯æ¨¡æ¿ï¼Œæ¯ä¸€å±‚ä¸Žè‡ªå·±å·ç§¯æ¨¡æ¿åšå®Œå·ç§¯ä¹‹åŽï¼Œå†å°†å„ä¸ªå±‚çš„ç»“æžœåŠ èµ·æ¥ï¼Œå†åŠ ä¸Šåç½®ï¼Œæ³¨æ„æ˜¯ä¸€ä¸ªåç½®ï¼Œæ— è®ºè¾“å…¥è¾“å…¥æ•°æ®æ˜¯å¤šå°‘å±‚ï¼Œä¸€ä¸ªå·ç§¯æ ¸å°±å¯¹åº”ä¸€ä¸ªåç½®ã€‚


**æ€»ç»“:**

å·ç§¯å±‚æ˜¯æž„å»ºå·ç§¯ç¥žç»ç½‘ç»œçš„æ ¸å¿ƒå±‚ï¼Œå®ƒäº§ç”Ÿäº†ç½‘ç»œä¸­å¤§éƒ¨åˆ†çš„è®¡ç®—é‡ã€‚æ³¨æ„æ˜¯è®¡ç®—é‡è€Œä¸æ˜¯å‚æ•°é‡ã€‚

**å·ç§¯å±‚çš„ä½œç”¨:**

1. æ»¤æ³¢å™¨çš„ä½œç”¨æˆ–è€…è¯´æ˜¯å·ç§¯çš„ä½œç”¨
2. å¯ä»¥è¢«çœ‹åšæ˜¯ç¥žç»å…ƒçš„ä¸€ä¸ªè¾“å‡º
3. é™ä½Žå‚æ•°çš„æ•°é‡

##### 2 æ¿€æ´»å‡½æ•°

æ¿€æ´»å‡½æ•°æ˜¯ç”¨æ¥åŠ å…¥éžçº¿æ€§å› ç´ ï¼Œæé«˜ç½‘ç»œè¡¨è¾¾èƒ½åŠ›ï¼Œå·ç§¯ç¥žç»ç½‘ç»œä¸­æœ€å¸¸ç”¨çš„æ˜¯ReLUï¼ŒSigmoidä½¿ç”¨è¾ƒå°‘ã€‚


1. ReLUå‡½æ•°



$$
f(z)=\left\{\begin{array}{cc} 
		z, & if z>=0\\ 
		0, & if z<0\ 
\end{array}\right.
$$



ReLUå‡½æ•°çš„ä¼˜ç‚¹ï¼š

- è®¡ç®—é€Ÿåº¦å¿«ï¼ŒReLUå‡½æ•°åªæœ‰çº¿æ€§å…³ç³»ï¼Œæ¯”Sigmoidå’ŒTanhè¦å¿«å¾ˆå¤š
- è¾“å…¥ä¸ºæ­£æ•°çš„æ—¶å€™ï¼Œä¸å­˜åœ¨æ¢¯åº¦æ¶ˆå¤±é—®é¢˜


ReLUå‡½æ•°çš„ç¼ºç‚¹ï¼š

- å¼ºåˆ¶æ€§æŠŠè´Ÿå€¼ç½®ä¸º0ï¼Œå¯èƒ½ä¸¢æŽ‰ä¸€äº›ç‰¹å¾
- å½“è¾“å…¥ä¸ºè´Ÿæ•°æ—¶ï¼Œæƒé‡æ— æ³•æ›´æ–°ï¼Œå¯¼è‡´â€œç¥žç»å…ƒæ­»äº¡â€(å­¦ä¹ çŽ‡ä¸ è¦å¤ªå¤§)

2. Parametric ReLU

$$
f(z)=\left\{\begin{array}{cc} 
		{z}, & if z>=0\\ 
		\alpha{z}, & if  z<0\ 
\end{array}\right.
$$

å½“ ð›¼=0.01 æ—¶ï¼Œç§°ä½œLeaky ReLU
å½“ ð›¼ ä»Žé«˜æ–¯åˆ†å¸ƒä¸­éšæœºäº§ç”Ÿæ—¶ï¼Œç§°ä¸ºRandomized ReLU(RReLU)

PReLUå‡½æ•°çš„ä¼˜ç‚¹ï¼š

- æ¯”sigmoid/tanhæ”¶æ•›å¿«
- è§£å†³äº†ReLUçš„â€œç¥žç»å…ƒæ­»äº¡â€é—®é¢˜

PReLUå‡½æ•°çš„ç¼ºç‚¹ï¼šéœ€è¦å†å­¦ä¹ ä¸€ä¸ªå‚æ•°ï¼Œå·¥ä½œé‡å˜å¤§

3. ELUå‡½æ•°

$$
f(z)=\left\{\begin{array}{cc} 
		{z}, & if z>=0\\ 
		\alpha{e^z-1}, & if z<0\ 
\end{array}\right.
$$

ELUå‡½æ•°çš„ä¼˜ç‚¹ï¼š

- å¤„ç†å«æœ‰å™ªå£°çš„æ•°æ®æœ‰ä¼˜åŠ¿
- æ›´å®¹æ˜“æ”¶æ•›

ELUå‡½æ•°çš„ç¼ºç‚¹ï¼šè®¡ç®—é‡è¾ƒå¤§ï¼Œæ”¶æ•›é€Ÿåº¦è¾ƒæ…¢

- CNNåœ¨å·ç§¯å±‚å°½é‡ä¸è¦ä½¿ç”¨Sigmoidå’ŒTanhï¼Œå°†å¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ã€‚
- é¦–å…ˆé€‰ç”¨ReLUï¼Œä½¿ç”¨è¾ƒå°çš„å­¦ä¹ çŽ‡ï¼Œä»¥å…é€ æˆç¥žç»å…ƒæ­»äº¡çš„æƒ…å†µã€‚
- å¦‚æžœReLUå¤±æ•ˆï¼Œè€ƒè™‘ä½¿ç”¨Leaky ReLUã€PReLUã€ELUæˆ–è€…Maxoutï¼Œæ­¤æ—¶ä¸€èˆ¬æƒ…å†µéƒ½å¯ä»¥è§£å†³

ç‰¹å¾å›¾

- æµ…å±‚å·ç§¯å±‚ï¼šæå–çš„æ˜¯å›¾åƒåŸºæœ¬ç‰¹å¾ï¼Œå¦‚è¾¹ç¼˜ã€æ–¹å‘å’Œçº¹ç†ç­‰ç‰¹å¾
- æ·±å±‚å·ç§¯å±‚ï¼šæå–çš„æ˜¯å›¾åƒé«˜é˜¶ç‰¹å¾ï¼Œå‡ºçŽ°äº†é«˜å±‚è¯­ä¹‰æ¨¡å¼ï¼Œå¦‚â€œè½¦è½®â€ã€â€œäººè„¸â€ç­‰ç‰¹å¾
  

##### 3 æ± åŒ–å±‚

æ± åŒ–å±‚ï¼ˆPooling Layerï¼‰ä¹Ÿå«å­é‡‡æ ·å±‚ï¼ˆSubsampling Layerï¼‰ï¼šä¿ƒè¿›ç‰¹å¾é€‰æ‹©ï¼Œé™ä½Žç‰¹å¾/å‚æ•°æ•°é‡ï¼Œé¿å…è¿‡æ‹Ÿåˆ

æ± åŒ–ï¼ˆPoolingï¼‰æ˜¯æŒ‡å¯¹æ¯ä¸ªåŒºåŸŸè¿›è¡Œä¸‹é‡‡æ ·ï¼ˆDown Samplingï¼‰å¾—åˆ°ä¸€ä¸ªå€¼ï¼Œä½œä¸ºè¿™ä¸ªåŒºåŸŸçš„æ¦‚æ‹¬


å¸¸ç”¨æ±‡èšå‡½æ•°ï¼š

1. æœ€å¤§æ±‡èšï¼ˆMaximum Pooling/ Max Poolingï¼‰ï¼š$y\_{m, n}^{d}=\max \_{i \in R\_{m, n}^{d}} x\_{i}$
2. å¹³å‡æ±‡èšï¼ˆMean Poolingï¼‰ï¼š$y\_{m, n}^{d}=\frac{1}{\left|R\_{m, n}^{d}\right|} \sum\_{i \in R\_{m, n}^{d}} x\_{i}$

æ± åŒ–å±‚å¯ä»¥çœ‹ä½œç‰¹æ®Šçš„å·ç§¯å±‚ï¼šå·ç§¯æ ¸å¤§å°ä¸º$K\times K$ï¼Œæ­¥é•¿ä¸º$S\times S$ï¼Œå·ç§¯æ ¸ä¸ºmaxå‡½æ•°æˆ–meanå‡½æ•°