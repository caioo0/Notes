Transformerᶎᦶ᷌ᒼໜᥴຉ
ݩռل
: NLP՗فᳪکන୒
ᎣԒ
: DASOU
NLP从入门到放弃
1. ݥӤ๋قTransformerᶎᦶ᷌
2. 3ړᰦ՗ᵭᥴ᧛ Transformerጱ Encoder
ܻᇇ
Transformerጱ֖ᗝᖫᎱᑪᒌํဌํ۱ތፘ੒֖ᗝמ௳
ᓌܔ༷ᬿ
ྋ෈
4. ᧨Ӟӥፘ੒֖ᗝᖫᎱ
RPR௏᪠
ই֜ቘᥴፘ੒֖ᗝ
RPRץද௏మ
BN᪴ࣗᦕ --᧨Ӟӥ Batch Normalizationጱսᗌᅩ޾ᭇአ࣋ว
BNํӷӻսᅩ̶
BNጱᗌᅩғ
BNֵአ࣋ว
6. NLPձۓӾ -layer-normྲ BatchNormঅߺࣁ᯾
ࠨԅ
BNࣁ NLPӾපຎ૧
layner-norm ጱᇙᅩ
୚ኩ
-ԅࠨ BNࣁ CNNݢզᘒࣁ NLPӧݢզ
ᓌᒼ᧔Ӟӥ
7. ᧨Ӟ᧨Decoderཛྷࣘ
Ӟӻੜੜጱᳯ᷌
ྋ෈
੶ێ఺ဳग़१ᛔ
Ի԰ཛྷࣘ
8. Transformerጱଚᤈ۸
9. ᧨Ӟӥ Transformerԅֵ֜አग़१ဳ఺ێ๢ګҘ
10. TransformerԅՋԍ Q޾ Kֵአӧݶጱ๦᯿Ꭵᴣኞ౮҅ԅ֜ӧᚆֵአݶӞӻ꧊ᬰᤈᛔ᫝ጱᅩԙҘ
11. Transformerᦇᓒ attentionጱ෸ײԅ֜ᭌೠᅩԙᘒӧฎےဩҘӷᘏᦇᓒ॔๥ଶ޾පຎӤํՋԍ܄
Ҙڦ
12. ԅՋԍࣁᬰᤈsoftmaxԏڹᵱᥝ੒ attentionᬰᤈ scaledҁԅՋԍᴻզ dkጱଘො໑҂҅ଚֵአلୗവ
੕ᬰᤈᦖᥴ
13. ᦇᓒattention scoreጱ෸ײই֜੒ padding؉ mask඙֢Ҙ
ᔮڜ௛ᕮ
1. ݥӤ๋قTransformerᶎᦶ᷌
1. Transformerԅֵ֜አग़१ဳ఺ێ๢ګҘҁԅՋԍӧֵአӞӻ१҂
2. TransformerԅՋԍ Q޾ Kֵአӧݶጱ๦᯿Ꭵᴣኞ౮҅ԅ֜ӧᚆֵአݶӞӻ꧊ᬰᤈᛔ᫝ጱᅩԙҘ
ҁဳ఺޾ᒫӞӻᳯ᷌ጱڦ܄҂
3. Transformerᦇᓒ attentionጱ෸ײԅ֜ᭌೠᅩԙᘒӧฎےဩҘӷᘏᦇᓒ॔๥ଶ޾පຎӤํՋԍ܄
Ҙڦ
4. ԅՋԍࣁᬰᤈsoftmaxԏڹᵱᥝ੒ attentionᬰᤈ scaledҁԅՋԍᴻզ dkጱଘො໑҂҅ଚֵአلୗ
വ੕ᬰᤈᦖᥴ
5. ࣁᦇᓒattention scoreጱ෸ײই֜੒ padding؉ mask඙֢Ҙ
6. ԅՋԍࣁᬰᤈग़१ဳ఺ێጱ෸ײᵱᥝ੒ྯӻheadᬰᤈᴳᖌҘҁݢզ݇ᘍӤᶎӞӻᳯ᷌҂
7. य़༷ᦖӞӥTransformerጱ EncoderཛྷࣘҘ
NLP从入门到放弃
8. ԅ֜ࣁ឴ݐᬌف᦯ݻᰁԏݸᵱᥝ੒Ꭵᴣԙզembedding sizeጱ୏ොҘ఺ԎฎՋԍҘ
9. ᓌܔՕᕨӞӥTransformerጱ֖ᗝᖫᎱҘํՋԍ఺Ԏ޾սᗌᅩҘ
10. ֦ᬮԧᥴߺԶىԭ֖ᗝᖫᎱጱದ๞҅ݱᛔጱսᗌᅩฎՋԍҘ
11. ᓌܔᦖӞӥTransformerӾጱྜ૧ᕮ຅զ݊఺Ԏ̶
12. ԅՋԍtransformerֵࣘአ LayerNormᘒӧฎ BatchNormҘ LayerNorm ࣁTransformerጱ֖ᗝฎ
Ҙ᯾ߺ
13. ᓌᒼᦖӞӥBatchNormದ๞҅զ݊ਙጱսᗌᅩ̶
14. ᓌܔൈᬿӞӥTransformerӾጱڹḇᐟᕪᗑᕶҘֵአԧՋԍᄶၚڍහҘፘىսᗌᅩҘ
15. Encoderᒒ޾ Decoderᒒฎই֜ᬰᤈԻ԰ጱҘҁࣁᬯ᯾ݢզᳯӞӥىԭ seq2seqጱ attentionᎣᦩ҂
16. Decoderᴤྦྷጱग़१ᛔဳ఺޾ێ encoderጱग़१ᛔဳ఺ێํՋԍڦ܄ҘҁԅՋԍᵱᥝ decoderᛔဳ
ᵱᥝᬰᤈێ఺
 sequence mask)
17. Transformerጱଚᤈ۸൉ሿߺࣁӻࣈොҘ Decoderᒒݢզ؉ଚᤈ۸ހҘ
18. ᓌܔൈᬿӞӥwordpiece model ޾ byte pair encoding҅ํਫᴬଫአᬦހҘ
19. Transformerᦒᕞጱ෸ײ਍ԟሲฎই֜ᦡਧጱҘ Dropoutฎই֜ᦡਧጱ֖҅ᗝߺࣁ᯾Ҙ Dropout ࣁ
ၥᦶጱᵱᥝํՋԍᵱᥝဳ఺ጱހҘ
20. ୚ኩӞӻىԭbertᳯ᷌҅ bertጱ maskԅ֜ӧ਍ԟ transformerࣁ attention॒ᬰᤈ੽ᠰ scoreጱದ
ૣҘ
2. 3ړᰦ՗ᵭᥴ᧛ Transformerጱ Encoder
Transformer ړԅӷӻ᮱ړ҅encoder ޾׆ decoder ׆̶Քॠ҅౯ժᘱӞӥ encoder ׆̶ᬯ᮱ړኧ N
ӻਠقፘݶጱय़ཛྷࣘञݖᘒ౮ҁܻᦞ෈
N=6҂̶
ᬯӻᕮ຅ெԍቘᥴҘᬯӻ຅᭜੪ᵱᥝ౯ժᏟכྯӞӻཛྷࣘጱᬌ޾فᬌڊᖌଶฎፘݶጱ҅ࣁਫሿդᎱጱ෸
ײ҅౯ժݝᵱᥝਠ౮ӞӻཛྷࣘጱդᎱጱ຅᭜੪ݢզ̶
ဳᥴғ֦ݢզ಩ᬯӻᬦᑕమ᨝౮
 RNN ᒉᬦ๶ጱӞӻၞᑕ҅ฎӧฎ੪உঅቘᥴҁ୮ᆐᬯ໏మݝฎଆ֦ۗ
ቘᥴ҂̶
҅ړḇᐟᕪᗑᕶ੶̶ᬰӞྍೆڹ޾੶ێ఺ဳฎग़१ڦړ҅ࣘԅӷӻཛྷړ݈҅ࣘᬯྯӞӻय़ጱཛྷԭ੒ٌེ
޾੶ێ఺ဳԅړզݢ੶ێ఺ဳग़१
 Add&Norm ੶̶ڹḇᐟᕪᗑᕶݢզړԅ Linear ੶޾ Add&Norm
੶̶
ԭࣁ໐ஞᅩ҅੶ێ఺ဳग़१
 Q/K/V ӣӻᎥᴣٌ҅Ӿ Q/K Ꭵᴣኞ౮๦᯿Ꭵᴣ(ᕪኧ softmax)҅ᵋ޾ݸ VᎥ
̶޾๦ےک஑ᴣ
ᬯӻᬦᑕ᯿॔ԧ
 n_heads ེ҅ᬯӻ n_heads դᤒጱ੪ฎ१ጱහፓ҅ᬯ᯾ᵱᥝဳ఺ጱฎ౯ժᵱᥝᏟכ
hidden_size/n_heads ᵱᥝԅӞӻෆහ҅ӧᆐդᎱտಸᲙ̶
Add դᤒӞӻྜ૧ᕮ຅̶੒ԭྜ૧ᕮ຅҅ݢզֵ஑מ௳ݻݸڹփඎๅےᶲ኱҅ᖨᥴԧༀଶᏈᏦᳯ̶᷌ࣁ
NLP ᥯ଶ๶፡҅ྜ૧ᕮ຅ӞਧᑕଶӤ׏ᬰԧ NLP ᗑᕶᕮ຅ݻᑳᘒႮጱොݎݻ઀̶
౯ժݢզ಩
 Transformer ޾ԏڹጱཛྷࣳ੒ྲӞӥ҅ྲই RNN ཛྷࣳ҅Ӟᛱ๶᧔҅౯ժտᭌೠܔ੶RNN
౲ᘏ
Ӟӻ
 Bilstm҅੒ԭᬯԶྲ᫾փᕹጱཛྷࣳ҅ݝฎࣁ෸ᳵᳩଶӤᬰᤈԧ୊઀҅ଚဌํࣁႮଶӤ؉ጱॡ
Ⴎ̶
ಅզ᧔҅ྜ૧ᕮ຅ฎํۗԭᗑ᪠ݒႮጱ̶
NLP从入门到放弃
ᶲ׎ᘶమӞӥ Elmoֵ҅አጱฎ ݌੶ݻ݌ lstm҅ᦒᕞ᩸๶૪ᕪᶋଉౌԧ҅ಅզ੒ԭ RNNᬯᐿྲ᫾փᕹጱ
ཛྷࣳ҅؉Ⴎॡᵙԧ҅
GNMTԞฎአԧஉग़ጱ tricks ᬰᤈے᭛ᦒᕞ̶
Norm դᤒጱฎ Layer Normalization̶ԅՋԍᬯ᯾ֵአ Layer Normalization҅ᘒӧฎ BN҅ᬯӻݸᶎ
ํ෈ᒍ᧔҅ᬯ᯾ፗጮጱࢧᒼ੪ฎ҅
BNጱපຎ૧҅ಅզӧአ̶
ᵋݸग़१ဳ఺ێ੶ጱᬌڊᕪᬦڹḇᐟᕪᗑᕶ̶੒ڹḇᐟᕪᗑᕶ҅ྲ᫾ᓌܔ҅౯ժᵱᥝဳ఺ጱฎਙړԅӷ
ӻ
 Linear ੶҅ᒫӞ੶ጱᄶၚڍහԅ Relu҅ᒫԫ੶ဌํֵአᄶၚڍහ̶
๋ݸ౯ժ᧨Ӟӥෆӻ
̶ڊᬌ޾فencoderጱᬌ
ғړԅӷӻ᮱ړ҅ف᧔ᬌض
word embedding ޾ position encoding
word embedding ဌՋԍݢ᧔ጱ҅ڡত۸ݸ᪙፳ᦒᕞ౲ᘏֵአword2vecᬯᐿ૪ᕪํጱ፡ٍ֛ձۓጱප
ຎ̶
position encoding ᬯ᯾ transformer ֵአጱฎྋ֟ୡڍහᬰᤈᤒᬡ̶ٌਫᬯ᯾ᬰᤈڡত۸ᆐݸᬰᤈᦒ
ᕞԞฎݢզጱ҅ᦞ෈ܻ֢ᘏጱਫḵᤒกපຎच๜ဌڦ܄̶
੒ԭ
 position encoding ᤒᐏጱᕷ੒֖ᗝ҅ᬯᅩय़ਹ᮷ဌ୑ᦓ҅ᮎԍ position encoding ᑪᒌํဌํᤒ
ᬡፘ੒֖ᗝמ௳҅ԏݸտํӻ෈ᒍӫᳪᦖᦖᬯӻᎣᦩᅩ̶
ᆐݸ᧔Ӟӥ
 encoderጱᬌڊ҅ఽᥧஉ੝ํՈ᧨کᬯ᯾̶
encoder ጱᬌڊᵱᥝဳ఺ጱᕡᜓᅩࣁԭਙᵱᥝ޾ decoder؉Ի԰҅ಅզਙጱᬌڊԅ K/V Ꭵᴣ҅ᦕ֘ᬯӻ
ᕡᜓᅩ҅
Q Ꭵᴣ๶ᛔdecoderཛྷࣘ҅ K/VᎥᴣ๶ᛔ encoder̶
کٟᬯ᯾҅౯֌ൾᬯӣړᰦ૧ӧग़ᚆ፡ਠ҅ሿࣁဌํኸ᥺ۑᚆ҅ํᳯ᷌य़ਹلࣁռݩ੒ᦾ໛ݎᭆ҅౯ݸ
̶ᚆ፡ᥠݣ
ᚆᅩӻࣁ፡҅ᘌ᱈ժ
ѺѺᶜ᫞ఽᨀѺѺ
ܻᇇ
Transformerጱ֖ᗝᖫᎱᑪᒌํဌํ۱ތፘ੒֖ᗝמ௳
ᓌܔ༷ᬿ
Transformer ܻᇇጱ֖ᗝᖫᎱԞ੪ฎྋ֟ୡڍහᖫᎱ҅ᤒᬡጱฎᕷ੒֖ᗝמ௳҅ݶ෸۱ތፘ੒֖ᗝמ
௳̶֕ฎᕪᬦᕚ௔ݒ۸҅ፘ੒֖ᗝמ௳ၾ०̶चԭྌ҅ᵱᥝ੒֖ᗝᖫᎱᬰᤈս۸̶
ྋ෈
ܻᇇ֖ᗝᖫᎱֵአጱฎྋ֟ୡڍහ҅᭗ᬦӣ᥯ڍහ҅ݢզ஑ڊӞӻᕮᦞ੪ฎғ
զᤩݢ
ᕚ
௔ᤒᐏ̶
՗ᬯӞᅩ๶᧔ܻ҅ᇇ֖ᗝᖫᎱݢզݍଫӞਧጱፘ੒֖ᗝמ௳̶
ളӥ๶҅౯ժ๶፡҅ᕪᬦဳ఺ێ੶҅ᬯӻፘ੒֖ᗝמ௳ᬮࣁӧࣁҘ
உᓌܔ҅಩᦯ݻᰁ޾֖ᗝݻᰁ֢ԅᬌف҅ᕪᬦဳ఺ێ੶҅ᆐࢩݸୗړᥴ҅஑ࢥکӻ᮱ړ҅౯ժ᯿ᅩىဳ
۱ތӷӻӧݶ֖ᗝᖫᎱጱلୗ᮱ړ҅୵ୗইӥғNLP从入门到放弃
౯ժమᥝᦤก҅ᬯӻلୗᚆӧᚆݍଫፘ੒֖ᗝמ௳̶
ԅԧᥴ٬ᬯӻᳯ᷌҅౯ժ۸ᔺԅᓌ҅ض՗ӥᶎᬯӻلୗفಋғ
ဳ఺፡لୗ
(1)ل޾ୗ (2)ጱڦ܄҅ࣁӾᳵग़ԧӷӻᎥᴣፘԙ҅ᬯӷӻᎥᴣ҅ฎ౯ժጱ Q/KᎥᴣ҅ݢզ፡؉
ฎӞӻᕚ௔ݒ۸҅ᦕ֘ᬯӻᕡᜓᅩ̶
ᕪᬦلୗവ੕҅౯ժஉ਻ฃᎣ᭲لୗ
(2)๋ݸጱᕮຎ޾ݝӷӻ֖ᗝጱፘ੒֖ᗝ ፘى҅ᬯӻᕮຎฎ۱ތፘ
੒֖ᗝמ௳̶Ԟ੪ฎ᧔ӷӻӧݶ֖ᗝ
ጱᅩᑌጱᕮຎݢզݍฉፘ੒᪗ᐶ̶
᭗ᬦਫḵ౯ժᎣ᭲ᬯӻᕮຎय़ੜᵋ፳ፘ੒᪗ᐶጱीय़ᘒٺੜ҅꧊஑ဳ఺ጱฎਙଚӧᚆݍฉፘ੒֖ᗝጱො
̶ԅ՜ฎӞӻ੒ᑍጱࢩ҅ݻ
ٍ֛ጱ౯ժݢզ፡ӥᶎᬯӻࢶғ
உঅ҅ളӥ๶҅౯ժ੪ฎᦤก๜๶ݢզݍฉፘ੒֖ᗝמ௳ጱلୗ
(2)҅ےࣁӤӾᳵᬯӻᕚ௔ݒ۸ԏݸ҅ፘ
̶ࣁӧࣁᬮ௳מᗝ֖੒
ፗള፡පຎࢶғ NLP从入门到放弃
ᬯӻࢶᵱᥝ᯿ᅩ፡ጱӥᶎӷӻ҅Ԟ੪ฎےԧᕚ௔ݒ۸ԏݸ҅ݒ۸᩽۠՗๋Ӥᶎ᠗ᜋࢶຽጱᕚݒ౮ԧӥᶎ
ӷ๵ᕚ҅Ԟ੪ฎ᩽۠૪ᕪਠقဌํԧ̶
Ԟ੪ฎ᧔҅ਫḵᕮຎดᐏ҅لୗ
(1)ጱᕮຎᵋ፳ k ጱݒ۸ဌํกดጱ᩽۠ݒ۸҅Ԟ੪ฎ᧔ፘ੒֖ᗝמ௳ၾ
०ԧ̶
ӤᶎᬯԶٖ਻҅֌ᦇ
5ړᰦૢމݦ҅๜๶మےӤፘ੒֖ᗝᖫᎱ҅ӧᬦٖ਻Ԟꂁग़ጱ҅ӥࢧٚމݎ̶
ݶ਍ժ҅ইຎᥧٟጱᬮᤈ҅ᕳӻࣁ፡̶
4. ᧨Ӟӥፘ੒֖ᗝᖫᎱ
ᕪᬦᕚ௔ݒ۸ԏݸ҅ྋ֟ୡڍහᤒᐏጱፘ੒֖ᗝמ௳ၾ०҅ಅզᵱᥝս۸̶
Ӟᛱ๶ᦖ҅᧨کս۸҅ӣᐿྲ᫾ํݷғ
RPRҔ Transformer-XLҔ complex embeddingsҔ
౯ࣁᬯӻ෈ᒍᓌܔᦖӞӥ
RPR̶
ᘌ໏ৼ҅ӧၿ݊لکୗവ੕҅ੱᰁ಩౯ጱቘᥴᦖڊ๶̶
RPR௏᪠
RPR௏᪠உᓌܔܻ҅তྋ֟ୡڍහ҅ฎࣁᬌفጱጱ෸ײӨ᦯ݻᰁፘے֢ԅᬌف҅ࣁ attentionӶ०ፘ੒֖
ᗝמ௳҅දᬰጱᦾ੪ฎӧࣁᬌفጱ෸ײᬰᤈ֖ᗝᖫᎱ҅ᘒฎࣁ
attentionӾดᐏ಩ፘ੒֖ᗝמ௳فےᬰ
̶݄
ই֜ቘᥴፘ੒֖ᗝ
NLP从入门到放弃
ᕷ੒֖ᗝᖫᎱฎࣁྯӻ֖ᗝ᮷੒ଫӞӻࠔӞጱ֖ᗝᖫᎱמ௳҅RPR಩ᬯӞ᮱ړ݄ധ݄਍ԟӞӻፘ੒֖ᗝ
ᖫᎱ̶
Ḓض౯ժᵱᥝᎣ᭲ፘ੒֖ᗝฎํොݻጱጱ̶
Ԉӻֺৼғ
”౯ /ᆽ /Ӿࢵ /وԾؾ “
”౯ “੒ ”ᆽ “ጱፘ੒֖ᗝ੪ฎ -1҅ ”Ӿࢵ “੒ ”ᆽ “ጱፘ੒֖ᗝ੪ฎ 1̶
RPRץද௏మ
֢ᘏᦊԅࣁፘ੒֖ᗝੜԭ
4ጱ෸ײ҅ attention੒ፘ੒֖ᗝྲ᫾භఽ҅ࣁय़ԭ 4ԏݸ҅ፘ੒֖ᗝӧභఽ̶
ಅզᑻݗᦡᗝԅ
4̶
ᵱᥝဳ఺ጱฎ҅ᑻݗᦡԅ
4҅դᤒጱ୮ڹ֖ᗝૢᬟ 4ӻ҅ݦᬟԞํ 4ӻ҅ٚےӤᛔ૩҅੪ฎӞو 9ӻ֖ᗝ҅
Ԟ੪ฎғ
୮֦ጱ
attentionᬰᤈߺکӻܔ᦯ጱ෸ײ֦҅ጱ ੪੒ଫጱฎߺӻ֖ᗝ̶
ᬮฎӤᶎᮎݙᦾԈֺৼ̶
ইຎྌ෸ጱᬌفฎ
“౯ ”҅ᮎԍአکጱፘ੒֖ᗝᖫᎱ੪ฎ
ইຎྌ෸ᬌفጱฎ
“ᆽ ”҅ᮎԍᬯӻ෸ײአکጱፘ੒֖ᗝᖫᎱ੪ฎ
ԧᥴԧᬯӻ҅౯ժٚ᧨Ӟӥᬯӻፘ੒֖ᗝמ௳ฎெԍดᐏفےᬰ݄ጱ̶
̶ړԅӷӻ᮱ړفےᬯӻดᐏጱ
ᒫӞӻ᮱ړฎࣁᦇᓒ
ک݊ၿ҅ײ෸ጱ
RPRጱӞӻᤒ஄ : ҅ᤒᐏ੒ Q/K/VӣᘏӾጱ K؉ԧץද̶
ᒫԫӻ᮱ړ੪ฎࣁᦇᓒ
ጱ෸ײ҅ၿ݊ݚکӞӻ
RPRጱᤒ஄ : ҅ᤒᐏ੒ Q/K/VӣᘏӾጱ V؉ԧץද̶
ӷӻ᮱ړጱץද᮷ฎֵአےဩ̶
BN᪴ࣗᦕ --᧨Ӟӥ Batch Normalizationጱսᗌᅩ޾ᭇአ࣋ว
ᬯӻᳯ᷌ဌํਧᦞ҅உग़Ո᮷ࣁറᔱ҅ಅզݝฎᘱӞӥ౯ᛔ૩ጱቘᥴ҅ᶲ׎ԅᦖ
 layer-norm؉ӻ୚
ৼ̶
BNጱቘᥴ᯿ᅩࣁԭਙฎᰒ੒ෆӻ BatchӾጱ໏๜ݶࣁӞᖌଶᇙ஄ࣁ؉॒ቘ̶
ࣁ
MLPӾ҅ྲই౯ժํ 10ᤈ 5ڜහഝ̶ 5ڜդᤒᇙ஄҅ 10ᤈդᤒ 10ӻ໏๜̶ฎ੒ᒫӞӻᇙ஄ᬯӞڜҁ੒
ଫ
10ӻ໏๜҂؉Ӟེ॒ቘ҅ᒫԫӻᇙ஄ҁݶ໏ฎӞڜ҂؉Ӟེ॒ቘׁེ҅ᔄവ̶
ࣁ
CNNӾಘ઀҅౯ժጱහഝฎ N·C·H·W̶ٌӾ Nԅ໏๜හᰁԞ੪ฎ batch_size҅ Cԅ᭗᭲හ҅ Hԅṛ҅ W
ԅ਼҅
BNכኸ C᭗᭲හ҅ࣁ N,H,WӤ؉඙̶֢ྲই᧔಩ᒫӞӻ໏๜ጱᒫӞӻ᭗᭲ጱහഝ҅ᒫԫӻ໏๜ᒫ
Ӟӻ᭗᭲ጱහഝ
.....ᒫ Nӻ໏๜ᒫӞӻ᭗᭲ጱහഝ֢ԅܻতහഝ॒҅ቘ஑کፘଫጱ࣐꧊޾ො૧̶
BNํӷӻսᅩ̶
NLP从入门到放弃
ᒫӞӻ੪ฎݢզᥴ٬ٖ᮱ݒܐᰁ؇ᑏ҅ᓌܔ๶᧔ᦒᕞᬦᑕӾ҅ݱ੶ړ૲ӧݶ҅ीय़ԧ਍ԟᵙଶ҅BNᖨ
ᥴԧᬯӻᳯ̶᷌୮ᆐݸ๶Ԟํᦞ෈ᦤก
BNํ֢አ޾ᬯӻဌىᔮ҅ᘒฎݢզֵഖ०ଘᶎๅےጱଘჶ҅՗
ᘒےளጱත඼᭛ଶ̶
ᒫԫӻսᅩ੪ฎᖨᥴԧༀଶ᷷޾ᳯ᷌ҁইຎֵአ
sigmoidᄶၚڍහጱᦾ҂҅ےளත඼̶
BNጱᗌᅩғ
ᒫӞӻ҅
batch_size᫾ੜጱ෸ײ҅පຎ૧̶ᬯӞᅩஉ਻ฃቘᥴ̶ BNጱᬦᑕֵ҅አ ෆӻ batchӾ໏๜ጱ࣐
꧊޾ො૧๶ཛྷ೙ق᮱හഝጱ࣐꧊޾ො૧҅ࣁ
batch_size ᫾ੜጱ෸ײ҅පຎᙗਧӧঅ̶
ᒫԫӻᗌᅩ੪ฎ
 BN ࣁRNNӾපຎྲ᫾૧̶ᬯӞᅩ޾ᒫӞᅩܻࢩஉᔄ֒҅ӧᬦ౯ܔ೴ڊ๶᧔̶
Ḓض౯ժᥝ఺ᦩکӞᅩ҅੪ฎ
RNNጱᬌفฎᳩଶฎۖாጱ҅੪ฎ᧔ྯӻ໏๜ጱᳩଶฎӧӞ໏ጱ̶
Ԉӻ๋ᓌܔጱֺৼ҅ྲই
 batch_size ԅ10҅Ԟ੪ฎ౯ํ 10ӻ໏๜ٌ҅Ӿ 9ӻ໏๜ᳩଶԅ 5҅ᒫ 10ӻ໏๜
ᳩଶԅ
20̶
ᮎԍᳯ᷌๶ԧ҅ڹԲӻܔ᦯ጱ࣐꧊޾ො૧᮷ݢզࣁᬯӻ
batchӾ࿢ڊ๶՗ᘒཛྷࣳ፥ਫ࣐꧊޾ො૧̶֕ฎ
ᒫ
6ӻܔ᦯کବ 20ӻܔ᦯ெԍېҘ
ݝአᬯӞӻ໏๜ᬰᤈཛྷࣳጱᦾ҅ӧ੪ฎکࢧԧᒫӞᅩ҅
batchॡੜ҅੕ᛘපຎஉ૧̶
ᒫӣӻᗌᅩ੪ฎࣁၥᦶᴤྦྷጱᳯ᷌҅ړӣ᮱ړ᧔̶
Ḓضၥᦶጱ෸ײ҅౯ժݢզࣁᴚڜ᯾೉Ӟӻ
batchᬰ݄ᬰᤈᦇᓒ҅֕ฎԞํఘ٭ฎ๶Ӟӻ஠ᶳੱளڊ๶
Ӟӻ҅Ԟ੪ฎ
batchԅ 1҅ᬯӻ෸࣐ײ꧊޾ො૧ெԍېҘ
ᬯӻӞᛱฎࣁᦒᕞጱ෸ײ੪಩࣐꧊޾ො૧כਂӥ๶҅ၥᦶጱ෸ײፗളአ੪ݢզ̶ᮎԍᭌݐපຎঅጱ࣐꧊
̶᷌ො૧੪ฎӻᳯ޾
Ӟӻ໏๜ᳩଶԅک᭬҅ײ෸ၥᦶጱࣁٌེ
1000ጱ໏๜҅ࣁᦒᕞጱ෸ײ๋य़ᳩଶԅ 600҅ᮎԍݸᶎ 400ӻ
ܔ᦯ጱ࣐꧊޾ො૧ࣁᦒᕞහഝဌᏳکᬦ҅ᬯӻ෸ײெԍېҘ
ᬯӻᳯ᷌౯ժӞᛱฎࣁහഝ॒ቘጱ෸ײ੪տ؉౼ෙ̶
ᬮํӞӻᳯ᷌੪ฎ੪ฎᦒᕞᵞ޾ၥᦶᵞጱ࣐꧊޾ො૧ፘ૧ྲ᫾य़҅ᮎԍᦒᕞᵞጱ࣐꧊޾ො૧੪ӧᚆஉঅ
ጱݍଫ֦ၥᦶහഝᇙ௔҅පຎ੪ࢧ૧̶ᬯӻ෸ײ੪޾֦ጱහഝ॒ቘํىᔮԧ̶
BNֵአ࣋ว
੒ԭֵአ࣋ว๶᧔҅
BNࣁ MLP޾ CNNӤֵአጱපຎ᮷ྲ᫾অ҅ࣁ RNNᬯᐿۖா෈๜ཛྷࣳӤֵአጱྲ᫾
૧̶ᛗԭԅࠨ
NLPᶾऒ BNපຎտ૧҅ Layer norm පຎտঅ҅ӥӞӻ෈ᒍտᧇᕡᘱᘱ౯ጱቘᥴ̶
6. NLPձۓӾ -layer-normྲ BatchNormঅߺࣁ᯾
๜෈ԆᥝฎᦖӞӥ҅ԅՋԍ
NLPձۓӾ҅ྲই Transformerֵ҅አ LayerNormᘒӧฎֵአ BatchNorm
ᬯӻᳯٌ᷌ਫஉํ఺௏҅ቘᥴጱ๋໐ஞጱᅩࣁԭғԅՋԍ
LayerNormܔᇿ੒Ӟӻ໏๜ጱಅํܔ᦯؉ᖽන
̶ຎපک᩸զݢ
NLP从入门到放弃
य़ਹஃӥౌౌ፡҅౯᧔Ӟӥ౯ᛔ૩ጱቘᥴཻ҅ᬨय़֬ೌᎹ҅ইຎᥧ஑౯᧔ጱᬮᤈ҅ᅩӻࣁ፡ἩۜӞӥ̶
ࠨԅ
BNࣁ NLPӾපຎ૧
ӤӞӻ෈ᒍํ᧔
 BNጱֵአ࣋ว҅ӧᭇݳ RNNᬯᐿۖா෈๜ཛྷࣳ҅ํӞӻܻࢩฎࢩԅ batchӾጱᳩଶӧ
Ӟᛘ҅੕ᛘํጱᶌݸᶎጱᇙ஄ጱ࣐꧊޾ො૧ӧᚆ֌ᓒ̶
ᬯӻᳯٌ᷌ਫӧฎӻय़ᳯ᷌҅ݢզᖨᥴ̶౯ժݢզࣁහഝ॒ቘጱ෸ײֵ҅ݙৼᳩଶፘᬪጱࣁӞӻ
batch҅੪ݢզԧ̶ಅզᬯӧฎԅࠨ NLPӧአ BNጱ໐ஞܻࢩ̶
ࢧ஡ӞӥӤӻ෈ᒍӾ҅
BNࣁ MLPӾጱଫአ̶ BNฎ੒ྯӻᇙ஄ࣁ batch_sizeӤ࿢ጱ࣐꧊޾ො૧̶ᦕ֘҅
ฎྯӻᇙ஄̶ྲই᧔᫝ṛ҅ྲই᧔֛᯿ᒵᒵ̶ᬯԶᇙ஄᮷ํกᏟጱތԎ̶
֕ฎ౯ժమ᨝Ӟӥ҅ইຎ
BNଫአک NLPձۓӾ҅੒ଫጱฎ੒Ջԍ؉॒ቘҘ
ฎ੒ྯӞӻܔ᦯Ѻ
Ԟ੪ฎ᧔҅౯ሿࣁጱྯӞӻܔ᦯ฎ੒ଫکԧ
MLPӾጱྯӞӻᇙ஄̶
Ԟ੪ฎἕᦊԧݶࣁӞӻ֖ᗝጱܔ᦯੒ଫጱฎݶӞᐿᇙ஄҅ྲই
:“౯ /ᆽ /Ӿࢵ /وԾؾ ”޾ “Քॠ /ॠ࿈ /፥ /ӧ
Კ
”
ইֵ֜አ
BN҅դᤒ፳ᦊԅ "౯ "޾ “Քॠ ”ฎ੒ଫጱݶӞӻᖌଶᇙ஄҅ᬯ໏಍ݢզ݄؉ BN̶
य़ਹమӞӥ҅ᬯ໏؉
BN҅տํපຎހҘ
ӧտํපຎጱ҅ྯӻܔ᦯ᤒᬡጱᇙ஄ฎӧӞ໏ጱ҅ಅզೲᆙ֖ᗝ੒ܔ᦯ᇙ஄ᬰᤈᖽන҅ฎᬲᙧፗᥧጱ̶
layner-norm ጱᇙᅩ
 layner-norm ጱᇙᅩฎՋԍҘlayner-norm ؉ጱฎᰒ੒ྯӞӻ໏๜҅؉ᇙ஄ጱᖽන̶ഘݙᦾᦖ҅כኸԧ
Nᖌଶ҅ࣁ C/H/WᖌଶӤ؉ᖽන̶
Ԟ੪ฎ҅ਙᦊԅ
“౯ /ᆽ /Ӿࢵ /وԾؾ ”ᬯࢥӻ᦯ݶࣁӞӻᇙ஄ԏӥ҅ಅզचԭྌᘒ؉୭Ӟ۸̶
޾҅؉໏ᬯ
BNጱࣁڦ܄ԭ҅ӞݙᦾӾጱྯӻܔ᦯᮷ݢզ୭کӞӻݷਁݞ؉ “᧍Ԏמ௳ ”ጱӞӻᇙ஄Ӿҁ౯
ᛔ૩ᎌ᩸ጱݷਁ҅य़ਹ౜੪অ҂҅Ԟ੪ฎ᧔҅
layner-normԞฎࣁ੒ݶӞӻᇙ஄ӥጱزᔰ؉୭Ӟ۸҅ݝ
ӧᬦᬯ᯾ӧٚฎ੒ଫ
Nҁ౲ᘏ᧔ batch size҂҅ᘒฎ੒ଫጱ෈๜ᳩଶ̶
Ӥᶎᬯӻᥴ᯽҅ํӞӻᕡᜓᅩ҅੪ฎ҅ԅՋԍྯӻܔ᦯᮷ݢզ୭ک
“᧍Ԏמ௳ ”ᬯӻᇙ஄Ӿ̶य़ਹᬯԍ
మ҅ইຎᦏ֦ᤒᬡӞӻݙৼጱ᧍Ԏמ௳֦҅ெԍ؉Ҙ
๋ᓌܔጱොဩ੪ฎ᦯᧍ݻᰁጱے๦࿢޾๶ᤒᐏݙৼݻᰁ҅ᬯӞᅩဌᳯ᷌މ̶ҁ୮ᆐ֦Ԟݢզᛔ૩चԭᛔ
૩ጱձۓ݄ᦒᕞ᧍Ԏݻᰁ҅ᬯ᯾ݝฎ᧔๋ፗᥧጱېဩ҂
Ӥᶎᬯӻොဩ੪ฎڊԭྯӻܔ᦯᮷ฎ᧍Ԏמ௳ጱӞ᮱ړᬯӻ
insight̶
୚ኩ
-ԅࠨ BNࣁ CNNݢզᘒࣁ NLPӧݢզ
֕ฎ҅౯ᬮమᳯӞӻᳯ᷌҅
CNNӾᦤก BNපຎฎஉঅጱ҅ NLPӾጱ෈๜ݢզᔄྲԅ؟ࢶ҅ԅՋԍ BNࣁ
؟ࢶӾපຎঅ҅ࣁ෈๜Ӥපຎ૧̶
౯ฎᬯ໏ቘᥴጱ̶ᬮฎڟکࢧ಍҅
BNฎ੒ܔ᦯؉ᖽන҅ࣁ NLPӾ҅ܔ᦯ኧ᦯ݻᰁ๶ᤒᬡ҅๜ᨶӤฎ੒᦯
ݻᰁᬰᤈᖽන̶᦯ݻᰁฎՋԍҘฎ౯ժ਍ԟڊ๶ጱ݇හ๶ᤒᐏ᦯᧍᧍Ԏጱ݇හ҅ӧฎ፥ਫਂࣁጱ̶
NLP从入门到放弃
ࢶই᧔҅Ӟୟྲ̶௳מጱํࢴތᔰӾ۱؟҅ጱࣁਂᔰฎ፥ਫ؟ጱ؟ࢶ҅ڦ܄ጱӞӻ؟ࢶ޾ᬯ੪ฎNLP
؟๋҅ӤᶎጱӞᤈ؟ᔰ҅ݢզ୭ԅᙧวᬯӻᇙ஄ҁᬯ᯾ݝฎԅԧቘᥴ҅
CNN؉ BNฎचԭෆӻ feature
map҅ᘒӧฎܔᇿ຤Ӟᤈ؟ᔰ҂̶
ᬯӻቘᥴӧᏟכྋᏟ҅ݝฎ౯ᛔ૩ጱቘᥴҁᦕ஑ฎ՗ӞӻᎣԒᒼໜ፡کጱ҅දॠঅঅತӞತ҂
ᓌᒼ᧔Ӟӥ
کٟᬯ᯾҅౯ٟ෈ᒍӧฎԅԧവ੕لୗ҅ࢩԅᬯᐿവ੕෈ᒍॡग़ԧ҅ᘒฎమᦏय़ਹ፡ԧ౯ጱ෈ᒍԏݸٚ
݄፡ᬯԶവ੕لୗᚆड़ๅے਻ฃቘᥴ̶
ᆐݸय़ਹํᳯ᷌ጱᦾ҅ᐺ޾מ౯᧔҅౯ԞᎣ᭲౯ᛔ૩ٟጱߺ᯾ํᳯ᷌҅অදᬰ̶
ᅩӻࣁ፡ٚᩳަ҅ᘌ୞
7. ᧨Ӟ᧨Decoderཛྷࣘ
๜෈Ԇᥝฎ᧨ӞԶྲ᫾਻ฃ᧏ᥴጱᕡᜓᅩ҅᧔ਫᦾ҅಩ᛔ૩ጱቘᥴአ෈ਁᤒᬡڊ๶፥ฎӻᕡᛘၚ̶
ইຎᥧ஑੒఍ํᅩଆۗ҅ଆ஬ᅩӻࣁ፡౲ᘏᩩ̶
Ӟӻੜੜጱᳯ᷌
౯ض᧔Ӟӻᛔ૩ᜰԧᅩ෸ᳵ಍቟ᐃڊ๶ጱӳᥜٌ҅ਫӧᵙ҅੪ฎ୮෸ဌ᫨ᬦ୦๶̶
౯ժ᮷Ꭳ᭲҅
decoderጱԻ԰੶҅ QᎥᴣ๶ᛔ๜᫝҅ K/VᎥᴣ๶ᛔෆӻ Encoder੶ᬌڊ̶
֕ฎ੒ԭྯӻܔ᦯᮷տํӞӻ
encoderጱᬌڊ҅ᮎԍ K/VᎥᴣฎአጱٌӾߺӻᬌڊᦇᓒᬦ๶ጱҘ
౯ᬯӻᳯ᷌ጱᳯဩٌਫฎᲙ᧏ጱ̶
౯୮෸ጱቘᥴᙧวฎᦊԅᬯӻԻ԰ጱᬦᑕஉᔄ֒
seq2seqጱ attention҅ਙӞᛱฎֵአ๋ݸӞӻ෸ڰጱᵌ
੶ᬌڊ֢ԅ
context vector̶
౯चԭྌԾኞԧӤᶎᬯӻᳯ᷌҅ᬯӻ
K/VᎥᴣଫᧆኧߺӻ֖ᗝܔ᦯ҁ੒ྲ RNN੪ฎߺӻ෸ڰጱܔ᦯҂ጱ
ᬌڊኞ౮̶
ݸ๶፡ԧӞӥդᎱ҅಍กጮᛔ૩Კߺࣁ᯾Ҙ
K/VᎥᴣጱᦇᓒӧฎ๶ᛔԭ຤Ӟӻܔ᦯ጱᬌڊ҅ᘒฎಅํܔ᦯ጱᬌڊ࿤௛ᦇᓒ K/VᎥᴣ̶ᬯӻᬦᑕࣁ޾
EncoderӾᦇᓒ K/VᎥᴣฎӞ໏ጱ҅ݝӧᬦනࣁԧԻ԰੶҅Ӟ෸ဌమกጮ̶
ྋ෈
Ө
Encoderஉᔄ֒҅ Decoderݶ໏ኧਠقፘݶጱ Nӻय़ཛྷࣘञݖᘒ౮ܻ҅ᦞ෈Ӿ Nԅ 6̶
ྯӻय़ጱཛྷړࣘԅӣ᮱ړғग़१ဳ఺ێ੶҅Ի԰੶҅ڹḇᐟᕪ੶Ҕྯӻ੶ٖ᮱ੲᒒ᮷ތํ
Add&Norm̶
޾
Encoder᯿॔ጱٖ਻౯੪᪡ᬦԧ҅ԏڹᦖᬦ҅ဌ፡ᬦጱݶ਍ݢզ݄፡ᮎӻ෈ᒍ̶
NLP从入门到放弃
੶ێ఺ဳग़१ᛔ
Ḓض᧨Ӟӥग़१ᛔဳ఺ێ੶҅ᬯ᯾ᵱᥝဳ఺ጱᕡᜓᅩฎ҅ᵱᥝ੒୮ܔڹ᦯޾ԏݸጱܔ᦯؉
mask̶
ԅՋԍᵱᥝ
maskҘ
๋ଉᥢጱᥴ᯽੪ฎࣁᶼၥᴤྦྷ֦҅ጱཛྷࣳ፡ӧᥠ୮ڹ෸ڰጱᬌڊզ݊๚๶෸ܔڰ᦯̶
ᬯݙᦾٌਫํᅩᕰ҅ইຎ᧛ጱӧ՚ᕡտᦏՈ᧏ᥴԅ
maskጱ෸ײᵱᥝ಩୮ڹ෸ڰጱܔ᦯Ԟ maskധ ...(೒ڊ
މԧ෗݄
)̶
՗դᎱ᥯ଶᦖ֦҅ݝᵱᥝ಩୮ڹ෸ڰԏݸಅํܔ᦯
maskധ੪অԧ̶
౯ᛔ૩੒ᬯݙᦾጱቘᥴฎ౯ժᵱᥝᏟכཛྷࣁࣳᦒᕞ޾ၥᦶጱ෸ײဌํ
GAP̶
Ԉӻᓌܔጱֺৼ๶ቘᥴ҅ইຎ؉๢࢏ᘉᦲ֦҅ᵱᥝᘉᦲڊ๶ጱݙৼฎ
 "౯ /ᆽ /ݰ /᝘ຎ "̶
ฎڰ෸ڹ୮
”ᆽ “ᬯӻܔ᦯֢ԅᬌفጱӞ᮱ړ҅ݚӞ᮱ړฎӤӞӻ෸ڰ ”౯ “֢ԅᬌفጱ෸ײጱᬌڊ꧊̶
୮ᆐࣁ๢࢏ᘉᦲӾ҅౯ժӞᛱֵአ
 teacher forcingے᭛ත඼҅ಅզᬯ᯾੪ֵአ ”౯ “֢ԅ୮ڹ෸ڰᬌفጱ
̶ړӞӻ᮱ݚ
ಅզᬯӻ෸ײ҅ᬌف੪ฎ
”౯ “ጱᖫᎱמ௳޾ ”ᆽ “ጱᖫᎱמ௳ҁ୮ᆐᬮํ֖ᗝᖫᎱ҂̶
౯ᥝᶼၥጱฎ
̶᦯ܔᬯӻ” ݰ“
ইຎ౯ժဌํ
mask҅ཛྷࣳԞฎݢզᬩᤈጱ҅Ԟ੪᧔ྌ෸ ”ݰ “޾ ”᝘ຎ “ӷӻ᦯੒ ”ᆽ “ᬯӻ෸ڰጱᬌڊฎํ
ᨯሠጱ̶
ᮎԍᳯ᷌๶ԧ҅ၥᦶහഝӾ֦໑๜ဌํ
ground truth֦҅ெԍېҘ
Ԟ੪᧔҅ᦒᕞጱ෸ײ֦҅ጱཛྷࣳฎचԭᎣ᭲ᬯӻ෸ݸڰᶎጱܔ᦯ᬰᤈጱᦒᕞ҅֕ฎၥᦶጱ෸ײ҅؉๢࢏
ᘉᦲ֦҅ӧᎣ᭲ᛔ૩ଫᧆᘉᦲڊ๶Ջԍӳᥜ̶
ᬯ੪ฎᳯ᷌ጱ໐ஞ̶
ԧࣁᜰێᔜړӞ᮱҅ײ෸ጱࣳᦒᕞཛྷ֦
”ݰ “޾ ”᝘ຎ “ӷӻ᦯Ӥ҅ᬯӧ੪ฎ෫አހۑҘ
ಅզ҅Ꮯכཛྷࣁࣳᦒᕞ޾ၥᦶጱ෸ײဌํ
GAP҅౯ժᵱᥝ maskധ ”ݰ “޾ ”᝘ຎ “ӷӻ᦯̶
Ի԰ཛྷࣘ
ᬯӞࣘᵱᥝဳ఺ጱ੪ฎԏڹ෈ᒍ൉کጱ҅
QᎥᴣ๶ᛔ๜᫝҅ K/VᎥᴣ๶ᛔ encoderጱᬌڊ̶
ᬮํӞӻᕡᜓᅩฎ҅
K/VᎥᴣ੒ଫጱฎ๶ᛔෆӻ encoderጱᬌڊ̶
ইຎ፡
transformerᮎӻᕪَࢶጱᦾ҅ڡ๗உ਻ฃቘᥴԅ encoder޾ decode੒ଫጱྯӞ੶԰ፘԻ԰҅ᬯ
ฎӧ੒ጱ̶
ฎෆӻᬌڊӨ
decoder؉Ի԰̶
8. Transformerጱଚᤈ۸
NLP从入门到放弃
๜෈Ԇᥝ᧨Ӟӥىԭ Transformerጱଚᤈ۸̶෈ᒍྲ᫾Ꭸ҅ᭇݳय़ਹᏦᇆ۸ᴅ᧛̶
Decoderӧአग़᧔҅ဌํଚᤈ҅ݝᚆӞӻӞӻጱᥴᎱ҅உᔄ֒ԭ RNN҅ᬯӻ෸ڰጱᬌفׁᩢԭӤӞӻ෸
̶ڊጱᬌڰ
੒ԭ
Encoder׆ғ
҅ضḒ
6ӻय़ጱཛྷࣘԏᳵฎԀᤈጱ҅Ӟӻཛྷࣘᦇᓒጱᕮຎ؉ԅӥӞӻཛྷࣘጱᬌف҅԰ፘԏڹํׁᩢى
ᔮ̶
՗ྯӻཛྷࣘጱ᥯ଶ๶᧔҅ဳ఺ێ੶ڹ޾ḇᐟᕪ੶ᬯӷӻৼཛྷܔࣘᇿ๶፡᮷ฎݢզଚᤈጱ҅ӧܔݶ᦯ԏᳵ
ฎဌํׁᩢىᔮጱ̶
؉ࣁ੶ێ఺ဳԭ੒୮ᆐ
attentionጱ෸ײտׁᩢڦጱ෸ڰጱᬌف҅ӧᬦᬯӻݝᵱᥝࣁᦇᓒԏڹ੪ݢզ൉
̶׀
ᆐݸဳ఺ێ੶ڹ޾ḇᐟᕪ੶ԏᳵฎԀᤈ҅஠ᶳضਠ౮ဳ఺ێ੶ᦇᓒٚ؉ڹḇᐟᕪ੶̶
ํᅩᕰ҅ӧᎣ᭲ํဌํᦖႴ༩̶
ᓌܔᦖ҅੪ฎ
6ӻ encoderԏᳵฎԀᤈ҅ྯӻ encoderӾጱӷӻৼཛྷࣘԏᳵฎԀᤈ҅ৼཛྷࣘᛔ᫝ฎݢզଚ
ᤈጱ̶
9. ᧨Ӟӥ Transformerԅֵ֜አग़१ဳ఺ێ๢ګҘ
ᒼໜᥴຉ݇ᘍᬯ᯾ғԅՋԍ
Transformer ᵱᥝᬰᤈ Multi-head AttentionҘ
https://www.zhihu.com/question/341222779
ဳᥴғᓌࢧܔᒼ੪ฎ҅ग़१כᦤԧ
transformerݢզဳ఺کӧݶৼᑮᳵጱמ௳҅ഔ഍کๅےӿ੄ጱᇙ஄
מ௳̶ٌਫ๜ᨶӤฎᦞ෈ܻ֢ᘏݎሿᬯ໏පຎᏟਫঅ҅౯಩֢ᘏጱਫḵࣁݎࢶӥᶎғ
NLP从入门到放弃
10. TransformerԅՋԍ Q޾ Kֵአӧݶጱ๦᯿Ꭵᴣኞ౮҅ԅ֜ӧᚆ
ֵአݶӞӻ꧊ᬰᤈᛔ᫝ጱᅩԙҘ
ᒼໜᥴຉ݇ᘍᬯ᯾ғ
transformerӾԅՋԍֵአӧݶጱ K ޾ Q҅ ԅՋԍӧᚆֵአݶӞӻ꧊Ҙ - ᎣԒ
https://www.zhihu.com/question/319339652
ဳᥴғᓌࢧܔᒼ੪ฎֵ҅አ
Q/K/Vӧፘݢݶզכᦤࣁӧݶᑮᳵᬰᤈಭ୽҅ी୩ԧᤒᬡᚆێ҅൉ṛԧာ۸
̶ێᚆ
11. Transformerᦇᓒ attentionጱ෸ײԅ֜ᭌೠᅩԙᘒӧฎے
ဩҘӷᘏᦇᓒ॔๥ଶ޾පຎӤํՋԍڦ܄Ҙ
ᒼໜᥴຉғԅԧᦇᓒๅள̶ᎥᴣےဩےࣁဩᬯӞࣘጱᦇᓒᰁᏟਫᓌܔ҅֕ฎ֢ԅӞӻෆ֛ᦇᓒ
attention
ጱ෸ײፘ୮ԭӞӻᵌ੶҅ෆ֛ᦇᓒᰁ޾ᅩᑌፘ̶֒ࣁපຎӤ๶᧔҅՗ਫḵړຉ҅ӷᘏጱපຎ޾
҅ىdkፘ
dk᩼य़҅ےဩጱපຎ᩼ด៪̶ๅٍ֛ጱᕮຎ҅य़ਹݢզ፡Ӟӥਫḵࢶ (՗ឰৼݶ਍ᮎ᯾፡کጱ҅ӫᳪ݄
፡ԧӞӥᦞ෈
)ғ
NLP从入门到放弃
12. ԅՋԍࣁᬰᤈsoftmaxԏڹᵱᥝ੒ attentionᬰᤈ scaledҁԅ
Ջԍᴻզ
dkጱଘො໑҂҅ଚֵአلୗവ੕ᬰᤈᦖᥴ
ᒼໜᥴຉ݇ᘍᬯ᯾ғ
transformerӾጱ attentionԅՋԍ scaled? - LinTጱࢧᒼ - ᎣԒ
https://www.zhihu.com/question/339723385/answer/782509914
ဳᥴғᰒ੒य़֬ࢧᒼጱᒫԫӻᳯ᷌҅Ԟ੪ฎො૧ጱᳯ᷌҅౯ᓌܔጱٟԧӞӻդᎱḵᦤԧӞӥ҅ӧౄ఺፡
لୗവ੕ጱݶ਍ፗള፡դᎱᕮຎ੪ݢզ̶դᎱইӥ
:
import numpy as np
arr1=np.random.normal(size=(3,1000))
arr2=np.random.normal(size=(3,1000))
result=np.dot(arr1.T,arr2)
arr_var=np.var(result)
print(arr_var) #result: 2.9 (च๜Ӥ੪ฎ 3҅޾੪ฎ౯ժᦡਧጱᖌଶ )
NLP从入门到放弃
13. ᦇᓒattention scoreጱ෸ײই֜੒ padding؉ mask඙֢Ҙ
ᒼໜᥴຉғ
padding֖ᗝᗝԅᨮ෫ᑫ (Ӟᛱ๶᧔ -1000੪ݢզ )̶੒ԭᬯӞᅩ҅ၿ݊ک batch_sizeԏᔄጱ҅
ٍ֛ጱय़ਹݢզ፡Ӟӥ಼಼᚜ਫሿጱრդᎱ҅
ᅩࣁڋᬯ᯾
ᬯӻฎ๋ෛᇇ҅ྲ᫾ᘌᇇ๜ጱਫሿ࣎ࣈ౯ԞᗔڜӞӥ҅ଫᧆဌڦ܄ࠨ҅౯ဌᕡ፡҅Ӟፗአጱᘌᇇ๜ጱ҅
ᅩڋᬯ᯾
ᔮڜ௛ᕮ
ෆӻ
TransformerᬯӞࣘच๜੪ฎᦖਠԧ҅च๜Ӥݢզᥴ٬ԏڹᮎӻىԭ transformerᶎᦶ᷌ጯړԏك
܈ጱ᷌ፓ̶
ᛗԭۃӥጱ᷌ፓտනࣁԏڦݸጱཛྷ݄ࣘᦖ҅ྲই
 wordpiece model տࣁ௛ᕮ๢࢏ᘉᦲᎣᦩᅩጱ෸ٟײ
Ӟӥ҅ᆐݸ
 GPT տࣁ௛ᕮ᦯ݻᰁᎣᦩᅩጱ෸ٟײӞӥ̶
ݩռلמஙဳىᬨय़ਹཻ
: NLP՗فᳪکන୒
NLP从入门到放弃