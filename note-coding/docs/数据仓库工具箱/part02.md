## 第二章 Kimball 维度建模技术概述[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#第二章-kimball-维度建模技术概述)

### 2.1 基本概念[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-1-基本概念)

#### 2.1.1 收集业务需求与数据展现[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-1-1-收集业务需求与数据展现)

- 与业务代表交流发现需求
- 理解基于关键性能指标、竞争性商业问题、决策制定过程、支持分析需求
- 数据实际情况可以通过与源系统专家交流，构建高层次数据分析访问数据可行性来揭示

#### 2.1.2 协作维度建模研讨[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-1-2-协作维度建模研讨)

- 建模者与业务代表讨论协作是关键

#### 2.1.3 4步骤维度设计过程[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-1-3-4步骤维度设计过程)

- 选择业务过程
- 声明粒度
- 确认维度
- 确认事实

根据此，设计组确定表名、列名、示例领域值以及业务规则。业务管理代表必须参与详细的设计活动，以确保覆盖正确的业务

#### 2.1.4 业务过程[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-1-4-业务过程)

业务过程是组织完成的操作型活动，例如，获取订单、处理保险理赔、学生课程注册或每个月账单快照。

业务过程对应事实表。过程选择非常重要，过程定义了特定的设计目标以及对粒度、维度、事实的定义。每个业务过程对应企业数据仓库总线矩阵的一行

#### 2.1.5 粒度[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-1-5-粒度)

声明粒度是维度设计的重要步骤。

粒度用于确定某一事实表的行表示什么。选择维度或事实前必须声明粒度，因为每个候选维度或事实必须与定义的维度保持一致。

原子粒度是最低级别的粒度，应从原理粒度开始设计。上卷汇总粒度对性能调整非常重要，要猜测业务公共问题。

同一事实表不能混用多种粒度

#### 2.1.6 描述环境的维度[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-1-6-描述环境的维度)

参见第一章

#### 2.1.7 用于量度的试试[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-1-7-用于量度的试试)

参见第一章

#### 2.1.8 星型模型与OLAP多维数据库[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-1-8-星型模型与olap多维数据库)

参见第一章

#### 2.1.9 方便地扩展到维度模型[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-1-9-方便地扩展到维度模型)

维度模型对数据关系发生变化具有灵活的适应性。可以灵活应对如下变化

- 当事实与存在的事实表粒度一致时，可以创建新列
- 通过建立新的外键列，可以将维度关联到已经存在的事实表上，前提是维度列与事实表的粒度保持一致
- 可以在维度表上通过建立心裂添加属性
- 可以使事实表的粒度更加原子化，方法是在维度表上添加属性，然后以更新的粒度重置事实表，小心保存事实表及维度表的列名

### 2,2 事实表技术基础[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-2-事实表技术基础)

#### 2.2.1 事实表结构[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-2-1-事实表结构)

从最低粒度看，事实表行对应一个量度时间，反之亦然。因此事实表设计依赖物理活动

存储的是：

- 现实世界的操作型事件产生的量度值
- 参考维度表的外键
- 可选的退化维度键和日期时间戳

#### 2.2.2 可加、半可加、不可加事实[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-2-2-可加-半可加-不可加事实)

- 可加：可以按照事实表中任意维度汇总
- 半可加：可以按照事实表中某些维度汇总
- 完全不可加：例如比率

#### 2.2.3 事实表中的空值[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-2-3-事实表中的空值)

可以存放空值量度

#### 2.2.4 一致性事实[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-2-4-一致性事实)

如果某些量度出现在不同的事实表中，应保证技术定义相同，如果不兼容，应以不同的命名告诫业务用户和BI应用

#### 2.2.5 事务事实表[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-2-5-事务事实表)

每一行对应一个空间或时间上某点（事务）的事实表，一般都包含一个与维度表关联的外键

#### 2.2.6 周期快照事实表[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-2-6-周期快照事实表)

每一行对应标准周期（如一天、某周）的量度事件。粒度是周期性的，不是个体事务。

#### 2.2.7 累计快照事实表[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-2-7-累计快照事实表)

每一行汇总了发生在过程开始和结束之间可预测步骤内的量度事件。管道或工作流过程（例如履行订单或索赔过程）

#### 2.2.8 无事实的事实表[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-2-8-无事实的事实表)

没有量度，仅有关系的事实表如某天参加课程的时间

#### 2.2.9 聚集事实表或OLAP多维数据库[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-2-9-聚集事实表或olap多维数据库)

#### 2.2.10 合并事实表[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-2-10-合并事实表)

例如科技奖现货销售和销售预测合并为同一张事实表

### 2.3 维度表技术基础[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-3-维度表技术基础)

#### 2.3.1 维度表结构[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-3-1-维度表结构)

每个维度表都包含单一的主键列。通常较宽，是扁平非规范表，通常作为属性查询和约束分组的定义。

#### 2.3.2 维度代理键[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-3-2-维度代理键)

一般维度表的主键是一个自增的id（维度代理建），日期维度的维度表不需要遵循代理建规则。

#### 2.3.3 自然键、持久建和超自然键[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-3-3-自然键-持久建和超自然键)

- 自然键例子：工号
- 超自然键或持久建例子：离职员工重新入职该键不会发生变化的键

#### 2.3.4 下钻[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-3-4-下钻)

根据维度表的属性进行`group by`

#### 2.3.5 退化维度[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-3-5-退化维度)

维度除了之间没有其他内容的情况，可以放入事实表中

#### 2.3.6 非规范化扁平维度[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-3-6-非规范化扁平维度)

非规范化有利于提高时间效率

#### 2.3.7 多层级维度[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-3-7-多层级维度)

例如日历日期维度可以按照财务周期层次从天到周进行划分，也可能存在从天到月再到年的层次。位置密集型维度可能包含多个地理层次。再次情况下，同一维度中可以存在不同的层次

#### 2.3.8 文档属性的标识和指示器[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-3-8-文档属性的标识和指示器)

操作码应分解为属性枚举

#### 2.3.9 维度表中的空值属性[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-3-9-维度表中的空值属性)

建议采取特殊描述字符串描述空值属性

#### 2.3.10 日历日期维度[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-3-10-日历日期维度)

使用时期作为主键

#### 2.3.11 扮演角色的维度[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-3-11-扮演角色的维度)

一个筛选条件，枚举值，当前记录的类型是啥？

#### 2.3.12 杂项维度[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-3-12-杂项维度)

类似于extra

#### 2.3.13 雪花维度[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-3-13-雪花维度)

维度表按照层次结构建，称之为雪花模式。应该避免使用雪花模式，雪花模式查询困难、效率低。应使用扁平化的非规范的维度表

#### 2.3.14 支架维度[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-3-14-支架维度)

某个维度表引用其他维度表，称之为支架维度。应避免使用，应通过事实表关联

### 2.4 使用一致性维度集成[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-4-使用一致性维度集成)

#### 2.4.1 一致性维度[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-4-1-一致性维度)

当不同维度表的属性具有相同的列名和领域内容时，称维度表具有一致性。

#### 2.4.2 缩减维度[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-4-2-缩减维度)

缩减维度是一种一致性维度，由基本维度的列与行的子集构成。

#### 2.4.3 跨表钻取[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-4-3-跨表钻取)

简单的说，跨表钻取意思是每个查询的行头包含相同的一致性属性时，使用不同的查询能不针对两个或更多的事实表进行查询。

#### 2.4.4 价值链[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-4-4-价值链)

待阅读、待补充

### 2.5 处理缓慢变化属性[ ](https://www.rectcircle.cn/posts/数据仓库工具箱维度建模权威指南第三版读书笔记/#2-5-处理缓慢变化属性)

- 原样保留
- 重写
- 增加新行

