# 1 åŠ¨æ‰‹å­¦æ•°ç†ç»Ÿè®¡

## 1.1 æ€»ä½“ä¸æ ·æœ¬

* æ€»ä½“ï¼šå°†è¯•éªŒçš„å…¨éƒ¨å¯èƒ½çš„è§‚å¯Ÿå€¼ç§°ä¸º**æ€»ä½“**ï¼Œè¿™äº›è§‚å¯Ÿå€¼å¯èƒ½æ˜¯æœ‰é™çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯æ— é™çš„ï¼Œåˆ†åˆ«å¯¹åº”æœ‰é™æ€»ä½“å’Œæ— é™æ€»ä½“ï¼Œæ¯ä¸€ä¸ªå¯èƒ½è§‚å¯Ÿå€¼ç§°ä¸º**ä¸ªä½“**ã€‚
> ç”±äºæ€»ä½“çš„æ¯ä¸€ä¸ªä¸ªä½“éƒ½æ˜¯éšæœºè¯•éªŒçš„ä¸€ä¸ªè§‚å¯Ÿå€¼ï¼Œå› æ­¤å®ƒæ˜¯æŸä¸€éšæœºå˜é‡$X$çš„å€¼ï¼Œä¸€ä¸ªæ€»ä½“ä¾¿å¯¹åº”ä¸€ä¸ªéšæœºå˜é‡$X$ï¼Œå¯¹éšæœºå˜é‡$X$çš„ç ”ç©¶å°±æ˜¯å¯¹æ€»ä½“çš„ç ”ç©¶ï¼Œéšæœºå˜é‡$X$å’Œæ€»ä½“å…·æœ‰ç›¸åŒçš„åˆ†å¸ƒå‡½æ•°å’Œæ•°å­—ç‰¹å¾ã€‚

* æ ·æœ¬ï¼šè®¾$X$æ˜¯å…·æœ‰åˆ†å¸ƒå‡½æ•°$F$çš„éšæœºå˜é‡ï¼Œè‹¥$X_{1}, X_{2}, \cdots, X_{n}$æ˜¯å…·æœ‰åŒä¸€åˆ†å¸ƒå‡½æ•°$F$çš„ã€ç›¸äº’ç‹¬ç«‹çš„éšæœºå˜é‡ï¼Œåˆ™ç§°$X_{1}, X_{2}, \cdots, X_{n}$ä¸ºä»åˆ†å¸ƒå‡½æ•°$F$ï¼ˆæˆ–æ€»ä½“$F$ã€æˆ–æ€»ä½“$X$ï¼‰å¾—åˆ°çš„å®¹é‡ä¸º$n$çš„ç®€å•éšæœºæ ·æœ¬ï¼Œç®€ç§°**æ ·æœ¬**ï¼Œä»–ä»¬çš„è§‚å¯Ÿå€¼$x_{1}, x_{2}, \cdots, x_{n}$ç§°ä¸º**æ ·æœ¬å€¼**ï¼Œåˆç§°ä¸º$X$çš„$n$ä¸ªç‹¬ç«‹çš„è§‚å¯Ÿå€¼ã€‚

> ç”±æ ·æœ¬çš„å®šä¹‰ï¼ˆæ ·æœ¬ä¸­$n$ä¸ªéšæœºå˜é‡ç›¸äº’ç‹¬ç«‹ï¼‰å¾—ï¼š
> - 1. æ ·æœ¬ï¼ˆ$X_{1}, X_{2}, \cdots, X_{n}$ï¼‰çš„åˆ†å¸ƒå‡½æ•°ä¸º$$F^{*}(x_{1}, x_{2}, \cdots, x_{n})=\prod_{i=1}^{n}F(x_{i})$$
> - 2. æ ·æœ¬ï¼ˆ$X_{1}, X_{2}, \cdots, X_{n}$ï¼‰çš„æ¦‚ç‡å¯†åº¦ä¸º$$f^{*}(x_{1}, x_{2}, \cdots, x_{n})=\prod_{i=1}^{n}f(x_{i})$$

## 1.2 ç»éªŒåˆ†å¸ƒå‡½æ•°ã€ç›´æ–¹å›¾ä¸ç®±çº¿å›¾

* ç»éªŒåˆ†å¸ƒå‡½æ•°ï¼šè®¾  $x_{1}, x_{2}, \cdots, x_{n}$  æ˜¯å–è‡ªæ€»ä½“åˆ†å¸ƒå‡½æ•°ä¸º  $F(x)$  çš„æ ·æœ¬ï¼Œè‹¥å°†æ ·æœ¬è§‚æµ‹å€¼ç”±å°åˆ°å¤§è¿›è¡Œæ’åˆ—ï¼Œè®°ä¸º  $x_{(1)}, x_{(2)}, \cdots, x_{(n)}$ , åˆ™  $x_{(1)}, x_{(2)}, \cdots, x_{(n)}$  ç§°ä¸ºæœ‰åºæ ·æœ¬ï¼Œç”¨æœ‰åºæ ·æœ¬ å®šä¹‰å¦‚ä¸‹å‡½æ•°
$$
F_{n}(x)=\left\{\begin{array}{ll}
0, & \text { å½“ } x<x_{(1)}, \\
k / n, & \text { å½“ } x_{(k)} \leqslant x<x_{(k+1)}, k=1,2, \cdots, n-1, \\
1, & \text { å½“ } x \geqslant x_{(n)},
\end{array}\right.
$$
åˆ™  $F_{n}(x)$  æ˜¯ä¸€éå‡å³è¿ç»­å‡½æ•°ï¼Œä¸”æ»¡è¶³
$$
F_{n}(-\infty)=0 \text { å’Œ } F_{n}(\infty)=1 .
$$

ç§°  $F_{n}(x)$  ä¸ºè¯¥æ ·æœ¬çš„ç»éªŒåˆ†å¸ƒå‡½æ•°ã€‚


> ç»éªŒåˆ†å¸ƒå‡½æ•°$F_{n}(x)$æ˜¯æ€»ä½“åˆ†å¸ƒå‡½æ•°$F(x)$çš„è‰¯å¥½çš„è¿‘ä¼¼ã€‚

ğŸ”¥ä¾‹å­: éšæœºè§‚å¯Ÿæ€»ä½“  $X$ , å¾—åˆ°ä¸€ä¸ªå®¹é‡ä¸º 10 çš„æ ·æœ¬:
$$
3.2, \quad 2.5, \quad-2, \quad 2.5, \quad 0, \quad 3, \quad 2, \quad 2.5,2, \quad 4
$$
æ±‚  $\mathrm{X}$  ç»éªŒåˆ†å¸ƒå‡½æ•°ã€‚



ğŸ¦Šè§£:    
1. æ’åº  $$-2, \quad 0, \quad 2, \quad 2, \quad 2.5, \quad 2.5, \quad 2.5, \quad 3, \quad 3.2, \quad 4 $$
2. åˆ©ç”¨å…¬å¼è®¡ç®—ï¼š
$$
F_{n}(x)=\left\{\begin{array}{ll}
0, & \text { å½“ } x<x_{(1)}, \\
k / n, & \text { å½“ } x_{(k)} \leqslant x<x_{(k+1)}, k=1,2, \cdots, n-1, \\
1, & \text { å½“ } x \geqslant x_{(n)},
\end{array}\right.
$$
3. å¾—:
$$
F_{10}(x)=\left\{\begin{array}{cc}
0, & x<-2 \\
1 / 10, & -2 \leq x<0 \\
2 / 10, & 0 \leq x<2 \\
4 / 10, & 2 \leq x<2.5 \\
7 / 10, & 2.5 \leq x<3 \\
8 / 10, & 3 \leq x<3.2 \\
9 / 10, & 3.2 \leq x<4 \\
1, & x \geq 4
\end{array}\right.
$$

* ç›´æ–¹å›¾ï¼šä¸ºç ”ç©¶æ€»ä½“åˆ†å¸ƒçš„æ€§è´¨ï¼Œé€šè¿‡ç‹¬ç«‹é‡å¤è¯•éªŒå¾—åˆ°å…¶æ ·æœ¬çš„è§‚å¯Ÿå€¼$x_{1}, x_{2}, \cdots, x_{n}$ï¼Œå°†è¿™äº›æ•°æ®è¿›è¡Œæ•´ç†ï¼Œå¹¶ä»¥è¡¨æ ¼æˆ–å›¾å½¢çš„æ–¹å¼å±•ç°å‡ºæ¥ï¼Œä»è€Œæ¨æµ‹å‡ºæ€»ä½“çš„åˆ†å¸ƒã€‚ç›´æ–¹å›¾å¯ä»¥åæ˜ æ ·æœ¬çš„æ¦‚ç‡å¯†åº¦ï¼Œç”±äºæ ·æœ¬å’Œå…¶æ€»ä½“æœä»åŒä¸€åˆ†å¸ƒï¼Œä¸”å…·æœ‰ç›¸åŒçš„æ•°å­—ç‰¹å¾ï¼Œåˆ™æ ·æœ¬çš„æ¦‚ç‡å¯†åº¦å¯çœ‹ä½œæ˜¯æ€»ä½“çš„æ¦‚ç‡å¯†åº¦ã€‚ç›´æ–¹å›¾åŒ…æ‹¬**é¢‘æ•°ç›´æ–¹å›¾**å’Œ**é¢‘ç‡ç›´æ–¹å›¾**ã€‚

> ç›´æ–¹å›¾çš„ç»˜åˆ¶æ­¥éª¤ï¼šå‡è®¾ä¸€æ ·æœ¬åŒ…å«$n$ä¸ªæ ·æœ¬å€¼$ï¼ˆx_{1}, x{2}, \cdots, x_{n}ï¼‰$
> - 1. é€‰å–åŒºé—´$[a, b]$ï¼Œ $a$è¦å°äºæ ·æœ¬ä¸­æœ€å°çš„æ ·æœ¬å€¼ï¼Œ$b$è¦å¤§äºæ ·æœ¬ä¸­æœ€å¤§çš„æ ·æœ¬å€¼;
> - 2. å°†é€‰å–çš„åŒºé—´åˆ†ä¸º$k$ä¸ªå°åŒºé—´ï¼Œå°åŒºé—´çš„é•¿åº¦è®°ä¸º$\bigtriangleup , \bigtriangleup  = \frac{b-a}{k}$;ğŸ’¡tips:å½“$n< 50$æ—¶ï¼Œ$k$å–$5 \sim 6$, å½“$n$è¾ƒå¤§æ—¶ï¼Œ$k$å–$10 \sim 20$ï¼Œè‹¥$k$å–å¤ªå¤§ï¼Œåˆ™ä¼šå‡ºç°å°åŒºé—´å†…é¢‘æ•°ä¸º$0$çš„æƒ…å†µï¼ˆåº”å°½é‡é¿å…ï¼‰;
> - 3. ç»Ÿè®¡å°åŒºé—´$([a+i\bigtriangleup , a+(i+1)\bigtriangleup ], i = 0, 1, \cdots,k-1)$å†…æ ·æœ¬ä¸­ä¸ªä½“å‡ºç°çš„æ¬¡æ•°$\{f_{j}, j = 1, 2, \cdots, k-1 \}$ï¼Œæˆ–é¢‘ç‡$\{ f_{j}/n, j = 1, 2, \cdots, k-1 \}$;
> - 4. å°†é€‰å–çš„åŒºé—´$[a, b]$ä½œä¸ºæ¨ªè½´ï¼Œæ ·æœ¬ä¸­ä¸ªä½“å‡ºç°çš„æ¬¡æ•°$\{ f_{j}, j = 1, 2, \cdots, k-1 \}$æˆ–é¢‘ç‡$\{ f_{j}/n, j = 1, 2, \cdots, k-1 \}$ä½œä¸ºçºµè½´ï¼›
> - 5. ç”»å‡ºæ¯ä¸ªå°åŒºé—´åŠå…¶å¯¹åº”çš„æ ·æœ¬ä¸­ä¸ªä½“æ¬¡æ•°ï¼ˆé¢‘æ•°ï¼‰çš„æŸ±çŠ¶å›¾åˆ™å¾—åˆ°ç›´æ–¹å›¾ã€‚

> å°†æ ·æœ¬ä¸­ä¸ªä½“å‡ºç°çš„æ¬¡æ•°$\{ f_{j}, j = 1, 2, \cdots, k-1\}$ä½œä¸ºçºµè½´å¾—åˆ°çš„ç›´æ–¹å›¾ä¸ºé¢‘æ•°ç›´æ–¹å›¾ï¼Œå°†æ ·æœ¬ä¸­ä¸ªä½“å‡ºç°çš„é¢‘ç‡$\{f_{j}/n, j = 1, 2, \cdots, k-1\}$ä½œä¸ºçºµè½´å¾—åˆ°çš„ç›´æ–¹å›¾ä¸ºé¢‘ç‡ç›´æ–¹å›¾ã€‚

ğŸ”¥ä¾‹å­ï¼šç”»å‡ºä¸‹åˆ—æ ·æœ¬çš„ç›´æ–¹å›¾
$$
\begin{aligned}
 &138, \quad 142, \quad 148, \quad 145, \quad 140, \quad 141 \\
 &138, \quad 139, \quad 144, \quad 138, \quad 139, \quad 136 \\
 &138, \quad 137, \quad 137, \quad 133, \quad 140, \quad 130\\
 &145, \quad 141, \quad 135, \quad 131, \quad 136, \quad 131\\
 &134, \quad 132, \quad 135, \quad 134, \quad 132, \quad 134\\
 &130, \quad 135, \quad 135, \quad 134, \quad 136, \quad 131\\
 &139, \quad 140, \quad 141, \quad 138, \quad 137, \quad 137\\
 &131, \quad 127, \quad 136, \quad 128, \quad 138, \quad 132\\
 &134, \quad 136, \quad 137, \quad 133, \quad 121, \quad 129\\
 &137, \quad 132, \quad 131, \quad 139, \quad 136, \quad 135\\
 \end{aligned}
$$

pythonä»£ç ï¼ˆæ±‚è§£é¢˜ï¼‰


```python
# 1. æŒ‰ç…§ç›´æ–¹å›¾çš„æ­¥éª¤ä¸€æ­¥ä¸€æ­¥ç”»å›¾
import matplotlib.pyplot as plt
# å›¾åƒåµŒå…¥
%matplotlib inline  
plt.rcParams['font.sans-serif']=['SimHei','Songti SC','STFangsong']
plt.rcParams['axes.unicode_minus'] = False  # ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·
import numpy as np
import warnings
warnings.filterwarnings("ignore")

# æ ·æœ¬å€¼
x = [138, 142, 148, 145, 140, 141,
    138, 139, 144, 138, 139, 136,
    138, 137, 137, 133, 140, 130,
    145, 141, 135, 131, 136, 131,
    134, 132, 135, 134, 132, 134,
    130, 135, 135, 134, 136, 131,
    139, 140, 141, 138, 137, 137,
    131, 127, 136, 128, 138, 132,
    134, 136, 137, 133, 121, 129,
    137, 132, 131, 139, 136, 135]

# 1. é€‰å–åŒºé—´ [a, b]
a = np.min(x) - 1
b = np.max(x) + 1

# 2. åˆ†åŒºé—´
n = len(x)
if n < 50:
    k = 6
elif n < 100:
    k = 8
else:
    k =15

delta = (b - a) / k

# 3. ç»Ÿè®¡
region_ab = np.zeros(k)   # å­˜å‚¨åŒºé—´[a, b]çš„æ¯ä¸ªå°åŒºé—´
fi = np.zeros(k)      # å­˜å‚¨æ¯ä¸ªå°åŒºé—´æ ·æœ¬å€¼çš„é¢‘æ•°
for i in range(k):
    region_ab[i] = a+i*delta + (delta / 2)

for idx, cen in enumerate(region_ab):
    for data in x:
        if data >= (cen - delta/2) and data <= (cen + delta/2):
                fi[idx] += 1
        else:
            continue

fi_n = fi / n     # è®¡ç®—é¢‘ç‡
# 4. ç”»å›¾

# plt.figure(figsize=(10, 8))
plt.bar(region_ab, fi, width=delta)   # é¢‘æ•°ç›´æ–¹å›¾
plt.title('é¢‘æ•°ç›´æ–¹å›¾')
plt.xlabel('x')
plt.ylabel('fi')
plt.show()
# plt.figure(figsize=(10, 8))
plt.bar(region_ab, fi_n, width=delta)  # é¢‘ç‡ç›´æ–¹å›¾
plt.title('é¢‘ç‡ç›´æ–¹å›¾')
plt.xlabel('x')
plt.ylabel('fi/n')
plt.show()
```


    
![png](img/output_14_0.png)
    



    
![png](img/output_14_1.png)
    



```python
# 2. åˆ©ç”¨matplotlib.pyplot ä¸­çš„histæ–¹æ³•ç›´æ¥ç”»å›¾
import matplotlib.pyplot as plt
# å›¾åƒåµŒå…¥
%matplotlib inline  
plt.rcParams['font.sans-serif']=['SimHei','Songti SC','STFangsong']
plt.rcParams['axes.unicode_minus'] = False  # ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·
import numpy as np
import warnings
warnings.filterwarnings("ignore")
# æ ·æœ¬å€¼
x = [138, 142, 148, 145, 140, 141,
    138, 139, 144, 138, 139, 136,
    138, 137, 137, 133, 140, 130,
    145, 141, 135, 131, 136, 131,
    134, 132, 135, 134, 132, 134,
    130, 135, 135, 134, 136, 131,
    139, 140, 141, 138, 137, 137,
    131, 127, 136, 128, 138, 132,
    134, 136, 137, 133, 121, 129,
    137, 132, 131, 139, 136, 135]
    
a = np.min(x) - 1
b = np.max(x) + 1
k = 8
# plt.figure(figsize=(10, 8))
plt.hist(x, bins=k, alpha=0.8, range=(a, b), density=None)  # density = None, é¢‘æ•°ç›´æ–¹å›¾
plt.title('é¢‘æ•°ç›´æ–¹å›¾')
plt.xlabel('x')
plt.ylabel('fi')
plt.show()
# plt.figure(figsize=(10, 8))
plt.hist(x, bins=k, alpha=0.8, range=(a, b), density=True)  # density = True, é¢‘ç‡ç›´æ–¹å›¾
plt.title('é¢‘ç‡ç›´æ–¹å›¾')
plt.xlabel('x')
plt.ylabel('fi/n')
plt.show()
```


    
![png](img/output_15_0.png)
    



    
![png](img/output_15_1.png)
    


* ç®±çº¿å›¾

&emsp;&emsp;é¦–å…ˆä»‹ç»**æ ·æœ¬åˆ†ä½æ•°**ï¼šè®¾æœ‰å®¹é‡ä¸º$n$çš„æ ·æœ¬è§‚å¯Ÿå€¼$x_{1}, x_{2}, \cdots, x_{n}$ï¼Œæ ·æœ¬$p$åˆ†ä½æ•°$(0<p<1)$è®°ä¸º$x_{p}$ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š(1)è‡³å°‘æœ‰$np$ä¸ªè§‚å¯Ÿå€¼å°äºæˆ–ç­‰äº$x_{p}$ï¼›(2)è‡³å°‘æœ‰$n(1-p)$ä¸ªè§‚å¯Ÿå€¼å¤§äºæˆ–ç­‰äº$x_{p}$.

> æ ·æœ¬åˆ†ä½æ•°çš„æ±‚è§£æ­¥éª¤ï¼š
> - 1. å°†$x_{1}, x_{2}, \cdots, x_{n}$æŒ‰è‡ªå°åˆ°å¤§çš„æ¬¡åºæ’åˆ—æˆ$x_{(1)}\le x_{(2)}\le \cdots\le x_{(n)}$
> - 2. ä½¿ç”¨ä¸‹è¿°å…¬å¼è®¡ç®—$x_{p}$åˆ†ä½æ•°$$x_{p}=\left \{ \begin{aligned} &x_{([np]+1)}, &å½“npä¸æ˜¯æ•´æ•°\\&\frac{1}{2}[x_{(np)}+x_{(np+1)}], &å½“npæ˜¯æ•´æ•° \end{aligned}\right.$$å…¶ä¸­ï¼Œ$[\cdot]$è¡¨ç¤ºå–æ•´ã€‚

> ç‰¹åˆ«åœ°ï¼Œå½“$p=0.25$æ—¶ï¼Œ$0.25$åˆ†ä½æ•°$x_{0.25}$ä¹Ÿè®°ä¸º$Q_{1}$, ç§°ä¸ºç¬¬ä¸€å››åˆ†ä½æ•°ï¼›å½“$p=0.5$æ—¶ï¼Œ$0.5$åˆ†ä½æ•°$x_{0.5}$ä¹Ÿè®°ä¸º$Q_{2}æˆ–M$ï¼Œç§°ä¸ºæ ·æœ¬ä¸­ä½æ•°ï¼›å½“$p=0.75$æ—¶ï¼Œ$0.75$åˆ†ä½æ•°$x_{0.75}$ä¹Ÿè®°ä¸º$Q_{3}$ï¼Œç§°ä¸ºç¬¬ä¸‰å››åˆ†ä½æ•°ã€‚

> **ç®±çº¿å›¾çš„ç”»æ³•**ï¼šç®±çº¿å›¾åŸºäºä»¥ä¸‹$5$ä¸ªæ•°å­—ç‰¹å¾æ¦‚æ‹¬ï¼Œå³ æœ€å°å€¼$Min$ã€ç¬¬ä¸€å››åˆ†ä½æ•°$Q_{1}$ã€ä¸­ä½æ•°$M$ã€ç¬¬ä¸‰å››åˆ†ä½æ•°$Q_{3}$å’Œæœ€å¤§å€¼$Max$ã€‚ç®±çº¿å›¾çš„å½¢å¼å¦‚ä¸‹
<div align=center>
<img src="figures/box.jpg"/>
</div>

ğŸ”¥ä¾‹å­ï¼šä»¥ä¸‹æ˜¯$8$ä¸ªç—…äººçš„è¡€å‹(æ”¶ç¼©å‹ï¼Œ$mmHg$)æ•°æ®ï¼Œè¯·ä½œå‡ºç®±çº¿å›¾
$$
110 \quad 102 \quad 117 \quad 122 \quad 118 \quad 150 \quad 132 \quad 123
$$

ğŸ¦Šè§£ï¼š
1. æ’åº
$$
102 \quad 110 \quad 117 \quad 118 \quad 122 \quad 123 \quad 132 \quad 150
$$

2. è®¡ç®—å„åˆ†ä½ç‚¹åŠæœ€å°æœ€å¤§å€¼
$$
\begin{aligned}
&\because np=8\times 0.25 = 2, \quad &\therefore Q_{1}=\frac{1}{2}(110+117)=113.5 \\
&\because np=8\times 0.2=5 = 4, \quad &\therefore Q_{2}=\frac{1}{2}(118+122)=120 \\
&\because np=8\times 0.75 = 6, \quad &\therefore Q_{3}=\frac{1}{2}(123+132)=127.5 \\
& Min = 110, Max = 123.
\end{aligned}
$$
3. ç”»å›¾

pythonä»£ç (ç”»ç®±çº¿å›¾ï¼‰


```python
import matplotlib.pyplot as plt 
%matplotlib inline 
plt.rcParams['font.sans-serif']=['SimHei','Songti SC','STFangsong']
plt.rcParams['axes.unicode_minus'] = False  # ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·

x = [102, 110, 117, 118, 122, 123, 132, 150]

# ç¨‹åºä¼šè‡ªåŠ¨æ‰¾å‡ºå¼‚å¸¸ç‚¹ï¼Œå³ç›¸å·®å¤ªå¤§çš„ç‚¹ï¼Œè¯¥ç‚¹< Q1-1.5(Q3-Q1)=Q1-1.5IQR æˆ–> Q3+1.5(Q3-Q1)=Q3+1.5IQR
fig, ax = plt.subplots()
plt.figure(figsize=(6,4))
ax.boxplot(x)
plt.show()
```


    
![png](img/output_24_0.png)
    



    <Figure size 432x288 with 0 Axes>


## 1.3 ç»Ÿè®¡é‡ä¸ä¸‰å¤§æŠ½æ ·åˆ†å¸ƒ

* ç»Ÿè®¡é‡ï¼šè®¾$X_{1}, X_{2}, \cdots, X_{n}$æ˜¯æ¥è‡ªæ€»ä½“$X$çš„ä¸€ä¸ªæ ·æœ¬ï¼Œ$g(X_{1}, X_{2}, \cdots, X_{n})$æ˜¯$X_{1}, X_{2}, \cdots, X_{n}$çš„å‡½æ•°ï¼Œè‹¥$g$ä¸­ä¸å«ä»»ä½•æœªçŸ¥å‚æ•°ï¼Œåˆ™ç§°$g(X_{1}, X_{2}, \cdots, X_{n})$æ˜¯ä¸€ä¸ª**ç»Ÿè®¡é‡**ã€‚
> å¸¸ç”¨ç»Ÿè®¡é‡ï¼Œè®¾$X_{1}, X_{2}, \cdots, X_{n}$æ˜¯æ¥è‡ªæ€»ä½“$X$çš„ä¸€ä¸ªæ ·æœ¬ï¼Œ$x_{1}, x_{2}, \cdots, x_{n}$æ˜¯è¿™ä¸€æ ·æœ¬çš„è§‚å¯Ÿå€¼ã€‚
> - 1. æ ·æœ¬å‡å€¼$$\overline{X} = \frac{1} {n} \sum_{i=1}^{n}X_{i}$$å¯¹åº”çš„è§‚å¯Ÿå€¼ä¸º$\overline{x} = \frac{1} {n} \sum_{i=1}^{n}x_{i}$
> - 2. æ ·æœ¬æ–¹å·®$$\begin{aligned} &1) S_{n}^{2} = \frac{1} {n} \sum_{i=1}^{n}(X_{i} - \overline{X})^{2} \\ &2) S^{2} = \frac{1} {n-1} \sum_{i=1}^{n}(X_{i} - \overline{X})^{2}, æ— åæ–¹å·®ï¼Œåº”ç”¨è¾ƒå¤š\end{aligned}$$å¯¹åº”çš„è§‚å¯Ÿå€¼åˆ†åˆ«ä¸º$s_{n}^{2} = \frac{1} {n} \sum_{i=1}^{n}(x_{i} - \overline{x})^{2}å’Œs^{2} = \frac{1} {n-1} \sum_{i=1}^{n}(x_{i} - \overline{x})^{2}$
> - 3. æ ·æœ¬æ ‡å‡†å·®$$S = \sqrt{S^{2}} = \sqrt{\frac{1} {n-1} \sum_{i=1}^{n}(X_{i} - \overline{X})^{2}}$$å¯¹åº”çš„è§‚å¯Ÿå€¼ä¸º$s = \sqrt{\frac{1} {n-1} \sum_{i=1}^{n}(x_{i} - \overline{x})^{2}}$
> - 4. æ ·æœ¬$k$é˜¶ï¼ˆåŸç‚¹ï¼‰çŸ©$$A_{k} = \frac{1}{n}\sum_{i=1}^{n}X_{i}^{k}, k =1, 2, \cdots$$å¯¹åº”çš„è§‚å¯Ÿå€¼ä¸º$a_{k} = \frac{1}{n}\sum_{i=1}^{n}x_{i}^{k}, k =1, 2, \cdots$
> - 5. æ ·æœ¬$k$é˜¶ä¸­å¿ƒçŸ©$$B_{k} = \frac{1}{n}\sum_{i=1}^{n}(X_{i} - \overline{X})^{k}, k =1, 2, \cdots$$å¯¹åº”çš„è§‚å¯Ÿå€¼ä¸º$b_{k} = \frac{1}{n}\sum_{i=1}^{n}(x_{i} - \overline{x})^{k}, k =1, 2, \cdots$

* ä¸‰å¤§æŠ½æ ·åˆ†å¸ƒ

&emsp;&emsp; (1) $\chi ^{2}$åˆ†å¸ƒï¼šè®¾$X_{1}, X_{2}, \cdots, X_{n}$æ˜¯æ¥è‡ªæ€»ä½“$N(0, 1)$çš„æ ·æœ¬ï¼Œåˆ™ç§°ç»Ÿè®¡é‡
$$\chi ^{2} = X_{1}^{2} + X_{2}^{2} + \cdots + X_{n}^{2}$$
æœä»è‡ªç”±åº¦ä¸º$n$çš„$\chi ^{2}$åˆ†å¸ƒï¼Œè®°ä¸º$\chi ^{2} \sim \chi ^{2}(n)$ã€‚ è‡ªç”±åº¦è¡¨ç¤ºä¸Šå¼ä¸­å³ç«¯åŒ…å«çš„ç‹¬ç«‹å˜é‡çš„ä¸ªæ•°ã€‚

&emsp;&emsp;$\chi ^{2}$åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°(ä¸éœ€è¦è®°)ä¸º
$$
f(y) = 
\left \{ 
    \begin{aligned}
    & \frac{1}{2^{n/2}\Gamma {(n/2})}y^{n/2-1}e^{-y/2}, &y>0 \\
    & 0, & å…¶ä»–
    \end{aligned}
\right.
$$


pythonä»£ç ï¼ˆ$\chi ^{2}åˆ†å¸ƒçš„å›¾å½¢$ï¼‰


```python
import matplotlib.pyplot as plt
%matplotlib inline
from scipy.stats import chi2
import numpy as np

fig, ax = plt.subplots(1, 1)
x = np.linspace(0.01, 30, 10000)
ax.plot(x, chi2.pdf(x, df=2), '-', label='n = 2')
ax.plot(x, chi2.pdf(x, 4), '--', label='n = 4')
ax.plot(x, chi2.pdf(x, df=10), '-.', label='n = 10')
ax.set_ylim([0, 0.5])
ax.set_xlabel("y")
ax.set_ylabel("f(y)")
ax.legend()
plt.show()
```


    
![png](img/output_29_0.png)
    



```python
# åˆ©ç”¨å®šç†ç”»å¡æ–¹åˆ†å¸ƒçš„å›¾å½¢
import matplotlib.pyplot as plt
%matplotlib inline
from scipy.stats import norm, chi2
import numpy as np

def demonstate_chi(n):
    x = 0
    for i in range(n):
        x += np.square(norm(loc=0, scale=1).rvs(size=10000))
    
    return x

x = np.linspace(0.01, 30, 10000)

n_2 = demonstate_chi(2)
n_4 = demonstate_chi(4)
n_10 = demonstate_chi(10)

plt.figure(figsize=(10, 5))
plt.subplot(1,3, 1)
plt.plot(x, chi2.pdf(x, 2), '-', label='n = 2', c='blue')
plt.hist(n_2, density=True, histtype='stepfilled', alpha=0.5)
plt.legend()
plt.subplot(1,3, 2)
plt.plot(x, chi2.pdf(x, df = 4), '--', label='n = 4', c='gray')
plt.hist(n_4, density=True, histtype='stepfilled', alpha=0.5)
plt.legend()
plt.subplot(1,3, 3)
plt.plot(x, chi2.pdf(x, 10), '-.', label='n = 10', c='red')
plt.hist(n_10, density=True, histtype='stepfilled', alpha=0.5)
plt.legend()
plt.tight_layout(w_pad=3)
plt.show()
```


    
![png](img/output_30_0.png)
    


> $\chi ^{2}$åˆ†å¸ƒçš„æ€§è´¨
> - 1. $\chi ^{2}$åˆ†å¸ƒçš„**å¯åŠ æ€§**ï¼šè®¾$\chi_{1}^{2} \sim \chi ^{2}(n1), \chi_{2}^{2} \sim \chi ^{2}{n2}$ï¼Œä¸”$\chi_{1}^{2}, \chi_{2}^{2}$ç›¸äº’ç‹¬ç«‹ï¼Œåˆ™$$\chi_{1}^{2} + \chi_{2}^{2} \sim \chi ^{2} (n1 + n2)$$
> - 2. $\chi ^{2}$åˆ†å¸ƒçš„**æœŸæœ›**å’Œ**æ–¹å·®**:è‹¥$\chi ^{2} \sim \chi ^{2}(n)$ï¼Œåˆ™$$E(\chi ^{2}) = n, D(\chi ^{2}) = 2n$$ è¯ï¼š$$\begin{aligned} &\chi ^{2} = X_{1}^{2} + X_{2}^{2} + \cdots + X_{n}^{2}, X_{i} \sim N(0, 1) \\ & æ•… E(X_{i})=0, E(X_{i}^{2}) = D(X_{i}) = 1 \\ & E(\chi ^{2}) = \sum_{i=1}^{n}E(X_{i}^{2}) = n  \\ &D(X_{i}^{2}) = E(X_{i}^{4}) - E^{2}(X_{i}^{2}) = 3 - 1 = 2 \\ & D(\chi ^{2}) = \sum_{i=1}^{n}D(X_{i}^{2}) = 2n\end{aligned}$$
> - 3. $\chi ^{2}$åˆ†å¸ƒçš„**åˆ†ä½ç‚¹**ï¼šå¯¹äºç»™å®šçš„æ­£æ•°$\alpha, 0 <\alpha <1$ï¼Œç§°æ»¡è¶³æ¡ä»¶$$P\{\chi^{2} > \chi_{\alpha} ^{2}(n)\} = \int_{\chi_{\alpha} ^{2}(n)}^{\infty}f(y)dy = \alpha$$ çš„ç‚¹$\chi_{\alpha} ^{2}(n)$ä¸º$\chi ^{2}(n)$åˆ†å¸ƒä¸Šçš„$\alpha$åˆ†ä½ç‚¹ã€‚

&emsp;&emsp; (2) $t$ åˆ†å¸ƒï¼šè®¾$X \sim N(0, 1), Y \sim \chi^{2}(n)$ï¼Œä¸”$X, Y$ç›¸äº’ç‹¬ç«‹ï¼Œåˆ™ç§°éšæœºå˜é‡
$$
t = \frac{X}{\sqrt{Y/n}}
$$
æœä»è‡ªç”±åº¦ä¸º$n$çš„$t$åˆ†å¸ƒï¼Œè®°ä¸º$t \sim t(n)$ã€‚

&emsp;&emsp;$t$åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºï¼š
$$
h(t) = \frac{\Gamma [(n+1)/2]}{\sqrt{\pi n} \Gamma (n/2)}(1 + \frac{t^{2}}{n})^{-(n+1)/2}, -\infty < t < \infty
$$

pythonä»£ç ï¼ˆç”»$t$åˆ†å¸ƒçš„å›¾åƒï¼‰


```python
import matplotlib.pyplot as plt
%matplotlib inline
from scipy.stats import t
import numpy as np

fig, ax = plt.subplots(1, 1)
x = np.linspace(-10, 10, 10000)
ax.plot(x, t.pdf(x, df=2), '-', label='n = 2', c='blue')
ax.plot(x, t.pdf(x, 9), '--', label='n = 9', c='gray')
ax.plot(x, t.pdf(x, df=10000), '-.', label='n = 10000', c='red')
ax.set_xlabel("t")
ax.set_ylabel("h(t)")
ax.legend()
plt.show()
```


    
![png](img/output_34_0.png)
    



```python
# åˆ©ç”¨å®šç†ç”» t åˆ†å¸ƒçš„åˆ†å¸ƒå‡½æ•°
import matplotlib.pyplot as plt
%matplotlib inline
from scipy.stats import norm, chi2
import numpy as np

def demonstate_t(n):
    x = 0
    y = 0
    x = norm(loc=0, scale=1).rvs(size=10000)
    y = chi2.rvs(df=n)
    t = x / np.sqrt(y/ n)
    
    return t

x = np.linspace(-10, 10, 10000)

n_2 = demonstate_t(2)
n_9 = demonstate_t(9)
n_10000 = demonstate_t(10000)

plt.figure(figsize=(10, 5))
plt.subplot(1,3, 1)
plt.plot(x, t.pdf(x, 2), '-', label='n = 2', c='blue')
plt.hist(n_2,bins=15, density=True, histtype='stepfilled', alpha=0.5)
plt.legend()
plt.subplot(1,3, 2)
plt.plot(x, t.pdf(x, df = 9), '--', label='n = 9', c='gray')
plt.hist(n_9, density=True, histtype='stepfilled', alpha=0.5)
plt.legend()
plt.subplot(1,3, 3)
plt.plot(x, t.pdf(x, 10000), '-.', label='n = 10000', c='red')
plt.hist(n_10000, density=True, histtype='stepfilled', alpha=0.5)
plt.legend(loc="upper right")
plt.tight_layout(w_pad=3)
plt.show()

```


    
![png](img/output_35_0.png)
    


> å½“$n \rightarrow \infty$æ—¶ï¼Œ$t$åˆ†å¸ƒè¿‘ä¼¼ä¸º$N(0 ,1)$åˆ†å¸ƒã€‚

> - $t$åˆ†å¸ƒçš„åˆ†ä½ç‚¹ï¼šå¯¹äºç»™å®šçš„æ­£æ•°$\alpha, 0 <\alpha <1$ï¼Œç§°æ»¡è¶³æ¡ä»¶$$P\{t > t_{\alpha}(n)\} = \int_{t_{\alpha}(n)}^{\infty}h(t)dt = \alpha$$ çš„ç‚¹$t_{\alpha}(n)$ä¸º$t(n)$åˆ†å¸ƒä¸Šçš„$\alpha$åˆ†ä½ç‚¹ã€‚
> - $h(t)$å›¾å½¢å…·æœ‰å¯¹ç§°æ€§ï¼Œå³$t_{1 - \alpha}(n) = -t_{\alpha}(n)$

&emsp;&emsp; (3) $F$ åˆ†å¸ƒï¼šè®¾$U \sim \chi ^{2}(n1), V \sim \chi ^{2}(n2)$ï¼Œä¸”$U, V$ç›¸äº’ç‹¬ç«‹ï¼Œåˆ™ç§°éšæœºå˜é‡
$$
F = \frac{U/n1}{V/n2}
$$
æœä»è‡ªç”±åº¦ä¸º$(n1, n2)$çš„$F$åˆ†å¸ƒï¼Œè®°ä¸º$F \sim F(n1, n2)$ã€‚

&emsp;&emsp;$F$åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºï¼š
$$
\psi (y) = 
\left \{
    \begin{aligned}
    & \frac{\Gamma [(n1 +n2)/2](n1/n2)^{n1/2}y^{(n1/2)-1}}{\Gamma (n1/2)\Gamma (n2/2)[1+(n1y/n2)]^{(n1+n2)/2}}, &y>0 \\
    & 0, &å…¶å®ƒ
    \end{aligned}
\right.
$$


pythonä»£ç (ç”»$F$åˆ†å¸ƒå‡½æ•°)


```python
import matplotlib.pyplot as plt
%matplotlib inline
from scipy.stats import f
import numpy as np

fig, ax = plt.subplots(1, 1)
x = np.linspace(0.01, 10, 10000)
ax.plot(x, f.pdf(x, dfn=10, dfd=40), '-', label='F~(10, 40)', c='blue')
ax.plot(x, f.pdf(x, dfn=40, dfd=10), '--', label='F~(40, 10)', c='orange')
ax.plot(x, f.pdf(x, dfn=11, dfd=3), '-.', label='F~(11, 3)', c='red')
ax.set_xlabel("y")
ax.set_ylabel("f(y)")
ax.legend()
plt.show()
```


    
![png](img/output_40_0.png)
    



```python
# åˆ©ç”¨å®šç†
import matplotlib.pyplot as plt
%matplotlib inline
from scipy.stats import chi2
import numpy as np

def demonstate_f(n1, n2):
    u = 0
    v = 0
    u = chi2.rvs(df=n1, size=10000)
    v = chi2.rvs(df=n2, size=10000)
    f = (u/n1) / (v/n2)
    
    return f

x = np.linspace(0.01, 10, 10000)

n_10_40 = demonstate_f(10, 40)
n_40_10 = demonstate_f(40 ,10)
n_11_3 = demonstate_f(11, 3)

plt.figure(figsize=(10, 5))
plt.subplot(1,3, 1)
plt.plot(x, f.pdf(x, dfn=10, dfd=40), '-', label='F~(10, 40)', c='blue')
plt.hist(n_10_40, bins=300, density=True, histtype='stepfilled', alpha=0.5)
plt.legend()
plt.subplot(1,3, 2)
plt.plot(x, f.pdf(x, dfn=40, dfd=10), '--', label='F~(40, 10)', c='orange')
plt.hist(n_40_10, bins=300, density=True, histtype='stepfilled', alpha=0.5)
plt.legend()
plt.subplot(1,3, 3)
plt.plot(x, f.pdf(x, dfn=11, dfd=3), '-.', label='F~(11, 3)', c='red')
plt.hist(n_11_3,bins=550, density=True, histtype='stepfilled', alpha=0.5)
plt.xlim([0, 10])
plt.legend(loc="upper right")
plt.tight_layout(w_pad=3)
plt.show()


```


    
![png](img/output_41_0.png)
    


> - $F$åˆ†å¸ƒçš„åˆ†ä½ç‚¹ï¼šå¯¹äºç»™å®šçš„æ­£æ•°$\alpha, 0 <\alpha <1$ï¼Œç§°æ»¡è¶³æ¡ä»¶$$P\{F > F_{\alpha}(n1, n2)\} = \int_{F_{\alpha}(n1, n2)}^{\infty}\psi (y)dy = \alpha$$ çš„ç‚¹$F_{\alpha}(n1, n2)$ä¸º$F(n1, n2)$åˆ†å¸ƒä¸Šçš„$\alpha$åˆ†ä½ç‚¹ã€‚
> - è‹¥$F \sim F(n1, n2)$ï¼Œåˆ™$$\frac{1}{F} \sim F(n2, n1)$$
> - $F_{1-\alpha}(n1, n2) =\frac{1} {F_{\alpha}(n2, n1)}$ã€‚

* ğŸ“•é‡è¦å®šç†ï¼šå…³äºæ­£æ€æ€»ä½“çš„æ ·æœ¬å‡å€¼ä¸æ ·æœ¬æ–¹å·®çš„åˆ†å¸ƒ

&emsp;&emsp;**å®šç†ä¸€**ï¼šè®¾$X_{1}, X_{2}, \cdots, X_{n}$æ˜¯æ¥è‡ªæ­£æ€æ€»ä½“$N(\mu, \sigma^{2})$çš„æ ·æœ¬ï¼Œ$\overline{X}$æ˜¯æ ·æœ¬å‡å€¼ï¼Œåˆ™
$$
\overline{X} \sim N(\mu, \sigma^{2}/n).
$$

&emsp;&emsp;**å®šç†äºŒ**ï¼šè®¾$X_{1}, X_{2}, \cdots, X_{n}$æ˜¯æ¥è‡ªæ­£æ€æ€»ä½“$N(\mu, \sigma^{2})$çš„æ ·æœ¬ï¼Œ$\overline{X} {å’Œ} S^{2}$åˆ†åˆ«æ˜¯æ ·æœ¬å‡å€¼å’Œæ ·æœ¬æ–¹å·®ï¼Œåˆ™æœ‰
$$
\begin{aligned}
& 1. \frac{(n-1)S^{2}}{\sigma^{2}} \sim \chi^{2}(n-1) \\
& 2. \overline{X}ä¸S^{2}ç›¸äº’ç‹¬ç«‹
\end{aligned}
$$

&emsp;&emsp;**å®šç†ä¸‰**ï¼šè®¾$X_{1}, X_{2}, \cdots, X_{n}$æ˜¯æ¥è‡ªæ­£æ€æ€»ä½“$N(\mu, \sigma^{2})$çš„æ ·æœ¬ï¼Œ$\overline{X} {å’Œ} S^{2}$åˆ†åˆ«æ˜¯æ ·æœ¬å‡å€¼å’Œæ ·æœ¬æ–¹å·®ï¼Œåˆ™æœ‰
$$
\frac{\overline{X} - \mu}{S/\sqrt{n}} \sim t(n-1).
$$

&emsp;&emsp;**å®šç†å››**ï¼šè®¾$X_{1}, X_{2}, \cdots, X_{n1}{å’Œ}Y_{1}, Y_{2}, \cdots, Y_{n2}$åˆ†åˆ«æ˜¯æ¥è‡ªæ­£æ€æ€»ä½“$N(\mu_1, \sigma_{1}^{2})å’ŒN(\mu_2, \sigma_{2}^{2})$çš„æ ·æœ¬ï¼Œä¸”è¿™ä¸¤ä¸ªæ ·æœ¬ç›¸äº’ç‹¬ç«‹ï¼Œåˆ™æœ‰
$$
\begin{aligned}
& 1. \frac{S_{1}^{2}/S_{2}^{2}}{\sigma_{1}^{2}/\sigma_{2}^{2}} \sim F(n1-1, n2-1) \\
& 2. å½“\sigma_{1}^{2} = \sigma_{2}^{2} = \sigma^{2}æ—¶ï¼Œ\frac{(\overline{X} - \overline{Y}) - (\mu_{1} - \mu_{2})}{S_{w}\sqrt{\frac{1}{n1}+\frac{1}{n2}}} \sim t(n1+n2-2) 
\end{aligned}
$$
å…¶ä¸­ï¼Œ$S_{w}^{2} = \frac{(n1-1)S_{1}^{2}+(n2-1)S_{2}^{2}}{n1+n2-2}$.

pythonä»£ç (éªŒè¯å®šç†)


```python
import matplotlib.pyplot as plt
%matplotlib inline
from scipy.stats import chi2, t, norm, f
import numpy as np

def theory_1(mu, sigma, n):
    x_mean = []
    for i in range(10000):
        x_mean.append(np.sum(norm.rvs(loc=mu, scale=sigma, size=n))/n)
    return x_mean

def theory_2(mu, sigma, n):
    res = []
    for i in range(10000):
        x = norm.rvs(loc=mu, scale=sigma, size=n)
        x_mean = np.mean(x)
        s2 = np.sum(np.square(x - x_mean))/(n-1)
        res.append((n-1)*s2/(sigma**2))
    return res

def theory_3(mu, sigma, n):
    res = []
    for i in range(10000):
        x = norm.rvs(loc=mu, scale=sigma, size=n)
        x_mean = np.mean(x)
        s = np.sqrt(np.sum(np.square(x - x_mean))/(n-1))
        res.append((x_mean-mu)/(s/np.sqrt(n)))
    return res

def theory_4(mu1, mu2, sigma1, sigma2, n1, n2):
    res = []
    for i in range(10000):
        x1 = norm.rvs(loc=mu1, scale=sigma1, size=n1)
        x1_mean = np.mean(x1)
        x2 = norm.rvs(loc=mu2, scale=sigma2, size=n2)
        x2_mean = np.mean(x2)
        s1_2 = np.sum(np.square(x1-x1_mean)) / (n1-1)
        s2_2 = np.sum(np.square(x2-x2_mean)) / (n2-1)
        temp1 = (s1_2/s2_2)
        temp2 = (sigma1**2/sigma2**2)
        res.append(temp1/temp2)
    return res 

mu = 5
sigma = 10
n = 5
mu1, mu2 = 1, 2
sigma1, sigma2 = 3, 4
n1, n2 = 10, 40
x_mean = theory_1(mu, sigma, n)
t2 = theory_2(mu, sigma, n)
t_ = theory_3(mu, sigma, n)
f_ = theory_4(mu1, mu2, sigma1, sigma2, n1, n2)

x1 =np.linspace(-10, 20, 10000)
x2 = np.linspace(0.01, 30, 10000)
x3 = np.linspace(-5, 5, 10000)
x4 = np.linspace(0.01, 10, 10000)

plt.figure(figsize=(10, 8))
plt.subplot(2,2, 1)
plt.plot(x1, norm.pdf(x1,loc=mu, scale=sigma/np.sqrt(n)), '-', label='N({}, {})'.format(mu, sigma**2/n), c='blue')
plt.hist(x_mean,bins=50, density=True, histtype='stepfilled', alpha=0.5)
plt.title("Theory_1")
plt.xlabel("x")
plt.ylabel("p(x)")
plt.legend()
plt.subplot(2,2, 2)
plt.plot(x2, chi2.pdf(x2, df=n-1), '--', label='X({})'.format(n-1), c='orange')
plt.hist(t2, bins=50,  density=True, histtype='stepfilled', alpha=0.5)
plt.title("Theory_2")
plt.xlabel("x")
plt.ylabel("p(x)")
# plt.xlim([0, 30])
plt.legend()
plt.subplot(2,2, 3)
plt.plot(x3, t.pdf(x3, df=n-1), '-.', label='t({})'.format(n-1), c='red')
plt.hist(t_,bins=50, density=True, histtype='stepfilled', alpha=0.5)
plt.title("Theory_3")
plt.xlabel("x")
plt.ylabel("p(x)")
plt.legend(loc="upper right")
plt.subplot(2,2, 4)
plt.plot(x4, f.pdf(x4, dfn=n1-1, dfd=n2-1), '--', label='F({}, {})'.format(n1-1, n2-1), c='orange')
plt.hist(f_, bins=50, density=True, histtype='stepfilled', alpha=0.5)
plt.title("Theory_4")
plt.xlabel("x")
plt.ylabel("p(x)")
plt.xlim([0, 10])
plt.legend()

plt.tight_layout(w_pad=3)
plt.show()
```


    
![png](img/output_46_0.png)
    


## 1.4 å‚æ•°ä¼°è®¡ä¹‹ç‚¹ä¼°è®¡çš„æ¦‚å¿µ

* ç‚¹ä¼°è®¡ï¼šè®¾æ€»ä½“$X$çš„åˆ†å¸ƒå‡½æ•°$F(x;\theta)$çš„å½¢å¼ä¸ºå·²çŸ¥ï¼Œ$\theta$æ˜¯å¾…ä¼°è®¡å‚æ•°ï¼Œ$X_{1}, X_{2}, \cdots, X_{n}$æ˜¯$X$çš„ä¸€ä¸ªæ ·æœ¬ï¼Œ$x_{1}, x_{2}, \cdots, x_{n}$æ˜¯ç›¸åº”çš„ä¸€ä¸ªæ ·æœ¬å€¼ï¼Œç‚¹ä¼°è®¡é—®é¢˜å°±æ˜¯è¦æ„é€ ä¸€ä¸ªé€‚å½“çš„ç»Ÿè®¡é‡$\hat{\theta}(X_{1}, X_{2}, \cdots, X_{n})$ï¼Œç”¨å®ƒçš„è§‚å¯Ÿå€¼$\hat{\theta}(x_{1}, x_{2}, \cdots, x_{n})$ä½œä¸ºæœªçŸ¥å‚æ•°$\theta$çš„è¿‘ä¼¼å€¼ã€‚ç§°$\hat{\theta}(X_{1}, X_{2}, \cdots, X_{n})$ä¸º$\theta$çš„**ä¼°è®¡é‡**ï¼Œ$\hat{\theta}(x_{1}, x_{2}, \cdots, x_{n})$ä¸º$\theta$çš„**ä¼°è®¡å€¼**ã€‚ç»Ÿç§°å®ƒä»¬ä¸º**ä¼°è®¡**ï¼Œç®€è®°ä¸º$\hat{\theta}$ã€‚
> ç‚¹ä¼°è®¡å°±æ˜¯ç”¨æ ·æœ¬ç»Ÿè®¡é‡å»ä¼°è®¡æ€»ä½“åˆ†å¸ƒçš„æœªçŸ¥å‚æ•°ã€‚ç”±äºä¼°è®¡é‡æ˜¯æ ·æœ¬çš„å‡½æ•°ï¼Œå› æ­¤ï¼Œå¯¹äºä¸åŒçš„æ ·æœ¬å€¼ï¼Œ$\theta$çš„ä¼°è®¡å€¼ä¸€èˆ¬æ˜¯ä¸ç›¸åŒçš„ã€‚

## 1.5 å‚æ•°ä¼°è®¡ä¹‹ç‚¹ä¼°è®¡çš„æ–¹æ³•ï¼šçŸ©ä¼°è®¡

* çŸ©ä¼°è®¡æ³•ï¼šè®¾$X$ä¸ºè¿ç»­å‹éšæœºå˜é‡ï¼Œå…¶æ¦‚ç‡å¯†åº¦ä¸º$f(x;\theta_{1},\theta_{2}, \cdots, \theta_{k})$ï¼Œæˆ–$X$ä¸ºç¦»æ•£éšæœºå˜é‡ï¼Œå…¶åˆ†å¸ƒå¾‹ä¸º$P\{X=x\}=p(x;\theta_{1},\theta_{2}, \cdots, \theta_{k})$ï¼Œå…¶ä¸­$\theta_{1},\theta_{2}, \cdots, \theta_{k}$ä¸ºå¾…ä¼°è®¡å‚æ•°ï¼Œ$X_{1}, X_{2}, \cdots, X_{n}$æ˜¯æ¥è‡ª$X$çš„æ ·æœ¬ã€‚å‡è®¾æ€»ä½“$X$çš„å‰$k$é˜¶çŸ©
$$
\mu_{l} = E(X^{l}) = \int_{-\infty}^{\infty}x^{l}f(x;\theta_{1},\theta_{2}, \cdots, \theta_{k})dx
$$
æˆ–
$$
\mu_{l} = E(X^{l}) = =\sum x^{l}p(x;\theta_{1},\theta_{2}, \cdots, \theta_{k})
$$
**ç„¶åå‡è®¾æ ·æœ¬$k$é˜¶çŸ©$A_{k}$ç­‰äºæ€»ä½“$k$é˜¶çŸ©$\mu_{k}$ï¼Œå³$A_{k} = \mu_{k}$**ï¼Œè¿™ç§åˆ©ç”¨æ ·æœ¬çŸ©ä¼°è®¡æ€»ä½“çŸ©ï¼Œä»è€Œä¼°è®¡æœªçŸ¥å‚æ•°çš„æ–¹æ³•ç§°ä¸º**çŸ©ä¼°è®¡æ³•**ã€‚
> æ ·æœ¬çŸ©å…¬å¼
> - 1. æ ·æœ¬åŸç‚¹çŸ© $$A_{k} = \frac{1}{n}\sum_{i=1}^{n}X_{i}^{k}, k =1, 2, \cdots$$
> - 2. æ ·æœ¬ä¸­å¿ƒçŸ© $$B_{k} = \frac{1}{n}\sum_{i=1}^{n}(X_{i} - \overline{X})^{k}, k =1, 2, \cdots$$

> çŸ©ä¼°è®¡æ³•çš„è§£é¢˜æ­¥éª¤ï¼š
> - 1. ç¡®å®šæ€»ä½“åˆ†å¸ƒå¾…ä¼°è®¡å‚æ•°$\theta_{i}$çš„ä¸ªæ•°$n$
> - 2. åˆ—å‡ºæ€»ä½“åˆ†å¸ƒçš„å‰$n$é˜¶çŸ©$\mu_{1}åˆ°\mu_{n}$ï¼Œ$\mu_{n}$æ˜¯å…³äºå¾…ä¼°è®¡å‚æ•°$\theta_{i}$çš„å‡½æ•°
> - 3. å°†$\mu_{1}åˆ°\mu_{n}$è”ç«‹æ–¹ç¨‹ç»„ï¼Œæ±‚è§£å¾…ä¼°è®¡å‚æ•°$\theta_{i}$
> - 4. å°†æ±‚å¾—çš„$\theta_{i}$ä¸­çš„$\mu_{k}$æ¢æˆç›¸åº”çš„$A_{k}$ï¼Œå³å¾—åˆ°å¾…ä¼°è®¡å‚æ•°çš„ä¼°è®¡å€¼

ğŸ”¥ä¾‹å­ï¼šè®¾æ€»ä½“$X$åœ¨$[a, b]$ä¸Šæœä»å‡åŒ€åˆ†å¸ƒï¼Œ$a, b$æœªçŸ¥ï¼Œ$X_{1}, X_{2}, \cdots, X_{n}$æ˜¯æ¥è‡ªæ€»ä½“$X$çš„æ ·æœ¬ï¼Œæ±‚$a, b$çš„çŸ©ä¼°è®¡é‡ã€‚

ğŸ¦Šè§£ï¼š   
1. ç¡®å®šä¼°è®¡å‚æ•°ä¸ªæ•°ï¼Œ$a, b$, $n=2$
2. æ±‚æ€»ä½“çš„å‰$2$é˜¶çŸ©
$$
\begin{aligned}
&\mu_{1} = E(X) = \frac{b-a}{2} \\
&\mu_{2} = E(X^{2}) = D(X) + E^{2}(X) = \frac{(b-a)^{2}}{12} + \frac{(b-a)^{2}}{4} \\
\end{aligned}
$$
3. è”ç«‹æ–¹ç¨‹ç»„å¹¶æ±‚è§£
$$
\left \{
\begin{aligned}
&\mu_{1} = \frac{b-a}{2} \\
&\mu_{2} =  \frac{(b-a)^{2}}{12} + \frac{(b-a)^{2}}{4} \\
\end{aligned}
\right.
$$
è§£å¾—
$$
a = \mu_{1} - \sqrt{3(\mu_{2}-\mu_{1}^{2})}, b = \mu_{1} + \sqrt{3(\mu_{2}-\mu_{1}^{2})}
$$
4. å°†ç›¸åº”çš„$\mu_{k}$æ¢æˆ$A_{k}$
$$
\begin{aligned}
&a = A_{1} - \sqrt{3(A_{2}-A_{1}^{2})} = \frac{1}{n}\sum_{i=1}^{n}X_{i} - \sqrt{3(\frac{1}{n}\sum_{i=1}^{n}X_{i}^{2}-(\frac{1}{n}\sum_{i=1}^{n}X_{i})^{2})} \\
& b = A_{1} + \sqrt{3(A_{2}-A_{1}^{2})} = \frac{1}{n}\sum_{i=1}^{n}X_{i} + \sqrt{3(\frac{1}{n}\sum_{i=1}^{n}X_{i}^{2}-(\frac{1}{n}\sum_{i=1}^{n}X_{i})^{2})}
\end{aligned}
$$

pythonä»£ç (æ±‚è§£ä¸Šé¢˜)


```python
import numpy as np
from scipy.stats import uniform

a_real = 1
b_real = 6
n = 1000
x = uniform.rvs(loc=1, scale=5, size=n)

A1 = np.sum(x) / n
A2 = np.sum(np.square(x)) / n

a_estimate = A1 - np.sqrt(3 *(A2-A1**2))
b_estimate = A1 + np.sqrt(3 *(A2-A1**2))
print("açš„çœŸå®å€¼ï¼š{}, bçš„çœŸå®å€¼ï¼š{}".format(a_real, b_real))
print("açš„çŸ©ä¼°è®¡å€¼ï¼š{:.2f}, bçš„çŸ©ä¼°è®¡å€¼ï¼š{:.2f}".format(a_estimate, b_estimate))
```

    açš„çœŸå®å€¼ï¼š1, bçš„çœŸå®å€¼ï¼š6
    açš„çŸ©ä¼°è®¡å€¼ï¼š1.08, bçš„çŸ©ä¼°è®¡å€¼ï¼š6.07
    

## 1.6 å‚æ•°ä¼°è®¡ä¹‹ç‚¹ä¼°è®¡çš„æ–¹æ³•ï¼šæå¤§ä¼¼ç„¶ä¼°è®¡

* æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ³•ï¼š

&emsp;&emsp;å¯¹äºç¦»æ•£å‹éšæœºå˜é‡:è®¾å…¶åˆ†å¸ƒå¾‹ä¸º$P\{X=s\}=p(x;\theta), \theta \in \Theta$çš„å½¢å¼å·²çŸ¥ï¼Œ$\theta$ä¸ºå¾…ä¼°è®¡å‚æ•°ï¼Œ$\Theta æ˜¯ \theta$å¯èƒ½å–å€¼çš„èŒƒå›´ã€‚è®¾$X_{1}, X_{2}, \cdots, X_{n}$æ˜¯æ¥è‡ª$X$çš„æ ·æœ¬ï¼Œåˆ™$X_{1}, X_{2}, \cdots, X_{n}$çš„è”åˆåˆ†å¸ƒå¾‹ä¸º
$$
\prod{i=1}^{n}p(x_{i};\theta).
$$
åˆè®¾$x_{1}, x_{2}, \cdots, x_{n}$æ˜¯ç›¸åº”æ ·æœ¬$X_{1}, X_{2}, \cdots, X_{n}$çš„æ ·æœ¬å€¼ã€‚æ˜“çŸ¥æ ·æœ¬$X_{1}, X_{2}, \cdots, X_{n}$å–åˆ°è§‚å¯Ÿå€¼$x_{1}, x_{2}, \cdots, x_{n}$çš„æ¦‚ç‡ï¼Œå³äº‹ä»¶$\{X_{1}=x_{1}, X_{2}=x_{2}, \cdots, X_{n}=x_{n}\}$å‘ç”Ÿçš„æ¦‚ç‡ä¸º
$$
L(\theta) = L(x_{1}, x_{2}, \cdots, x_{n}; \theta) = \prod{i=1}^{n}p(x_{i};\theta), \theta \in \Theta.
$$
è¿™ä¸€æ¦‚ç‡éš$\theta$çš„å–å€¼è€Œå˜åŒ–ï¼Œå®ƒæ˜¯$\theta$çš„å‡½æ•°ï¼Œ$L(\theta)$ç§°ä¸ºæ ·æœ¬çš„**ä¼¼ç„¶å‡½æ•°**ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œ$x_{1}, x_{2}, \cdots, x_{n}$æ˜¯å·²çŸ¥çš„æ ·æœ¬å€¼ï¼Œå³å¸¸æ•°ï¼‰ã€‚

æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ€æƒ³ï¼šå›ºå®šæ ·æœ¬è§‚å¯Ÿå€¼$x_{1}, x_{2}, \cdots, x_{n}$ï¼Œåœ¨$\theta$å–å€¼çš„å¯èƒ½èŒƒå›´$\Theta$å†…æŒ‘é€‰ä½¿ä¼¼ç„¶å‡½æ•°$L(x_{1}, x_{2}, \cdots, x_{n}; \theta)$è¾¾åˆ°æœ€å¤§çš„å‚æ•°$\hat{\theta}$ï¼Œä½œä¸ºå‚æ•°$\theta$çš„ä¼°è®¡å€¼ã€‚å³å–$\hat{\theta}$ä½¿
$$
L(x_{1}, x_{2}, \cdots, x_{n}; \hat{\theta}) = \max_{\theta \in \Theta} L(x_{1}, x_{2}, \cdots, x_{n}; \theta)
$$
è¿™æ ·å¾—åˆ°çš„$\hat{\theta}$ä¸æ ·æœ¬å€¼$x_{1}, x_{2}, \cdots, x_{n}$æœ‰å…³ï¼Œè®°ä¸º$\hat{\theta}(x_{1}, x_{2}, \cdots, x_{n})$ï¼Œç§°ä¸ºå‚æ•°$\theta$çš„**æœ€å¤§ä¼¼ç„¶ä¼°è®¡å€¼**ï¼Œç›¸åº”çš„ç»Ÿè®¡é‡$\hat{\theta}(X_{1}, X_{2}, \cdots, X_{n})$ç§°ä¸ºå‚æ•°$\theta$çš„**æœ€å¤§ä¼¼ç„¶ä¼°è®¡é‡**ã€‚

&emsp;&emsp;å¯¹äºè¿ç»­å‹éšæœºå˜é‡ï¼šä¼¼ç„¶å‡½æ•°
$$
L(\theta) = L(x_{1}, x_{2}, \cdots, x_{n}; \theta) = \prod{i=1}^{n}f(x_{i};\theta)
$$
$f(x_{i};\theta)$ä¸ºè¿ç»­éšæœºå˜é‡çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ã€‚

> æœ€å¤§ä¼¼ç„¶å‡½æ•°æ–¹æ³•çš„æ±‚è§£æ­¥éª¤
> - 1. ç¡®å®šéšæœºå˜é‡çš„åˆ†å¸ƒå¾‹ï¼ˆæ¦‚ç‡å¯†åº¦ï¼‰
> - 2. ç¡®å®šä¼¼ç„¶å‡½æ•°
> - 3. ä»¤ $\frac{d}{d\theta}L(\theta) = 0$ï¼Œæ±‚é©»ç‚¹ï¼Œä¾¿å¯ä»¥æ‰¾åˆ°ä½¿$L(\theta)$å–æå€¼çš„ä¼°è®¡å‚æ•°$\hat{\theta}$
> - 4. å¯¹äº$L(\theta)$å‡½æ•°ä¸­å­˜åœ¨å¤§é‡è¿ä¹˜é¡¹æˆ–æŒ‡æ•°é¡¹æ—¶ï¼Œå¯ä»¤$\frac{d}{d\theta}ln L(\theta) = 0$ï¼Œä¹Ÿå¯ä»¥æ±‚å¾—$\hat{\theta}$ï¼Œå› ä¸º$ln\cdot$å‡½æ•°æ˜¯å•è°ƒé€’å¢å‡½æ•°ï¼Œå¯¹ä¼¼ç„¶å‡½æ•°åš$ln\cdot$å˜æ¢ä¸ä¼šæ”¹å˜åŸå‡½æ•°çš„ç‰¹å¾ã€‚

ğŸ”¥ä¾‹å­ä¸€ï¼šè®¾$X\sim b(1, p)ï¼ˆäºŒé¡¹åˆ†å¸ƒï¼‰. X_{1}, X_{2}, \cdots, X_{n}$æ˜¯æ¥è‡ª$X$çš„ä¸€ä¸ªæ ·æœ¬ï¼Œæ±‚å‚æ•°$p$çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€‚

ğŸ¦Šè§£ï¼š
1. ç¡®å®šéšæœºå˜é‡çš„åˆ†å¸ƒå¾‹ï¼ˆæ¦‚ç‡å¯†åº¦ï¼‰
$$
P\{X=x\} = p^{x}(1-p)^{1 - x}, x=0, 1
$$
2. ç¡®å®šä¼¼ç„¶å‡½æ•°
$$
L(p) = \prod_{i=1}^{n}P\{X=x_{i}\} = \prod_{i=1}^{n}p^{x_{i}}(1-p)^{1 - x_{i}} = p^{\sum_{i=1}^{n}x_{i}}(1-p)^{\sum_{i=1}^{n}(1-x_{i})}
$$
å‡ºç°è¿ä¹˜ï¼Œå–å¯¹æ•°
$$
ln L(p) = ln[p^{\sum_{i=1}^{n}x_{i}}(1-p)^{\sum_{i=1}^{n}(1-x_{i})}] = ln[p^{\sum_{i=1}^{n}x_{i}}] + ln [(1-p)^{\sum_{i=1}^{n}(1-x_{i})}] = \sum_{i=1}^{n}x_{i}ln p + \sum_{i=1}^{n}(1-x_{i})ln(1-p)
$$
3. ä»¤$\frac{d}{dp}ln L(p) = 0$ï¼Œ è§£å¾—
$$
\hat{p} = \frac{1}{n}\sum_{i=1}{n}x_{i} = \overline{x}
$$

pythonä»£ç ï¼ˆæ±‚è§£ä¸Šé¢˜ï¼‰


```python
from sympy import *
from sympy.abc import p
from scipy.stats import bernoulli

p_real = 0.4

x = bernoulli.rvs(p_real, size=1000)

Lp = p ** sum(x) * (1-p)**sum(1-x)

dLp = diff(Lp, p, 1)
p_estimate = solve(dLp)
# å¯»æ‰¾ç¬¦åˆè¦æ±‚çš„på€¼
for i in p_estimate:
    if i > 0 and i < 1:
        p_e = i
print("pçš„çœŸå®å€¼ï¼š{}".format(p_real))
print("pçš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡å€¼ï¼š{}".format(p_e))
```

    pçš„çœŸå®å€¼ï¼š0.4
    pçš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡å€¼ï¼š389/1000
    

ğŸ”¥ä¾‹å­äºŒï¼šè®¾$X\sim N(\mu, \sigma^{2}), \mu, \sigma^{2}$ä¸ºæœªçŸ¥å‚æ•°ï¼Œ$x_{1}, x_{2}, \cdots, x_{n}$æ˜¯æ¥è‡ª$X$çš„ä¸€ä¸ªæ ·æœ¬å€¼ï¼Œæ±‚$\mu, \sigma^{2}$çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡é‡ã€‚

ğŸ¦Šè§£ï¼š
1. ç¡®å®šéšæœºå˜é‡çš„æ¦‚ç‡å¯†åº¦å‡½æ•°
$$
f(x;\mu, \sigma^{2}) = \frac{1}{\sqrt{2\pi }\sigma}e^{-\frac{(x-\mu)^{2}}{2\sigma^{2}}}
$$
2. ç¡®å®šä¼¼ç„¶å‡½æ•°
$$
L(\mu, \sigma) = \prod_{i=1}^{n} f(x_{i};\mu, \sigma^{2}) = \prod_{i=1}^{n}(\frac{1}{\sqrt{2\pi }\sigma}e^{-\frac{(x_{i}-\mu)^{2}}{2\sigma^{2}}}) = (\frac{1}{\sqrt{2\pi }\sigma})^{n}e^{-\sum_{i=1}^{n}\frac{(x_{i}-\mu)^{2}}{2\sigma^{2}}}
$$
å‡ºç°æŒ‡æ•°æ±‚å’Œé¡¹ï¼Œæ•´ç†æˆå¯¹æ•°ä¼¼ç„¶å‡½æ•°
$$
ln L(\mu, \sigma) = ln [(\frac{1}{\sqrt{2\pi }\sigma})^{n}e^{-\sum_{i=1}^{n}\frac{(x_{i}-\mu)^{2}}{2\sigma^{2}}}] = -n ln\sqrt{2\pi }\sigma - \sum_{i=1}^{n}\frac{(x_{i}-\mu)^{2}}{2\sigma^{2}}
$$
3. ä»¤$\frac{\partial }{\partial \mu}ln L(\mu, \sigma) = 0,  \frac{\partial }{\partial \sigma}ln L(\mu, \sigma) = 0$ï¼Œå»ºç«‹ä¼¼ç„¶æ–¹ç¨‹ç»„
$$
\left \{
\begin{aligned}
&\frac{\partial }{\partial \mu}ln L(\mu, \sigma) = -2 \sum_{i=1}^{n}\frac{(x_{i}-\mu)}{2\sigma^{2}} = 0 \\
&\frac{\partial }{\partial \sigma}ln L(\mu, \sigma) = - \frac{n}{\sigma} + \sum_{i=1}^{n}\frac{(x_{i}-\mu)^{2}}{\sigma^{3}} = 0
\end{aligned}
\right.
$$
4. è§£å¾—
$$
\left \{
\begin{aligned}
&\mu = \frac{1}{n}\sum_{i=1}^{n}x_{i} \\
&\sigma^{2} = \frac{1}{n}\sum_{i=1}^{n}(x_{i} - \mu)^{2}
\end{aligned}
\right.
$$

pythonä»£ç (éªŒè¯ä¸Šé¢˜ç»“æœ)


```python
from sympy import *
from sympy.abc import mu, sigma 
from scipy.stats import norm

mu_real = 2
sigma_real = 3
n = 1000

x = norm.rvs(loc=mu_real, scale=sigma_real, size=n)

mu_estimate = sum(x) / n 
sigma2_estimate = sum((x - mu_estimate)**2) / n

print("éšæœºå˜é‡çš„åŸå‡å€¼ä¸ºï¼š{}ï¼Œ æ–¹å·®ä¸ºï¼š{}".format(mu_real, sigma_real**2))
print("æœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„å‡å€¼ä¸ºï¼š{:.2f}ï¼Œ æ–¹å·®ä¸ºï¼š{:.2f}".format(mu_estimate,sigma2_estimate))
```

    éšæœºå˜é‡çš„åŸå‡å€¼ä¸ºï¼š2ï¼Œ æ–¹å·®ä¸ºï¼š9
    æœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„å‡å€¼ä¸ºï¼š2.01ï¼Œ æ–¹å·®ä¸ºï¼š9.39
    

> ğŸ’¡æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ€§è´¨ï¼šè®¾$\theta$çš„å‡½æ•°$u=u(\theta), \theta \in \Theta$å…·æœ‰*å•å€¼åå‡½æ•°*$\theta=\theta(u), u\in \vartheta$.åˆå‡è®¾$\hat{\theta}$æ˜¯$X$çš„æ¦‚ç‡åˆ†å¸ƒä¸­å‚æ•°$\theta$çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œåˆ™$\hat{u}=\hat{u}(\theta)$æ˜¯$u(\theta)$çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œè¿™ä¸€æ€§è´¨ç§°ä¸ºæœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„**ä¸å˜æ€§**ã€‚

## 1.7 ä¼°è®¡é‡çš„è¯„é€‰æ ‡å‡†ï¼šæ— åæ€§ã€æœ‰æ•ˆæ€§ã€ç›¸åˆæ€§ï¼ˆä¸€è‡´æ€§ï¼‰

è®¾$X_{1}, X_{2}, \cdots, X_{n}$æ˜¯æ€»ä½“$X$çš„ä¸€ä¸ªæ ·æœ¬ï¼Œ$\theta \in \Theta$æ˜¯åŒ…å«åœ¨æ€»ä½“$X$çš„åˆ†å¸ƒä¸­çš„å¾…ä¼°è®¡å‚æ•°ï¼Œ$\Theta æ˜¯\theta$çš„å–å€¼èŒƒå›´ã€‚

* æ— åæ€§ï¼šè‹¥ä¼°è®¡é‡$\hat{\theta} = \hat{\theta}(X_{1}, X_{2}, \cdots, X_{n})$çš„æ•°å­¦æœŸæœ›$E(\hat{\theta})$å­˜åœ¨ï¼Œä¸”å¯¹äºä»»æ„çš„$\theta \in \Theta$æœ‰
$$
E(\hat{\theta}) = \theta
$$
åˆ™ç§°$\hat{\theta}$ä¸º$\theta$çš„**æ— åä¼°è®¡é‡**ã€‚å³ä¼°è®¡å€¼çš„æœŸæœ›ç­‰äºå¾…ä¼°è®¡å‚æ•°çš„çœŸå®å€¼ã€‚

> ä¼°è®¡é‡çš„æ— åæ€§æ˜¯è¯´ï¼Œå¯¹äºæ€»ä½“çš„æ ·æœ¬å€¼ï¼Œç”±æŸä¸ªä¼°è®¡é‡å¾—åˆ°çš„ä¼°è®¡å€¼ä¸çœŸå€¼å­˜åœ¨åå·®ï¼Œä½†åå¤å°†è¿™ä¼°è®¡é‡ä½¿ç”¨å¤šæ¬¡å¾—åˆ°å¤šä¸ªä¼°è®¡å€¼ï¼Œè¿™å¤šä¸ªä¼°è®¡å€¼çš„æœŸæœ›ï¼ˆå¹³å‡ï¼‰ä¸çœŸå€¼ä¹‹é—´çš„åå·®$E(\hat{\theta})-\theta$ä¸ºé›¶ã€‚åœ¨ç§‘å­¦æŠ€æœ¯ä¸­$E(\hat{\theta})-\theta$ç§°ä¸ºä»¥$E(\hat{\theta})$ä½œä¸º$\theta$çš„ä¼°è®¡çš„ç³»ç»Ÿè¯¯å·®ã€‚æ— åä¼°è®¡çš„å®é™…æ„ä¹‰å°±æ˜¯æ— ç³»ç»Ÿè¯¯å·®ã€‚

* æœ‰æ•ˆæ€§ï¼šå‡è®¾è¦æ¯”è¾ƒå‚æ•°$\theta$çš„ä¸¤ä¸ªæ— åä¼°è®¡é‡$\hat{\theta_{1}}{å’Œ}\hat{\theta_{2}}$ï¼Œå¦‚æœåœ¨æ ·æœ¬å®¹é‡$n$ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œ$\hat{\theta_{1}}$çš„è§‚å¯Ÿå€¼è¾ƒ$\hat{\theta_{2}}$æ›´å¯†é›†åœ¨çœŸå€¼$\theta$çš„é™„è¿‘ï¼Œåˆ™è®¤ä¸º$\hat{\theta_{1}}{æ¯”}\hat{\theta_{2}}$æ›´ä¸ºç†æƒ³ã€‚åˆç”±äºæ–¹å·®æ˜¯éšæœºå˜é‡å–å€¼ä¸å…¶æ•°å­¦æœŸæœ›ï¼ˆæ­¤æ—¶æ•°å­¦æœŸæœ›$E(\hat{\theta_{1}})=E(\hat{\theta_{2}}) = \theta$ï¼‰çš„åç¦»ç¨‹åº¦çš„åº¦é‡ã€‚æ‰€ä»¥æ— åä¼°è®¡ä»¥æ–¹å·®å°è€…ä¸ºå¥½ã€‚è®¾$\hat{\theta_{1}} = \hat{\theta_{1}}(X_{1}, X_{2}, \cdots, X_{n})$ä¸$\hat{\theta_{2}} = \hat{\theta_{2}}(X_{1}, X_{2}, \cdots, X_{n})$éƒ½æ˜¯$\theta$çš„æ— åä¼°è®¡é‡ï¼Œè‹¥å¯¹äºä»»æ„$\theta \in \Theta$ï¼Œæœ‰
$$
D(\hat{\theta_{1}}) \le D(\hat{\theta_{2}})
$$
ä¸”è‡³å°‘å¯¹äºæŸä¸€ä¸ª$\theta \in \Theta$ä¸Šå¼ä¸­çš„ä¸ç­‰å·æˆç«‹ï¼Œåˆ™ç§°$\hat{\theta_{1}}$è¾ƒ$\hat{\theta_{2}}$**æœ‰æ•ˆ**ã€‚

* ç›¸åˆæ€§ï¼ˆä¸€è‡´æ€§ï¼‰ï¼šè®¾$\hat{\theta} = \hat{\theta}(X_{1}, X_{2}, \cdots, X_{n})$ä¸ºå‚æ•°$\theta$çš„ä¼°è®¡é‡ï¼Œè‹¥å¯¹äºä»»æ„$\theta \in \Theta$ï¼Œå½“$n \rightarrow \infty$æ—¶$\hat{\theta} = \hat{\theta}(X_{1}, X_{2}, \cdots, X_{n})$ä¾æ¦‚ç‡æ”¶æ•›äº$\theta$ï¼Œåˆ™ç§°$\hat{\theta}$ä¸º$\theta$çš„**ç›¸åˆä¼°è®¡é‡**ã€‚å³å¯¹äºä»»æ„$\varepsilon > 0$ï¼Œæœ‰
$$
\lim_{n\rightarrow \infty}P\{| \hat{\theta} - \theta| < \varepsilon\} = 1
$$

## 1.8 å‚æ•°ä¼°è®¡ä¹‹åŒºé—´ä¼°è®¡

* èƒŒæ™¯ï¼šå¯¹äºä¸€ä¸ªæœªçŸ¥é‡æˆ–æœªçŸ¥å‚æ•°çš„ä¼°è®¡ï¼Œå¸¸ä¸ä»¥å¾—åˆ°è¿‘ä¼¼å€¼ä¸ºæ»¡è¶³ï¼Œè¿˜éœ€ä¼°è®¡è¯¯å·®ï¼Œå³è¦æ±‚çŸ¥é“è¿‘ä¼¼å€¼çš„ç²¾ç¡®ç¨‹åº¦ï¼ˆä¹Ÿå°±æ˜¯æ‰€æ±‚çœŸå€¼çš„æ‰€åœ¨èŒƒå›´ï¼‰ã€‚ç±»ä¼¼åœ°ï¼Œå¯¹äºæœªçŸ¥å‚æ•°$\theta$ï¼Œé™¤äº†æ±‚å‡ºå®ƒçš„ç‚¹ä¼°è®¡$\hat{\theta}$å¤–ï¼Œè¿˜å¸Œæœ›ä¼°è®¡å‡ºä¸€ä¸ªèŒƒå›´ï¼Œå¹¶å¸Œæœ›çŸ¥é“è¿™ä¸ªèŒƒå›´åŒ…å«å‚æ•°$\theta$çœŸå€¼çš„å¯ä¿¡ç¨‹åº¦ã€‚è¿™æ ·çš„èŒƒå›´é€šå¸¸ä»¥åŒºé—´çš„å½¢å¼ç»™å‡ºï¼ŒåŒæ—¶è¿˜ç»™å‡ºæ­¤åŒºé—´åŒ…å«å‚æ•°$\theta$çœŸå€¼çš„å¯ä¿¡ç¨‹åº¦ï¼Œè¿™ç§å½¢å¼çš„ä¼°è®¡ç§°ä¸º**åŒºé—´ä¼°è®¡**ã€‚è¿™æ ·çš„åŒºé—´å³æ‰€è°“**ç½®ä¿¡åŒºé—´**ã€‚

* ç½®ä¿¡åŒºé—´ï¼šè®¾æ€»ä½“$X$çš„åˆ†å¸ƒå‡½æ•°$F(x;\theta)$å«æœ‰ä¸€ä¸ªæœªçŸ¥å‚æ•°$\theta, \theta \in \Thetaï¼ˆ\Theta{æ˜¯}\theta å¯èƒ½å–å€¼çš„èŒƒå›´ï¼‰$ï¼Œå¯¹äºç»™å®šå€¼$\alphaï¼ˆ0 < \alpha < 1ï¼‰$ï¼Œè‹¥æ¥è‡ª$X$çš„æ ·æœ¬$X_{1}, X_{2}, \cdots, X_{n}$ç¡®å®šçš„ä¸¤ä¸ªç»Ÿè®¡é‡$\underline{\theta} = \underline{\theta}(X_{1}, X_{2}, \cdots, X_{n}) {å’Œ}\overline{\theta} = \overline{\theta}(X_{1}, X_{2}, \cdots, X_{n}), (\underline(\theta)<\overline{\theta})$ï¼Œå¯¹äºä»»æ„$\theta \in \Theta$æ»¡è¶³
$$
P\{\underline{\theta}(X_{1}, X_{2}, \cdots, X_{n}) <\theta <\overline{\theta}(X_{1}, X_{2}, \cdots, X_{n})\} \ge 1 -\alpha
$$
åˆ™ç§°éšæœºåŒºé—´$(\underline{\theta}, \overline{\theta})$æ˜¯$\theta$ç½®ä¿¡æ°´å¹³ä¸º$1 -\alpha$çš„**ç½®ä¿¡åŒºé—´**ï¼Œ$\underline{\theta} {å’Œ} \overline{\theta}$åˆ†åˆ«ç§°ä¸ºç½®ä¿¡æ°´å¹³ä¸º$1 -\alpha$çš„åŒä¾§ç½®ä¿¡åŒºé—´çš„**ç½®ä¿¡ä¸‹é™å’Œç½®ä¿¡ä¸Šé™**ï¼Œ$1 -\alpha$ç§°ä¸ºç½®ä¿¡æ°´å¹³ã€‚

&emsp;&emsp;ä¸Šå¼çš„å«ä¹‰ä¸ºï¼šå¯¹æ€»ä½“è¿›è¡Œå¤šæ¬¡é‡å¤æŠ½æ ·ï¼ˆæ¯æ¬¡æŠ½æ ·çš„æ ·æœ¬å®¹é‡ç›¸åŒï¼Œå‡ä¸º$n$ï¼‰,æ¯ä¸€æ¬¡æŠ½æ ·éƒ½ç¡®å®šå¾…ä¼°è®¡å‚æ•°çš„ä¸€ä¸ªåŒºé—´$(\underline{\theta}, \overline{\theta})$ï¼Œæ¯ä¸ªè¿™æ ·çš„åŒºé—´æœ‰ä¸¤ç§å¯èƒ½ï¼Œå³è¦ä¹ˆåŒ…å«å¾…ä¼°è®¡çš„çœŸå€¼$\theta$ï¼Œè¦ä¹ˆä¸åŒ…å«å¾…ä¼°è®¡çš„çœŸå€¼$\theta$ã€‚æ ¹æ®å¤§æ•°å®šç†ï¼ŒåŒ…å«çœŸå€¼$\theta$çš„åŒºé—´æ•°é‡çº¦å $100(1-\alpha)\%$ï¼Œä¸åŒ…å«çœŸå€¼$\theta$çš„åŒºé—´æ•°é‡çº¦å $100\alpha \%$ã€‚ä¾‹å¦‚ï¼Œè‹¥$\alpha=0.01$ï¼Œåå¤æŠ½æ ·$1000$æ¬¡ï¼Œåˆ™å¾—åˆ°çš„$1000$ä¸ªåŒºé—´ä¸­ä¸åŒ…å«$\theta$çœŸå€¼çš„çº¦ä¸º$10$ä¸ªã€‚

ğŸ”¥ä¾‹å­ï¼šè®¾æ€»ä½“$X \sim N(\mu, \sigma^{2})$ï¼Œ$\sigma^{2}$ä¸ºå·²çŸ¥ï¼Œ$\mu$ä¸ºæœªçŸ¥ï¼Œè®¾$X_{1}, X_{2}, \cdots, X_{n}$æ˜¯æ¥è‡ª$X$çš„æ ·æœ¬ï¼Œæ±‚$\mu$çš„ç½®ä¿¡æ°´å¹³ä¸º$1-\alpha$çš„ç½®ä¿¡åŒºé—´ã€‚

ğŸ¦Šè§£ï¼š

ç”±äº$\overline{X}{æ˜¯}X$çš„æ— åä¼°è®¡ï¼Œä¸”
$$
\frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \sim N(0, 1)
$$
$\frac{\overline{X} - \mu}{\sigma/\sqrt{n}}$æ‰€æœä»çš„åˆ†å¸ƒ$N(0, 1)$ä¸ä¾èµ–äºä»»ä½•æœªçŸ¥å‚æ•°ï¼ŒæŒ‰æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„ä¸Š$\alpha$åˆ†ä½ç‚¹å®šä¹‰ï¼Œæœ‰
$$
P\left\{\left|\frac{\overline{X} - \mu}{\sigma/\sqrt{n}}\right| < z_{\alpha/2}\right\} = 1-\alpha
$$
å³
$$
P\left\{ \overline{X} - \frac{\sigma}{\sqrt{n}}z_{\alpha/2}< \mu < \overline{X} + \frac{\sigma}{\sqrt{n}}z_{\alpha/2}\right\} = 1-\alpha
$$
ç”±å®šä¹‰çŸ¥ï¼Œ$\mu$çš„ä¸€ä¸ªç½®ä¿¡æ°´å¹³ä¸º$1-\alpha$çš„ç½®ä¿¡åŒºé—´ä¸ºï¼š

$$
(\overline{X} - \frac{\sigma}{\sqrt{n}}z_{\alpha/2}, \overline{X} + \frac{\sigma}{\sqrt{n}}z_{\alpha/2})
$$
æˆ–å†™ä¸º
$$
(\overline{X} \pm \frac{\sigma}{\sqrt{n}}z_{\alpha/2})
$$

pythonä»£ç ï¼ˆé€šè¿‡ä¾‹é¢˜ç†è§£ç½®ä¿¡åŒºé—´ï¼‰


```python
import numpy as np
import matplotlib.pyplot as plt
%matplotlib inline 
plt.rcParams['font.sans-serif']=['SimHei','Songti SC','STFangsong']
plt.rcParams['axes.unicode_minus'] = False  # ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·
from scipy.stats import norm 

# ä»¤ä¸Šé¢˜ä¸­ mu = 0.1 sigma = 1, alpha = 0.05ï¼Œç„¶åä¼°è®¡ å‚æ•° mu çš„ç½®ä¿¡åŒºé—´

def get_confident_interval(mu, sigma, n, interval_num, alpha):
    confident_intervals = []
    for i in range(interval_num):
        x = norm.rvs(loc=mu, scale=sigma, size=n)
        # ç½®ä¿¡åŒºé—´ä¸Šé™è®¡ç®— å› ä¸ºalpha/2 çš„åˆ†ä½ç‚¹z_alpha/2 æ˜¯ä»è´Ÿæ— ç©·åˆ°-z_alpha/2 è¿›è¡Œç§¯åˆ†ï¼Œå› æ­¤å¾—åˆ°çš„åˆ†ä½ç‚¹éœ€è¦åŠ ä¸€ä¸ªè´Ÿå·
        right = np.sum(x)/n - (sigma/np.sqrt(n))*norm.ppf(loc=mu, scale=sigma, q=alpha/2)
        # ç½®ä¿¡åŒºé—´ä¸‹é™è®¡ç®—
        left = np.sum(x)/n + (sigma/np.sqrt(n))*norm.ppf(loc=mu, scale=sigma, q=alpha/2)
        confident_intervals.append((left, right))
    return confident_intervals

mu, sigma = 0.1, 1
n, alpha = 1000, 0.05
interval_num = 100
confident_intervals = get_confident_interval(mu, sigma, n, interval_num, alpha)
count = 0
plt.figure(figsize=(10, 8))
for idx, temp in enumerate(confident_intervals):
    plt.vlines(x=idx+1, ymin=temp[0], ymax=temp[1])
    plt.scatter(x=np.array([idx+1]*2),y=np.array([temp[0], temp[1]]), c='r')
    if mu >= temp[0] and mu <= temp[1]:
        count += 1


print("åœ¨{}ä¸ªç½®ä¿¡åŒºé—´é‡Œï¼Œæœ‰{}ä¸ªç½®ä¿¡åŒºé—´åŒ…å«æœªçŸ¥å‚æ•°mu".format(interval_num, count))
print("åŒ…å«æœªçŸ¥å‚æ•°muçš„ç½®ä¿¡åŒºé—´æ•°{}>={}[åŒºé—´æ•°x(1-alpha)]".format(count, interval_num*(1-alpha)))
plt.axhline(y=0.1, ls='--', c='r')
plt.show()


```

    åœ¨100ä¸ªç½®ä¿¡åŒºé—´é‡Œï¼Œæœ‰89ä¸ªç½®ä¿¡åŒºé—´åŒ…å«æœªçŸ¥å‚æ•°mu
    åŒ…å«æœªçŸ¥å‚æ•°muçš„ç½®ä¿¡åŒºé—´æ•°89>=95.0[åŒºé—´æ•°x(1-alpha)]
    


    
![png](img/output_80_1.png)
    


> å¯»æ±‚æœªçŸ¥å‚æ•°$\theta$çš„ç½®ä¿¡åŒºé—´çš„å…·ä½“æ­¥éª¤ï¼š
> - 1. å¯»æ±‚ä¸€ä¸ª**æ¢è½´é‡$W$**ï¼Œæ¢è½´é‡çš„åˆ†å¸ƒä¸ä¾èµ–äºå‚æ•°$\theta$ä»¥åŠå…¶å®ƒæœªçŸ¥å‚æ•°ã€‚æ¢è½´é‡æ˜¯å…³äºæ ·æœ¬$X_{1}, X_{2}, \cdots, X_{n}$å’ŒæœªçŸ¥å‚æ•°$\theta$çš„å‡½æ•°ï¼Œå³$W =W(X_{1}, X_{2}, \cdots, X_{n};\theta)$ï¼Œå…¶ä¸­$X_{1}, X_{2}, \cdots, X_{n}$ä¸ºå·²çŸ¥ã€‚
> - 2. å¯¹äºç»™å®šçš„ç½®ä¿¡æ°´å¹³$1-\alpha$ï¼Œå®šå‡ºä¸¤ä¸ªå¸¸æ•°$a, b$ï¼Œä½¿$$P\left\{ a <W(X_{1}, X_{2}, \cdots, X_{n};\theta) < b\right \} = 1-\alpha $$åˆ™$(a, b)$æ—¢æ˜¯æœªçŸ¥å‚æ•°$\theta$çš„ä¸€ä¸ªç½®ä¿¡æ°´å¹³ä¸º$1-\alpha$ç½®ä¿¡åŒºé—´ã€‚

ğŸ§­è¡¨1.8ï¼šæ­£æ€æ€»ä½“å‡å€¼ã€æ–¹å·®çš„ç½®ä¿¡åŒºé—´ä¸å•ä¾§ç½®ä¿¡é™ï¼ˆç½®ä¿¡æ°´å¹³ä¸º$1-\alpha$ï¼‰

| |å¾…ä¼°è®¡å‚æ•°|å…¶ä»–å‚æ•°|æ¢è½´é‡çš„åˆ†å¸ƒ|ç½®ä¿¡åŒºé—´|å•ä¾§ç½®ä¿¡é™|
|:---:|:---:|:---:|:---:|:---:|:---:|
|ä¸€ä¸ªæ­£æ€æ€»ä½“|$\mu$|$\sigma^{2}å·²çŸ¥$|$Z=\frac{\bar{X}-\mu}{\sigma / \sqrt{n}} \sim N(0,1)$|$\left(\bar{X} \pm \frac{\sigma}{\sqrt{n}} z_{a / 2}\right)$|$\bar{\mu}=\bar{X}+\frac{\sigma}{\sqrt{n}} z_{\alpha} \quad \underline{\mu}=\bar{X}-\frac{\sigma}{\sqrt{n}} x_{\alpha}$|
|ä¸€ä¸ªæ­£æ€æ€»ä½“|$\mu$|$\sigma^{2}æœªçŸ¥$|$t=\frac{\bar{X}-\mu}{S / \sqrt{n}} \sim t(n-1)$|$\left(\bar{X} \pm \frac{S}{\sqrt{n}} t_{\alpha / 2}(n-1)\right)$|$\bar{\mu}=\bar{X}+\frac{S}{\sqrt{n}} t_{\alpha}(n-1) \quad \underline{\mu}=\bar{X}-\frac{S}{\sqrt{n}} t_{\alpha}(n-1)$|
|ä¸€ä¸ªæ­£æ€æ€»ä½“|$\sigma^{2}$|$\muæœªçŸ¥$|$\chi^{2} =\frac{(n-1) S^{2}}{\sigma^{2}} \sim \chi^{2}(n-1)$|$\left(\bar{X} \pm \frac{S}{\sqrt{n}} t_{\alpha / 2}(n-1)\right)$|$\overline{\sigma^{2}}=\frac{(n-1) S^{2}}{\chi_{1-\alpha}^{2}(n-1)} \quad \underline{ \sigma^{2}}=\frac{(n-1) S^{2}}{\chi_{\alpha}^{2}(n-1)}$|
|ä¸¤ä¸ªæ­£æ€æ€»ä½“|$\mu_{1}-\mu_{2}$|$\sigma{1}^{2}, \sigma{2}^{2}å·²çŸ¥$|$\begin{aligned}Z &=\frac{\bar{X}-\bar{Y}-\left(\mu_{1}-\mu_{2}\right)}{\sqrt{\frac{\sigma_{1}^{2}}{n_{1}}+\frac{\sigma_{2}^{2}}{n_{2}}}} \\& \sim N(0,1)\end{aligned}$|$\left(\bar{X}-\bar{Y} \pm z_{\alpha / 2} \sqrt{\frac{\sigma_{1}^{2}}{n_{1}}+\frac{\sigma_{2}^{2}}{n_{2}}}\right)$|$\begin{aligned}{l}\overline{\mu_{1}-\mu_{2}}=\bar{X}-\bar{Y}+z_{\alpha} \sqrt{\frac{\sigma_{1}^{2}}{n_{1}}+\frac{\sigma_{2}^{2}}{n_{2}}}\\\underline{\mu_{1}-\mu_{2}}=\bar{X}=\bar{Y}-z_{\alpha} \sqrt{\frac{\sigma_{1}^{2}}{n_{1}}+\frac{\sigma_{2}^{2}}{n_{2}}}\end{aligned}$|
|ä¸¤ä¸ªæ­£æ€æ€»ä½“|$\mu_{1}-\mu_{2}$|$\sigma{1}^{2}=\sigma{2}^{2}=\sigma^{2}æœªçŸ¥$|$\begin{array}{c}t=\frac{(\bar{X}-\bar{Y})-\left(\mu_{1}-\mu_{2}\right)}{S_{w} \sqrt{\frac{1}{n_{1}}+\frac{1}{n_{2}}}} \\\sim t\left(n_{1}+n_{2}-2\right) \\S_{w}^{2}=\frac{\left(n_{1}-1\right) S_{1}^{2}+\left(n_{2}-1\right) S_{2}^{2}}{n_{1}+n_{2}-2}\end{array}$|$\left(\bar{X}-\bar{Y} \pm t_{\alpha / 2}\left(n_{1}+n_{2}-\right.\right.2)  \left.S_{w} \sqrt{\frac{1}{n_{1}}+\frac{1}{n_{2}}}\right) $|$\begin{array}{l}\overline{\mu_{1}-\mu_{2}}=\bar{X}-\bar{Y} \\\quad+t_{\alpha}\left(n_{1}+n_{2}-2\right) S_{w} \sqrt{\frac{1}{n_{1}}+\frac{1}{n_{2}}} \\\underline{\mu_{1}-\mu_{2}}=\bar{X}-\bar{Y} \\\quad-t_{\alpha}\left(n_{1}+n_{2}-2\right) S_{w} \sqrt{\frac{1}{n_{1}}+\frac{1}{n_{2}}}\end{array}$|
|ä¸¤ä¸ªæ­£æ€æ€»ä½“|$\frac{\sigma{1}^{2}}{\sigma{2}^{2}}$|$\mu_{1}, \mu_{2}æœªçŸ¥$|$\begin{aligned}F &=\frac{S_{1}^{2} / S_{2}^{2}}{\sigma_{1}^{2} / \sigma_{2}^{2}} \\& \sim F\left(n_{1}-1, n_{2}-1\right)\end{aligned}$|$\begin{array}{c}\left(\frac{S_{1}^{2}}{S_{2}^{2}} \frac{1}{F_{a / 2}\left(n_{1}-1, n_{2}-1\right)}\right. ,\\\left.\frac{S_{1}^{2}}{S_{2}^{2}} \frac{1}{F_{1-\alpha / 2}\left(n_{1}-1, n_{2}-1\right)}\right)\end{array}$|$\begin{aligned}&\frac{\overline{\sigma_{1}^{2}}}{\sigma_{2}^{2}}= \frac{S_{1}^{2}}{S_{2}^{2}}\frac{1}{F_{1-\alpha / 2}\left(n_{1}-1, n_{2}-1\right)} \\ &\frac{\sigma_{1}^{2}}{\underline{\sigma_{2}^{2}}} = \frac{S_{1}^{2}}{S_{2}^{2}} \frac{1}{F_{a / 2}\left(n_{1}-1, n_{2}-1\right)} \end{aligned}$|

## 1.9 å‡è®¾æ£€éªŒä¹‹åŸºæœ¬æ€æƒ³

* å‡è®¾æ£€éªŒé—®é¢˜ï¼šåœ¨æ€»ä½“çš„åˆ†å¸ƒå‡½æ•°å®Œå…¨æœªçŸ¥æˆ–åªçŸ¥å…¶å½¢å¼ã€ä½†ä¸çŸ¥å…¶å‚æ•°çš„æƒ…å†µä¸‹ï¼Œä¸ºäº†æ¨æ–­æ€»ä½“çš„æŸäº›æœªçŸ¥ç‰¹æ€§ï¼Œä¾¿æå‡ºå…³äºæ€»ä½“çš„å‡è®¾ï¼Œä¾‹å¦‚ï¼Œå‡è®¾æŸç³–æœè½¦é—´ç”Ÿäº§çš„ç³–æœçš„å‡å€¼ä¸º$0.5kg$ï¼›éœ€è¦æ ¹æ®å·²çŸ¥çš„æ ·æœ¬ï¼ˆä¾‹å¦‚æŸä¸€å¤©ç”Ÿäº§çš„ç³–æœï¼‰å¯¹æ‰€æå‡ºçš„å‡è®¾ï¼ˆåˆ¤æ–­ç³–æœå‡å€¼æ˜¯å¦ä¸º$0.5kg$ï¼‰ä½œå‡ºæ˜¯æ¥å—ï¼ˆç³–æœå‡å€¼æ˜¯$0.5kg$ï¼‰è¿˜æ˜¯æ‹’ç»ï¼ˆç³–æœå‡å€¼ä¸æ˜¯$0.5kg$ï¼‰çš„å†³ç­–ã€‚å‡è®¾æ£€éªŒå°±æ˜¯åšå‡ºè¿™ä¸€å†³ç­–çš„è¿‡ç¨‹ã€‚

* ğŸ”¥å¼•å…¥ï¼šæŸç”Ÿäº§è‘¡è„ç³–è½¦é—´ï¼Œè¢‹è£…ç³–çš„è´¨é‡æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œæœä»æ­£æ€åˆ†å¸ƒï¼Œåœ¨è½¦é—´æ­£å¸¸å·¥ä½œæ—¶ï¼Œè¢‹è£…ç³–è´¨é‡çš„å‡å€¼ä¸º$0.5kg$ï¼Œæ ‡å‡†å·®ä¸º$0.015kg$ï¼ŒæŸæ—¥è½¦é—´ç”Ÿäº§äº†$9$è¢‹è‘¡ç³–ç³–ï¼Œå…¶è¢‹è£…è´¨é‡ä¸ºï¼š
$$
0.479 \quad 0.506 \quad 0.518 \quad 0.524 \quad 0.498 \quad 0.511 \quad 0.520 \quad 0.515 \quad 0.512
$$
é—®å½“æ—¥æœºå™¨æ˜¯å¦æ­£å¸¸å·¥ä½œï¼Ÿ

å‡è®¾æ ‡å‡†å·®æ˜¯ä¸€æ„å·²çŸ¥é‡ï¼Œç°åœ¨è¦åˆ¤æ–­å½“æ—¥æœºå™¨æ˜¯å¦æ­£å¸¸å·¥ä½œå³åˆ¤æ–­å½“æ—¥æ‰€ç”Ÿäº§çš„æ ·æœ¬çš„å‡å€¼æ˜¯å¦ç­‰äºæ­£å¸¸å·¥ä½œæ—¶çš„å‡å€¼å³å¯ï¼Œäºæ˜¯ï¼Œæå‡ºå¦‚ä¸‹å‡è®¾
$$
H_{0}: \mu = 0.5 ; \quad H_{1}:\mu \ne 0.5
$$
å‡è®¾$H_{0}$è¡¨ç¤ºå½“æ—¥ç”Ÿäº§çš„æ ·æœ¬çš„å‡å€¼ç­‰äºæ­£å¸¸å·¥ä½œæ—¶çš„å‡å€¼ï¼Œå³æœºå™¨æ­£å¸¸å·¥ä½œï¼Œå‡è®¾$H_{1}$è¡¨ç¤ºå½“æ—¥ç”Ÿäº§çš„æ ·æœ¬çš„å‡å€¼ä¸ç­‰äºæ­£å¸¸å·¥ä½œæ—¶çš„å‡å€¼ï¼Œå³æœºå™¨ä¸æ­£å¸¸å·¥ä½œã€‚

* ğŸ¦Šåˆ†æï¼š**å¦‚ä½•å¯¹ä¸Šè¿°å‡è®¾åšå‡ºå†³ç­–å‘¢ï¼Ÿæ ¹æ®å¼•å…¥çŸ¥ï¼Œå‡è®¾æ˜¯å¯¹æœªçŸ¥å‚æ•°åšå‡ºå‡è®¾ï¼Œè¦é€šè¿‡æ ·æœ¬å¯¹æœªçŸ¥å‚æ•°åšå‡ºçš„å‡è®¾è¿›è¡Œå†³ç­–ï¼Œåˆ™éœ€è¦æ„é€ ä¸€ä¸ªå…³äºæ ·æœ¬å’ŒæœªçŸ¥å‚æ•°çš„å‡½æ•°ï¼Œä¸Šä¸€èŠ‚åŒºé—´ä¼°è®¡çš„è®¡ç®—ä¹Ÿæœ‰å’Œè¿™é‡Œç›¸ä¼¼çš„ä¸€æ­¥ï¼Œæ²¡é”™ï¼Œå°±æ˜¯æ¢è½´é‡ï¼Œå¯ä»¥é€šè¿‡æ¢è½´é‡å°†æ ·æœ¬å’ŒæœªçŸ¥å‚æ•°è”ç³»èµ·æ¥ï¼Œä¸è¿‡åœ¨å‡è®¾æ£€éªŒé‡Œå°†æ¢è½´é‡ç§°ä¸ºæ£€éªŒç»Ÿè®¡é‡**ï¼Œåœ¨æœ¬ä¾‹ä¸­æ„é€ æ£€éªŒç»Ÿè®¡é‡ï¼ˆæ¢è½´é‡ï¼‰
$$
\frac{\overline{X} - \mu}{\sigma/\sqrt{n}}
$$
å…¶å®ï¼Œåªåˆ¤æ–­$|\overline{x} - \mu|$çš„å¤§å°ä¹Ÿå¯ä»¥åšå‡ºåšå‡ºå†³ç­–ï¼Œä½†å–ä¸Šè¿°çš„æ£€éªŒç»Ÿè®¡é‡ä¼šä½¿å†³ç­–çš„è¿‡ç¨‹æ›´åŠ ç®€ä¾¿åŒ–ã€‚

å› ä¸ºï¼Œå½“$H_{0}$ä¸ºçœŸæ—¶ï¼Œ$\frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \sim N(0, 1)$ã€‚è€Œåˆ¤æ–­$|\overline{x} - \mu|$çš„å¤§å°ä¹Ÿå¯ä»¥è½¬åŒ–ä¸ºåˆ¤æ–­$\frac{\overline{x} - \mu}{\sigma/\sqrt{n}}$çš„å¤§å°ã€‚é€‚å½“é€‰å®šä¸€æ­£æ•°$k$ï¼Œä½¿å½“è§‚å¯Ÿå€¼$\overline{x}$æ»¡è¶³$\frac{\overline{x} - \mu}{\sigma/\sqrt{n}}\ge k$æ—¶å°±æ‹’ç»$H_{0}$ï¼Œåä¹‹ï¼Œ$\frac{\overline{x} - \mu}{\sigma/\sqrt{n}}< k$ï¼Œå°±æ¥å—$H_{0}$.

&emsp;&emsp;ç„¶è€Œï¼Œç”±äºåšå‡ºå†³ç­–çš„ä¾æ®æ˜¯æ€»ä½“ä¸­çš„æ ·æœ¬ï¼Œæ‰€ä»¥$H_{0}$ä¸ºçœŸæ—¶ä¹Ÿå¯èƒ½åšå‡ºæ‹’ç»$H_{0}$çš„å†³ç­–(*å³åšå‡ºçš„å†³ç­–æ˜¯é”™è¯¯çš„å†³ç­–ï¼Œä¾‹å¦‚ï¼Œåˆ¤æ–­å‡è®¾ä¸ºå‡çš„ï¼Œä½†å®é™…å‡è®¾æ˜¯çœŸçš„*)ï¼Œå°†çŠ¯è¿™ç§é”™è¯¯çš„æ¦‚ç‡è®°ä¸º
$$
P\{å½“H_{0}ä¸ºçœŸæ—¶æ‹’ç»H_{0}\} \quad æˆ– P_{\theta}\{æ‹’ç»H_{0}\}ï¼Œ \theta ä¸ºå‡è®¾çš„æœªçŸ¥å‚æ•°
$$
å¸Œæœ›å°†çŠ¯è¿™ç±»é”™è¯¯æ§åˆ¶åœ¨ä¸€å®šèŒƒå›´å†…ï¼Œå³ç»™å‡ºä¸€ä¸ªè¾ƒå°çš„æ•°$\alphaï¼ˆ0<\alpha<1ï¼‰$ï¼Œä½¿çŠ¯è¿™ç±»é”™è¯¯çš„æ¦‚ç‡ä¸è¶…è¿‡$\alpha$ï¼Œå³
$$
P\{å½“H_{0}ä¸ºçœŸæ—¶æ‹’ç»H_{0}\} \le \alpha
$$

&emsp;&emsp;ä¸ºç¡®å®šåˆšæ‰éœ€è¦é€‰å®šçš„æ­£æ•°$k$ï¼Œå…è®¸çŠ¯è¿™ç±»é”™è¯¯çš„æœ€å¤§æ¦‚ç‡ä¸º$\alpha$ï¼Œå°†ä¸Šå¼å–ç­‰å·
$$
P\{å½“H_{0}ä¸ºçœŸæ—¶æ‹’ç»H_{0}\} = \alpha
$$
åˆ™å¯¹äºä¾‹é¢˜ï¼Œå³ä½¿
$$
P\{\left | \frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \right| \ge k\} = \alpha
$$
ç”±äº$\frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \sim N(0, 1)$ï¼Œæ‰€ä»¥$k$å–$z_{\alpha/2}$ä¾¿äºæŸ¥è¡¨ã€‚å³
$$
\left | \frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \right| \ge k æ—¶
$$
åˆ™æ‹’ç»å‡è®¾$H_{0}$ï¼Œè‹¥
$$
\left | \frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \right| < k æ—¶
$$
åˆ™æ¥å—å‡è®¾$H_{0}$ï¼Œ$\alpha$ç§°ä¸º**æ˜¾è‘—æ€§æ°´å¹³**ã€‚

pythonä»£ç ï¼ˆæ£€éªŒ`å¼•å…¥`ä¾‹é¢˜ï¼‰


```python
from scipy.stats import norm 
import numpy as np 

# æ˜¾è‘—æ€§æ°´å¹³ alpha = 0.05
# H0: mu = 0.5; H1: mu != 0.5;  
# sigma = 0.015

x = [0.479, 0.506, 0.518, 0.524, 0.498, 0.511, 0.520, 0.515, 0.512]

mu = 0.5
sigma = 0.015 
alpha = 0.05

k = - norm.ppf(loc=0, scale=1, q=alpha/2)
check = np.abs((np.mean(x) - mu)/(sigma/np.sqrt(9)))

if check >= k:
    print("æ£€éªŒç»Ÿè®¡é‡{:.2f} >= {:.2f}, æ‹’ç»å‡è®¾H0, åˆ™mu != 0.5, æœºå™¨å·¥ä½œä¸æ­£å¸¸".format(check, k))
else:
    print("æ£€éªŒç»Ÿè®¡é‡{:.2f} < {:.2f}, æ¥å—å‡è®¾H0, åˆ™mu = 0.5, æœºå™¨å·¥ä½œæ­£å¸¸".format(check, k))
```

    æ£€éªŒç»Ÿè®¡é‡1.84 < 1.96, æ¥å—å‡è®¾H0, åˆ™mu = 0.5, æœºå™¨å·¥ä½œæ­£å¸¸
    

&emsp;&emsp;å¯¹äºä¸Šè¿°ä¾‹é¢˜ï¼Œå‡è®¾çš„æœªçŸ¥å‚æ•°$\theta$ä¸ºç­‰äºæˆ–ä¸ç­‰äºæŸä¸€å‡è®¾å¸¸é‡ï¼Œå½¢å¦‚è¿™ç±»çš„å‡è®¾æ£€éªŒç§°ä¸º**åŒè¾¹å‡è®¾æ£€éªŒ**ã€‚è¿˜æœ‰ä¸€äº›å…¶å®ƒçš„é—®é¢˜è¦æ±‚å‡è®¾çš„æœªçŸ¥å‚æ•°$\theta$å¤§äºç­‰äºæˆ–å°äºç­‰äºæŸä¸€å‡è®¾å¸¸é‡ï¼Œåˆ†åˆ«å°†å…¶ç§°ä¸º**å·¦è¾¹æ£€éªŒ**å’Œ**å³è¾¹æ£€éªŒ**

* å·¦è¾¹æ£€éªŒï¼šå³æ£€éªŒå‡è®¾
$$
H_{0}:\theta \le \theta_{0}; \quad H_{1}:\theta > \theta_{0}
$$
* å³è¾¹æ£€éªŒï¼šå³æ£€éªŒå‡è®¾
$$
H_{0}:\theta \ge \theta_{0}; \quad H_{1}:\theta < \theta_{0}
$$

* **è®¨è®ºå•è¾¹æ£€éªŒçš„æ‹’ç»åŸŸ**ï¼š

ğŸ”¥(å³è¾¹æ£€éªŒ)è®¾æ€»ä½“$X \sim N(\mu, \sigma^{2})$ï¼Œ$\mu {æœªçŸ¥}, \sigma {å·²çŸ¥}$ï¼Œ$X_{1}, X_{2}, \cdots, X_{n}$æ˜¯æ¥è‡ªæ€»ä½“$X$çš„æ ·æœ¬ï¼Œç»™å®šæ˜¾è‘—æ€§ä¹¦å¹³$\alpha$ï¼Œæ±‚æ£€éªŒé—®é¢˜
$$
H_{0}:\mu \le \mu_{0}; \quad H_{1}:\mu > \mu_{0}
$$
çš„æ‹’ç»åŸŸï¼ˆé»˜è®¤$H_{0}$ï¼‰ã€‚

ğŸ¦Šè§£ï¼š
æ±‚æ‹’ç»åŸŸå³å¯»æ‰¾æ»¡è¶³$H_{1}$å‡è®¾çš„åŒºé—´ï¼Œå› $H_{0}$ä¸­çš„$\mu$éƒ½æ¯”$H_{1}$ä¸­çš„$\mu$è¦å°ï¼Œå½“æ‹’ç»$H_{0}$æ—¶ï¼Œè§‚å¯Ÿå€¼$\overline{x}$ä¼šå‘å‡è®¾$H_{1}$é æ‹¢ï¼Œå³è§‚å¯Ÿå€¼$\overline{x}$ä¼šåå¤§ï¼Œå› æ­¤ï¼Œæ‹’ç»åŸŸçš„å½¢å¼ä¸º
$$
\overline{x} \ge k (kä¸ºé€‚å½“æ­£æ•°)
$$
æ¥ä¸‹æ¥å³ç¡®å®šæ­£æ•°$k$
$$
\begin{aligned}
P\left\{ H_{0}ä¸ºçœŸæ—¶æ‹’ç»H_{0}\right\} &= P\left\{\overline{X} \ge k \right \} \\
& = P\left\{ \frac{\overline{X} - \mu_{0}}{\sigma/\sqrt{n}} \ge \frac{k - \mu_{0}}{\sigma/\sqrt{n}}\right\} \\ 
&\le P\left\{ \frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \ge \frac{k - \mu_{0}}{\sigma/\sqrt{n}}\right\}
\end{aligned}
$$
ä¸Šå¼ä¸ç­‰å·æˆç«‹æ˜¯ç”±äº$\mu \le \mu_{0}, \frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \ge \frac{k - \mu_{0}}{\sigma/\sqrt{n}}$ï¼Œäº‹ä»¶$\left\{ \frac{\overline{X} - \mu_{0}}{\sigma/\sqrt{n}} \ge \frac{k - \mu_{0}}{\sigma/\sqrt{n}}\right \} \subset \left\{ \frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \ge \frac{k - \mu_{0}}{\sigma/\sqrt{n}}\right \}$ï¼Œè¦æ§åˆ¶$P\{H_{0}ä¸ºçœŸæ—¶æ‹’ç»H_{0}\} \le \alpha$ï¼Œåªéœ€ä»¤
$$
P\left\{ \frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \ge \frac{k - \mu_{0}}{\sigma/\sqrt{n}}\right\} = \alpha
$$
ç”±äº $\frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \sim N(0, 1)$ï¼Œåˆ™ä»¤$\frac{k - \mu_{0}}{\sigma/\sqrt{n}} = z_{\alpha}$åˆ†ä½ç‚¹ã€‚å¾—æ£€éªŒé—®é¢˜å¾—æ‹’ç»åŸŸä¸º
$$
\overline{x} \ge k =\sigma/\sqrt{n}z_{\alpha} + \mu_{0} \\
$$
å³
$$
\frac{\overline{x} - \mu_{0}}{\sigma/\sqrt{n}} \ge z_{\alpha}
$$

ğŸ”¥ï¼ˆå·¦è¾¹æ£€éªŒï¼‰è®¾æ€»ä½“$X \sim N(\mu, \sigma^{2})$ï¼Œ$\mu {æœªçŸ¥}, \sigma {å·²çŸ¥}$ï¼Œ$X_{1}, X_{2}, \cdots, X_{n}$æ˜¯æ¥è‡ªæ€»ä½“$X$çš„æ ·æœ¬ï¼Œç»™å®šæ˜¾è‘—æ€§ä¹¦å¹³$\alpha$ï¼Œæ±‚æ£€éªŒé—®é¢˜
$$
H_{0}:\mu \ge \mu_{0}; \quad H_{1}:\mu < \mu_{0}
$$
çš„æ‹’ç»åŸŸï¼ˆé»˜è®¤$H_{0}$ï¼‰ã€‚

ğŸ¦Šè§£ï¼š

æ‹’ç»$H_{0}$æ—¶ï¼Œå‡å€¼$\mu$å‘$H_{1}$é æ‹¢ï¼Œå³$\mu$çš„æ— åä¼°è®¡$\overline{x}$è¾ƒå°ï¼Œå–ä¸€é€‚å½“æ­£æ•°$k$ï¼Œ$H_{0}$çš„æ‹’ç»åŸŸå½¢å¼ä¸ºï¼š
$$
\overline{x} \le k
$$

å½“$H_{0}$ä¸ºçœŸæ—¶
$$
\frac{\overline{X}- \mu_{0}}{\sigma/\sqrt{n}} \sim N(0, 1)
$$
ç¡®å®š$k$çš„å–å€¼
$$
\begin{aligned}
P\left\{ H_{0}ä¸ºçœŸæ—¶æ‹’ç»H_{0}\right\} &= P\left\{\overline{x} \le k\right\} \\
& = P\left\{\frac{\overline{X}- \mu_{0}}{\sigma/\sqrt{n}} \le \frac{\overline{k}- \mu_{0}}{\sigma/\sqrt{n}}\right\} \\
& \le P\left\{\frac{\overline{X}- \mu}{\sigma/\sqrt{n}} \le \frac{\overline{k}- \mu_{0}}{\sigma/\sqrt{n}}\right\}, (H_{0}ä¸ºçœŸæ—¶ï¼Œ\mu \ge \mu_{0}) 
\end{aligned}
$$

å–
$$
P\left\{\frac{\overline{X}- \mu}{\sigma/\sqrt{n}} \le \frac{\overline{k}- \mu_{0}}{\sigma/\sqrt{n}}\right\} = \alpha
$$
åˆ™ 
$$
\begin{aligned}
&\frac{\overline{k}- \mu_{0}}{\sigma/\sqrt{n}} = -z_{\alpha} \\
& k = -z_{\alpha}\sigma/\sqrt{n} + - \mu_{0}
\end{aligned}
$$
å¾—æ‹’ç»åŸŸ
$$
\begin{aligned}
&\overline{x} \le k= -z_{\alpha}\sigma/\sqrt{n} +  \mu_{0} \\
&\frac{\overline{x}- \mu_{0}}{\sigma/\sqrt{n}} \le -z_{\alpha}
\end{aligned}
$$

> ğŸ’¡è®¨è®ºï¼šåœ¨å³è¾¹æ£€éªŒä¸­ï¼Œä¸ºä»€ä¹ˆä»¤$\frac{k - \mu_{0}}{\sigma/\sqrt{n}} = z_{\alpha}$ï¼Œè€Œåœ¨å·¦è¾¹æ£€éªŒä¸­ä»¤$\frac{k - \mu_{0}}{\sigma/\sqrt{n}} = -z_{\alpha}$ï¼Ÿ      
> å› ä¸º(å·¦è¾¹æ£€éªŒ)$$P\left\{ \frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \le \frac{k - \mu_{0}}{\sigma/\sqrt{n}}\right\} = \int_{-\infty}^{\frac{k - \mu_{0}}{\sigma/\sqrt{n}}}f(x)dx, \quad (f(x)ä¸ºxçš„æ¦‚ç‡å¯†åº¦å‡½æ•°)$$è¦ä½¿ï¼Œ$$P\left\{ \frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \le \frac{k - \mu_{0}}{\sigma/\sqrt{n}}\right\}=\alpha$$åˆ™å–$$\frac{k - \mu_{0}}{\sigma/\sqrt{n}} = -z_{\alpha}$$    
>åŒç†(å³è¾¹æ£€éªŒ)$$P\left\{ \frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \ge \frac{k - \mu_{0}}{\sigma/\sqrt{n}}\right\} = \int_{\frac{k - \mu_{0}}{\sigma/\sqrt{n}}}^{\infty}f(x)dx, \quad (f(x)ä¸ºxçš„æ¦‚ç‡å¯†åº¦å‡½æ•°)$$è¦ä½¿ï¼Œ$$P\left\{ \frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \ge \frac{k - \mu_{0}}{\sigma/\sqrt{n}}\right\}=\alpha$$åˆ™å–$$\frac{k - \mu_{0}}{\sigma/\sqrt{n}} = z_{\alpha}$$

> è¿™é‡Œåªè®¨è®ºäº†çŠ¯ç¬¬ä¸€ç±»é”™è¯¯å¾—æƒ…å†µï¼ˆå³H_{0}ä¸ºçœŸæ—¶æ‹’ç»H_{0}ï¼‰ï¼ŒçŠ¯ç¬¬äºŒç±»é”™è¯¯ï¼ˆå³H_{0}ä¸çœŸæ—¶æ¥å—H_{0}ï¼‰æƒ…å†µçš„åˆ†æè¿‡ç¨‹ä¸ç¬¬ä¸€ç±»ç›¸ä¼¼ï¼ŒæŒæ¡ä¸€ç§å³å¯ï¼Œè¿™ç§åªé™åˆ¶ç¬¬ä¸€ç±»é”™è¯¯æ¦‚ç‡ï¼Œè€Œä¸è€ƒè™‘ç¬¬äºŒç±»é”™è¯¯æ¦‚ç‡çš„å‡è®¾æ£€éªŒç§°ä¸º**æ˜¾è‘—æ€§æ£€éªŒï¼ˆæ˜¾è‘—æ€§æ°´å¹³ä¸º$\alpha$ï¼‰**ã€‚

ğŸ”¥ä¾‹å­ï¼šå…¬å¸è´­ä¹°äº†$5$æ‰¹ç‰›å¥¶ï¼Œç°å…¬å¸æ€€ç–‘ç‰›å¥¶æºäº†æ°´ï¼Œå·²çŸ¥å¤©ç„¶ç‰›å¥¶çš„å†°ç‚¹æ¸©åº¦æœä»æ­£å¤ªåˆ†å¸ƒï¼Œå‡å€¼ä¸º$-0.545$ï¼Œæ ‡å‡†å·®ä¸º$0.008$ï¼Œç‰›å¥¶æºæ°´å¯è§†ç‰›å¥¶çš„å†°ç‚¹æ¸©åº¦å‡é«˜è‡³è¿‘ä¼¼æ°´çš„å†°ç‚¹æ¸©åº¦ï¼Œæµ‹å¾—å…¬å¸è´­ä¹°çš„$5$æ‰¹ç‰›å¥¶çš„å†°ç‚¹æ¸©åº¦å‡å€¼$\overline{x}=-0.535$ï¼Œé—®ç‰›å¥¶æ˜¯å¦æºäº†æ°´ï¼Ÿå–$\alpha=0.05$.

ğŸ¦Šè§£:
1. ä½œå‡ºå‡è®¾
$$
H_{0}: \mu \le \mu_{0}=-0.545; \quad H_{1}: \mu > \mu_{0}=-0.545
$$
é—®é¢˜å³æ˜¯åˆ¤æ–­å‡è®¾$H_{0}$æ˜¯å¦ä¸ºçœŸï¼Œé€šè¿‡å‡è®¾å¯çŸ¥è¯¥é—®é¢˜æ˜¯**å³è¾¹æ£€éªŒ**é—®é¢˜

2. æ‰¾æ‹’ç»åŸŸ
å½“æ‹’ç»$H_{0}$æ—¶ï¼Œ$\mu$å¤§äº$\mu_{0}$ï¼Œå› æ­¤ï¼Œæ‹’ç»åŸŸçš„å½¢å¼ä¸º
$$ \overline{x} \ge k$$

3. ç¡®å®šå¸¸æ•°$k$
$$
\begin{aligned}
P\left\{H_{0}ä¸ºçœŸæ—¶æ‹’ç»H_{0}\right\} &= P\left\{ \overline{x} \ge k \right\} \\
& = P\{ \frac{\overline{X} - \mu_{0}}{\sigma/\sqrt{n}} \ge \frac{k - \mu_{0}}{\sigma/\sqrt{n}}\} \\
&\le P\{ \frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \ge \frac{k - \mu_{0}}{\sigma/\sqrt{n}}\}  \quad  (\mu \le \mu_{0})\\
&= \alpha
\end{aligned}
$$
4. å–$\frac{k - \mu_{0}}{\sigma/\sqrt{n}}=z_{\alpha}$ï¼Œå¾—
$$
k = \sigma/\sqrt{n}z_{\alpha} + \mu_{0}
$$
å³
$$
\begin{aligned}
&\overline{x} \ge \sigma/\sqrt{n}z_{\alpha} + \mu_{0} \\
&\frac{\overline{x} - \mu_{0}}{\sigma/\sqrt{n}} \ge z_{\alpha}
\end{aligned}
$$
æ—¶æ‹’ç»$H_{0}$

pythonä»£ç ï¼ˆæ±‚è§£ä¾‹é¢˜ï¼‰


```python
from scipy.stats import norm 
import numpy as np

n = 5
alpha = 0.05 
mu, sigma = -0.545, 0.008
x_mean = -0.535

z_alpha = - norm.ppf(loc=0, scale=1, q=0.05)
k = (sigma/np.sqrt(n))*z_alpha + mu 

if x_mean >= k:
    print("æ£€éªŒç»Ÿè®¡é‡{:.4f} >= {:.4f}, æ‹’ç»å‡è®¾H0, å³ç‰›å¥¶æºäº†æ°´".format(x_mean, k))
else:
    print("æ£€éªŒç»Ÿè®¡é‡{:.4f} < {:.4f}, æ¥å—å‡è®¾H0, å³ç‰›å¥¶æœªæºæ°´".format(x_mean, k))
```

    æ£€éªŒç»Ÿè®¡é‡-0.5350 >= -0.5391, æ‹’ç»å‡è®¾H0, å³ç‰›å¥¶æºäº†æ°´
    

## 1.10 å‡è®¾æ£€éªŒä¹‹æ­£æ€æ€»ä½“å‚æ•°çš„å‡è®¾æ£€éªŒ

* å•ä¸ªæ€»ä½“$N(0, 1)$å‡å€¼$\mu$çš„æ£€éªŒ

&emsp;&emsp;(1) **$\sigma^{2}$å·²çŸ¥ï¼Œå…³äº$\mu$çš„æ£€éªŒï¼ˆ$Z$æ£€éªŒï¼‰**ï¼šä¸Šé¢å·²ç»è®¨è®ºè¿‡è¿™ç§æƒ…å†µï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæ£€éªŒç»Ÿè®¡é‡ä¸º$Z = \frac{\overline{X}-\mu_{0}}{\sigma/\sqrt{n}}$

&emsp;&emsp;(2) **$\sigma^{2}$æœªçŸ¥ï¼Œå…³äº$\mu$çš„æ£€éªŒï¼ˆ$t$æ£€éªŒï¼‰**ï¼šè®¾æ€»ä½“$X\sim N(\mu, \sigma^{2})$ï¼Œ$\mu, \sigma^{2}$æœªçŸ¥ï¼Œæ±‚æ£€éªŒé—®é¢˜
$$
H_{0}: \mu =\mu_{0}; \quad H_{1}:\mu \ne \mu_{0}
$$
çš„æ‹’ç»åŸŸ(æ˜¾è‘—æ€§æ°´å¹³ä¸º$\alpha$)

&emsp;&emsp;ğŸ¦Šï¼šè¿™æ—¶ï¼Œä»¤æ£€éªŒç»Ÿè®¡é‡ä¸º
$$
\frac{\overline{X}-\mu_{0}}{S/\sqrt{n}}  , \quad (Sä¸ºæ ·æœ¬æ ‡å‡†å·®)
$$
æ ¹æ®ä¹‹å‰å­¦çš„å®šç†çŸ¥ï¼Œ$H_{0}$ä¸ºçœŸæ—¶ï¼š
$$
\frac{\overline{X}-\mu_{0}}{S/\sqrt{n}} \sim t(n-1)
$$
é€‰å®šé€‚å½“æ­£æ•°$k$
$$
\begin{aligned}
P\left\{ H_{0}ä¸ºçœŸæ—¶æ‹’ç»H_{0}\right\} &=  P\left\{ \left| \frac{\overline{X}-\mu_{0}}{S/\sqrt{n}} \right| \ge k \right\}
&= \alpha
\end{aligned}
$$
å–$k = t_{\alpha/2}(n-1)$
åˆ™æ‹’ç»åŸŸä¸º
$$
\left| \frac{\overline{X}-\mu_{0}}{S/\sqrt{n}} \right | \ge k = t_{\alpha/2}(n-1)
$$
è¿™ç±»æ£€éªŒæ–¹æ³•ç§°ä¸º **$t$æ£€éªŒæ³•**ã€‚

ğŸ”¥ä¾‹å­ï¼šæŸå…ƒä»¶å¯¿å‘½$Xï¼ˆå•ä½ï¼šhï¼‰$æœä»æ­£æ€åˆ†å¸ƒ$N(\mu, \sigma^{2})ï¼Œ\mu, \sigma^{2}$æœªçŸ¥ï¼Œç°æµ‹å¾—16åªå…ƒä»¶å¯¿å‘½å¦‚ä¸‹:
$$
\begin{aligned}
& 159 \quad 280 \quad 101 \quad 212 \quad 224 \quad 379 \quad 179 \quad 264 \\
& 222 \quad 362 \quad 168 \quad 250 \quad 149 \quad 260 \quad 485 \quad 170
\end{aligned}
$$
é—®å…ƒä»¶çš„å¹³å‡å¯¿å‘½æ˜¯å¦å¤§äº$225h$ï¼ˆå–$\alpha = 0.05$ï¼‰?

ğŸ¦Šè§£ï¼š

1. ä½œå‡ºå‡è®¾
$$
H_{0}: \mu \le \mu_{0} = 225; \quad H_{1}: \mu > \mu_{0} = 225
$$
æ‹’ç»$H_{0}$æ—¶ï¼Œè§‚å¯Ÿå€¼$\overline{x}$è¾ƒå¤§ï¼Œå–ä¸€é€‚å½“æ­£æ•°$k$ï¼Œæ‹’ç»åŸŸçš„å½¢å¼ä¸º
$$
\overline{x} \ge k
$$
2. ç¡®å®šæ­£æ•°$k$
$$
\begin{aligned}
P\left\{H_{0}ä¸ºçœŸæ—¶æ‹’ç»H_{0}\right\} &= P\left\{\overline{X} \ge k\right\} \\
&= P\left\{\frac{\overline{X} - \mu_{0}}{S/\sqrt{n}} \ge \frac{k- \mu_{0}}{S/\sqrt{n}}\right\} \\
&\le P\left\{\frac{\overline{X} - \mu}{S/\sqrt{n}} \ge \frac{k- \mu_{0}}{S/\sqrt{n}}\right\}, \quad (\mu \le \mu_{0}) \\
&= \alpha
\end{aligned}
$$
ä»¤$\frac{k- \mu_{0}}{S/\sqrt{n}} = t_{\alpha}(n-1)$

4. åˆ™æ‹’ç»åŸŸä¸º
$$
\overline{x} \ge k = t_{\alpha}(n-1)S/\sqrt{n} + \mu_{0}
$$
å³
$$
\frac{\overline{x} - \mu_{0}}{S/\sqrt{n}} \ge t_{\alpha}(n-1)
$$
è‹¥æ»¡è¶³ä¸Šåˆ—ä¸ç­‰å¼æ—¶ï¼Œæ‹’ç»$H_{0}$ï¼Œæ¥å—$H_{1}$ï¼Œå³å…ƒä»¶çš„å¹³å‡å¯¿å‘½å¤§äº$225h$ï¼Œåä¹‹ï¼Œåˆ™æ¥å—$H_{0}$ï¼Œæ‹’ç»$H_{1}$ï¼Œå³å…ƒä»¶çš„å¹³å‡å¯¿å‘½å°äº$225h$ã€‚


pythonä»£ç (æ±‚è§£ä¸Šé¢˜)


```python
from scipy.stats import t
import numpy as np

# H0: mu <= 225; H1: mu > 225,  mu0 = 225, alpha=0.05
alpha = 0.05
n = 16
mu0 = 225
x = [159, 280, 101, 212, 224, 379, 179, 264, 222, 362, 168, 250, 149, 260, 485, 170]
x_mean = np.mean(x)
S = np.sqrt(np.sum(np.square(x - x_mean))/(n-1))

check = (x_mean - mu0)/(S/np.sqrt(n))
t_alpha = - t.ppf(df=n-1, q=alpha)

if check >= t_alpha:
    print("æ£€éªŒç»Ÿè®¡é‡ : {:.4f} >= {:.4f} (t_alpha(n-1)), æ‹’ç»H0, æ¥å—H1, å³å…ƒä»¶å¹³å‡å¯¿å‘½å¤§äº 225 h".format(check, t_alpha))
else:
    print("æ£€éªŒç»Ÿè®¡é‡ : {:.4f} < {:.4f} (t_alpha(n-1)), æ¥å—H0, æ‹’ç»H1, å³å…ƒä»¶å¹³å‡å¯¿å‘½å°äº 225 h".format(check, t_alpha))
```

    æ£€éªŒç»Ÿè®¡é‡ : 0.6685 < 1.7531 (t_alpha(n-1)), æ¥å—H0, æ‹’ç»H1, å³å…ƒä»¶å¹³å‡å¯¿å‘½å°äº 225 h
    

* ä¸¤ä¸ªæ­£æ€æ€»ä½“å‡å€¼å·®çš„æ£€éªŒï¼ˆ$t$æ£€éªŒï¼‰

è®¾$X_{1}, X_{2}, \cdots, X_{n1}$æ˜¯æ¥è‡ªæ­£æ€æ€»ä½“$N(\mu_{1}, \sigma_{1}^{2})$çš„æ ·æœ¬ï¼Œ$Y_{1}, Y_{2}, \cdots, Y_{n2}$æ˜¯æ¥è‡ªæ­£æ€æ€»ä½“$N(\mu_{2}, \sigma_{2}^{2})$çš„æ ·æœ¬ï¼Œè®¾ä¸¤æ ·æœ¬ç‹¬ç«‹ï¼Œæ ·æœ¬å‡å€¼å’Œæ–¹å·®åˆ†åˆ«ä¸º$\overline{X}, \overline{Y}, S_{1}^{2}, S_{2}^{2}$ï¼Œæ±‚æ£€éªŒé—®é¢˜
$$
H_{0}:\mu_{1} - \mu_{2} = \delta; \quad H_{1}:\mu_{1} - \mu_{2} \ne \delta
$$
$\delta$ä¸ºå¸¸æ•°ï¼Œæ˜¾è‘—æ€§æ°´å¹³å–$\alpha$

&emsp;&emsp;**ï¼ˆ1ï¼‰$\mu_{1}, \mu_{2}$æœªçŸ¥, $\sigma_{1}^{2} = \sigma_{2}^{2} = \sigma^{2}$æœªçŸ¥**ï¼Œå–æ£€éªŒç»Ÿè®¡é‡
$$
t = \frac{\overline{X} - \overline{Y} - \delta}{S_{w}\sqrt{\frac{1}{n1}+\frac{1}{n2}}}, \quad S_{w}^{2} = \frac{(n1-1)S_{1}^{2}+(n2-1)S_{2}^{2}}{n1+n2-2} , \quad S_{w} = \sqrt{S_{w}^{2}}
$$
æ‹’ç»åŸŸä¸º
$$
\frac{\left|\overline{x} - \overline{y} - \delta \right |}{s_{w}\sqrt{\frac{1}{n1}+\frac{1}{n2}}} \ge t_{\alpha/2}(n1+n2-2)
$$
&emsp;&emsp;**ï¼ˆ2ï¼‰$\mu_{1}, \mu_{2}$æœªçŸ¥, $\sigma_{1}^{2}, \sigma_{2}^{2}$å·²çŸ¥**ï¼Œå–æ£€éªŒç»Ÿè®¡é‡
$$
Z = \frac{\overline{X} - \overline{Y} - \delta}{\sqrt{\frac{\sigma_{1}^{2}}{n1} + \frac{\sigma_{2}^{2}}{n1}}}
$$
æ‹’ç»åŸŸä¸º
$$
\frac{\left|\overline{x} - \overline{y} - \delta\right|}{\sqrt{\frac{\sigma_{1}^{2}}{n1} + \frac{\sigma_{2}^{2}}{n1}}} \ge z_{\alpha/2}
$$


* æ­£æ€æ€»ä½“æ–¹å·®çš„å‡è®¾æ£€éªŒï¼ˆå•ä¸ªæ€»ä½“çš„æƒ…å†µï¼‰

&emsp;&emsp;è®¾æ€»ä½“$X \sim N(\mu, \sigma^{2})ï¼Œ\mu, \sigma^{2}$å‡æœªçŸ¥ï¼Œ$X_{1}, X_{2}, \cdots, X_{n}$ï¼Œæ˜¯æ¥è‡ª$X$çš„æ ·æœ¬ï¼Œè¦æ±‚æ£€éªŒå‡è®¾
$$
H_{0}:\sigma^{2}=\sigma_{0}^{2}; \quad H_{1}=\sigma^{2} \ne \sigma_{0}^{2}
$$
$\sigma_{0}^{2}$ä¸ºå·²çŸ¥å¸¸æ•°

ç”±äº$S^{2}$æ˜¯$\sigma^{2}$çš„æ— åä¼°è®¡ï¼Œå½“$H_{0}$ä¸ºçœŸæ—¶ï¼Œè§‚å¯Ÿå€¼$s^{2}$ä¸$\sigma^{2}$åº”è¯¥åœ¨$1$é™„è¿‘æ‘†åŠ¨ï¼Œè€Œä¸åº”è¿‡åˆ†å¤§äºæˆ–å°äº$1$ï¼Œç”±å‰é¢å­¦ä¹ çš„å®šç†çŸ¥ï¼Œå½“$H_{0}$ä¸ºçœŸæ—¶
$$
\frac{(n-1)S^{2}}{\sigma_{0}^{2}} \sim \chi^{2}(n-1)
$$
å–æ£€éªŒç»Ÿè®¡é‡
$$
\chi^{2} = \frac{(n-1)S^{2}}{\sigma_{0}^{2}}
$$
å¦‚ä¸Šæ‰€è¯´ï¼Œä¸Šè¿°é—®é¢˜çš„æ‹’ç»åŸŸå…·æœ‰ä»¥ä¸‹çš„å½¢å¼ï¼š
$$
\frac{(n-1)S^{2}}{\sigma_{0}^{2}} \le k_{1} \quad æˆ– \frac{(n-1)S^{2}}{\sigma_{0}^{2}} \ge k_{2}
$$
å…¶ä¸­$k_{1}, k_{2}$çš„å€¼ç”±ä¸‹å¼ç¡®å®š
$$
\begin{aligned}
&P\left\{H_{0}ä¸ºçœŸæ—¶æ‹’ç»H_{0}\right\} \\
&P\left\{(\frac{(n-1)S^{2}}{\sigma_{0}^{2}} \le k_{1}) \cup  (\frac{(n-1)S^{2}}{\sigma_{0}^{2}} \ge k_{2}) \right\}
& = \alpha
\end{aligned}
$$
ä¸ºæ–¹ä¾¿è®¡ç®—ï¼Œå–
$$
P\left\{\frac{(n-1)S^{2}}{\sigma_{0}^{2}} \le k_{1}\right\} =\frac{\alpha}{2}  P\left\{ \frac{(n-1)S^{2}}{\sigma_{0}^{2}} \ge k_{2}\right\}=\frac{\alpha}{2}
$$
å¾—$k_{1}=\chi_{1-\alpha/2}^{2}(n-1), k_{2}=\chi_{\alpha/2}^{2}(n-1)\quad (è¿™é‡Œå› ä¸º\chi^{2}åˆ†å¸ƒçš„å›¾åƒä¸æ˜¯å¯¹ç§°çš„)$ ï¼Œäºæ˜¯å¾—æ‹’ç»åŸŸä¸º
$$
\frac{(n-1)S^{2}}{\sigma_{0}^{2}} \le \chi_{1-\alpha/2}^{2}(n-1) {æˆ–} \frac{(n-1)S^{2}}{\sigma_{0}^{2}} \ge \chi_{\alpha/2}^{2}(n-1)
$$

ğŸ“•**è¡¨1.10 æ­£æ€æ€»ä½“å‡å€¼ã€æ–¹å·®çš„æ£€éªŒæ³•ï¼ˆæ˜¾è‘—æ€§æ°´å¹³ä¸º$\alpha$ï¼‰**

<style>
table
{
    margin: auto;
}
</style>

| |åŸå‡è®¾$H_{0}$|æ£€éªŒç»Ÿè®¡é‡|å¤‡æ‹©å‡è®¾$H_{1}$|æ‹’ç»åŸŸ|
|:--:|:--:|:--:|:--:|:--:|
|$1$|$\begin{aligned} &\mu \leqslant \mu_{0} \\ &\mu \geqslant \mu_{0} \\ &\mu=\mu_{0}\\ &\left(\sigma^{2}\right. å·²çŸ¥)\end{aligned}$|$ Z=\frac{\bar{X}-\mu_{0}}{\sigma / \sqrt{n}}$|$\begin{aligned} &\mu>\mu_{0} \\ & \mu<\mu_{0} \\ & \mu\ne\mu_{0}\end{aligned}$|$\begin{aligned} &z\ge z_{\alpha} \\ &z \le -z_{\alpha} \\ & \|z\| \ge z_{\alpha / 2}\end{aligned}$|
|$2$|$\begin{aligned}&\mu \leqslant \mu_{0} \\ &\mu \geqslant \mu_{0} \\ &\mu=\mu_{0}\\ &\left(\sigma^{2}\right. æœªçŸ¥)\end{aligned}$|$\begin{aligned} t =\frac{\overline{X}-\mu_{0}}{S/\sqrt{n}} \end{aligned}$|$\begin{aligned} &\mu>\mu_{0} \\ & \mu<\mu_{0} \\ & \mu\ne\mu_{0}\end{aligned}$|$\begin{aligned}& t \geqslant t_{\alpha}(n-1) \\&t \leqslant-t_{\alpha}(n-1) \\& \|t\| \geqslant t_{\alpha / 2}(n-1) \\ \end{aligned}$|
|$3$|$\begin{aligned} &\mu_{1}-\mu_{2}\le \delta \\&\mu_{1}-\mu_{2}\ge \delta \\&\mu_{1}-\mu_{2}= \delta\\&(\sigma_{1}^{2},\sigma_{2}^{2}å·²çŸ¥) \end{aligned}$|$\begin{aligned}Z=\frac{\overline{X}-\overline{Y}-\delta}{\sqrt{\frac{\sigma_{1}^{2}}{n1}+\frac{\sigma_{1}^{2}}{n2}}} \end{aligned}$|$\begin{aligned}&\mu_{1}-\mu_{2}> \delta \\&\mu_{1}-\mu_{2}< \delta \\&\mu_{1}-\mu_{2}\ne \delta  \end{aligned}$|$\begin{aligned} &z\ge z_{\alpha} \\ & z\le -z_{\alpha}\\ & \| z\| \ge z_{\alpha/2}\end{aligned}$|
|$4$|$\begin{aligned}&\mu_{1}-\mu_{2}\le \delta \\&\mu_{1}-\mu_{2}\ge \delta \\&\mu_{1}-\mu_{2}= \delta\\&(\sigma_{1}^{2}=\sigma_{2}^{2}=\sigma^{2}æœªçŸ¥) \end{aligned}$|$\begin{aligned}&t=\frac{\overline{X}-\overline{Y}-\delta}{S_{w}\sqrt{\frac{1}{n1}+\frac{1}{n2}}} \\ & S_{w}^{2}=\frac{(n1-1)S_{1}^{2}+(n2-1)S_{2}^{2}}{n1+n2-2} \end{aligned}$|$\begin{aligned}&\mu_{1}-\mu_{2}> \delta \\&\mu_{1}-\mu_{2}< \delta \\&\mu_{1}-\mu_{2}\ne \delta \end{aligned}$|$\begin{aligned}&t\ge t_{\alpha}(n1+n2-2) \\&t \le -t_{\alpha}(n1+n2-2)\\&\|t\| \ge t_{\alpha/2}(n1+n2-2) \end{aligned}$|
|$5$|$\begin{aligned}&\sigma_{1}^{2}\le \sigma_{2}^{2} \\&\sigma_{1}^{2}\ge \sigma_{2}^{2}\\ &\sigma_{1}^{2}= \sigma_{2}^{2}\\ &(\mu æœªçŸ¥) \end{aligned}$|$\begin{aligned}\chi^{2}=\frac{(n-1)S^{2}}{\sigma_{0}^{2}} \end{aligned}$|$\begin{aligned}&\sigma_{1}^{2}>\sigma_{2}^{2} \\&\sigma_{1}^{2}< \sigma_{2}^{2}\\ &\sigma_{1}^{2}\ne \sigma_{2}^{2} \end{aligned}$|$\begin{aligned}&\chi^{2}\ge \chi_{\alpha}^{2}(n-1) \\&\chi^{2}\le \chi_{1-\alpha}^{2}(n-1) \\&\chi^{2}\ge \chi_{\alpha/2}^{2}(n-1)æˆ–\\&\chi^{2}\le \chi_{1-\alpha/2}^{2}(n-1) \end{aligned}$|
|$6$|$\begin{aligned}&\sigma_{1}^{2}\le \sigma_{2}^{2} \\&\sigma_{1}^{2}\ge \sigma_{2}^{2}\\ &\sigma_{1}^{2}= \sigma_{2}^{2}\\ &(\mu_{1},\mu_{2}æœªçŸ¥)\end{aligned}$|$\begin{aligned}F=\frac{S_{1}^{2}}{S_{2}^{2}} \end{aligned}$|$\begin{aligned}&\sigma_{1}^{2}>\sigma_{2}^{2} \\&\sigma_{1}^{2}< \sigma_{2}^{2}\\ &\sigma_{1}^{2}\ne \sigma_{2}^{2} \end{aligned}$|$\begin{aligned}&F\ge F_{\alpha}(n1-1, n2-1) \\&F\le F_{1-\alpha}(n1-1, n2-1) \\ & F\ge F_{\alpha/2}(n1-1, n2-1)æˆ–\\&F\le F_{1-\alpha/2}(n1-1, n2-1)\end{aligned}$|
|$7$|$\begin{aligned}&\mu_{D}\le 0\\&\mu_{D}\ge 0 \\&\mu_{D}= 0\\&(æˆå¯¹æ•°æ®)\end{aligned}$|$\begin{aligned}t=\frac{\overline{D}-0}{S_{D}/\sqrt{n}} \end{aligned}$|$\begin{aligned}&\mu_{D}> 0\\&\mu_{D}< 0 \\&\mu_{D}\ne 0 \end{aligned}$|$\begin{aligned}&t\ge t_{\alpha}(n-1) \\&t\le -t_{\alpha}(n-1)\\&\|t\|\ge t_{\alpha/2}(n-1) \end{aligned}$|

> ç½®ä¿¡åŒºé—´ä¸å‡è®¾æ£€éªŒä¹‹é—´çš„å…³ç³», å‡è®¾ç½®ä¿¡åŒºé—´$(\underline{\theta}, \overline{\theta})$ï¼Œæ˜¾è‘—æ€§æ°´å¹³ä¸º$\alpha$
> - 1. æ£€éªŒé—®é¢˜$$H_{0}: \theta=\theta_{0};\quad H_{0}: \theta\ne \theta_{0}$$ è‹¥æ£€éªŒç»Ÿè®¡é‡åœ¨åŒºé—´$(\underline{\theta}, \overline{\theta})$å†…ï¼Œåˆ™æ¥å—$H_{0}$ï¼Œå¦åˆ™ï¼Œæ‹’ç»$H_{0}$ã€‚
> - 2. æ£€éªŒé—®é¢˜$$H_{0}: \theta\ge \theta_{0};\quad H_{0}: \theta < \theta_{0}$$ è‹¥æ£€éªŒç»Ÿè®¡é‡åœ¨åŒºé—´$(-\infty, \overline{\theta})$å†…ï¼Œåˆ™æ¥å—$H_{0}$ï¼Œå¦åˆ™ï¼Œæ‹’ç»$H_{0}$ã€‚
> - 3. æ£€éªŒé—®é¢˜$$H_{0}: \theta\le \theta_{0};\quad H_{0}: \theta > \theta_{0}$$ è‹¥æ£€éªŒç»Ÿè®¡é‡åœ¨åŒºé—´$(\underline{\theta}, \infty)$å†…ï¼Œåˆ™æ¥å—$H_{0}$ï¼Œå¦åˆ™ï¼Œæ‹’ç»$H_{0}$ã€‚

## 1.11 å‡è®¾æ£€éªŒä¹‹ä¼¼ç„¶æ¯”æ£€éªŒä¸Bootstrapæ–¹æ³•

* ä¼¼ç„¶æ¯”æ£€éªŒï¼š

&emsp;&emsp;å®šä¹‰ï¼ˆå¹¿ä¹‰ä¼¼ç„¶æ¯”ï¼‰ï¼šè®¾  $x_{1}, \cdots, x_{n}$  ä¸ºæ¥è‡ªå¯†åº¦å‡½æ•°ä¸º  $p(x ; \theta), \theta \in \Theta$  çš„æ ·æœ¬ï¼Œè€ƒè™‘æ£€éªŒé—®é¢˜
 $$
 H_{0}: \theta \in \Theta_{0} \quad v s \quad H_{1}: \theta \in \Theta_{1}=\Theta-\Theta_{0}
 $$  
 ä»¤
 $$\Lambda\left(x_{1}, \cdots, x_{n}\right)=\frac{\sup _{\theta \in \Theta} p\left(x_{1}, \cdots, x_{n} ; \theta\right)}{\sup _{\theta \in \Theta_{0}} p\left(x_{1}, \cdots, x_{n} ; \theta\right)}  \quad \sup è¡¨ç¤ºæœ€å°ä¸Šç•Œ$$
é‚£ä¹ˆç§°å®ƒä¸ºå‡è®¾æ£€éªŒé—®é¢˜çš„å¹¿ä¹‰ä¼¼ç„¶æ¯”ã€‚

&emsp;&emsp;ç”±ä¸Šå¼å¯ä»¥çœ‹å‡ºï¼Œå¹¿ä¹‰ä¼¼ç„¶æ¯”å®šä¹‰ä¸‹çš„åˆ†å­åˆ†æ¯éƒ½æœ‰ä¸€ä¸ªä¸Šç¡®ç•Œï¼ˆ$\sup$ï¼‰çš„ç¬¦å·ï¼Œä»”ç»†è§‚å¯Ÿï¼Œåˆ†å­å°±ç›¸å½“äºåœ¨**å…¨å‚æ•°ç©ºé—´**ä¸‹å–è”åˆæ¦‚ç‡å¯†åº¦çš„æœ€å¤§å€¼ï¼Œåˆ†æ¯ç›¸å½“äºåœ¨**åŸå‡è®¾å‚æ•°ç©ºé—´**ä¸‹å–è”åˆæ¦‚ç‡å¯†åº¦çš„ æœ€å¤§å€¼ï¼Œæ‰€ä»¥è¿™ä¸ªæ¯”å€¼å°±æ˜¯ä¸¤ä¸ªæå¤§ä¼¼ç„¶ä¼°è®¡çš„æ¯”å€¼ã€‚ç›´è§‚æ¥çœ‹ï¼Œå¦‚æœåŸå‡è®¾æ˜¯æ­£ç¡®çš„ï¼Œé‚£ä¹ˆå‚æ•° åº”è¯¥ä¼šè½åœ¨åŸå‡è®¾çš„å‚æ•°ç©ºé—´å†…ï¼Œæ¢å¥è¯è¯´ï¼Œåˆ†å­çš„æœ€å¤§å€¼å¯¹åº”çš„å‚æ•°åº”è¯¥è½åœ¨  $\Theta_{0}$  ï¼Œæ‰€ä»¥è¿™ä¸ª æ¯”å€¼å°±ä¸ä¼šå¤ªå¤§ã€‚ä½†æ˜¯ï¼Œåè¿‡æ¥è¯´ï¼Œå¦‚æœåŸå‡è®¾åº”è¯¥è¢«æ‹’ç»ï¼Œé‚£ä¹ˆå‚æ•°å°±æœ‰å¾ˆå¤§å¯èƒ½è½åœ¨æ‹’ç»åŸŸï¼Œ é‚£ä¹ˆå…¨å‚æ•°ç©ºé—´çš„æœ€å¤§å€¼å°±ä¼šåœ¨  $\theta \in \Theta_{1}$  ä¸­å–åˆ°ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æ¯”å€¼å°±ä¼šå˜å¤§ã€‚æ‰€ä»¥å¯ä»¥çœ‹å‡º æ¥ï¼Œæ‹’ç»åŸŸé¡ºç†æˆç« çš„åº”è¯¥è®¾ç½®ä¸º
$$
W=\left\{\Lambda\left(x_{1}, \cdots, x_{n}\right) \geq c\right\}
$$
å…¶ä¸­ä¸´ç•Œå€¼  $c$  è¦æ»¡è¶³  $P_{\theta}\left(\Lambda\left(x_{1}, \cdots, x_{n}\right) \geq c\right) \leq \alpha, \forall \theta \in \Theta_{0}$. 

>ğŸ’¡ $2ln \Lambda (\left(x_{1}, \cdots, x_{n}\right))$æœä»$\chi^{2}$åˆ†å¸ƒï¼Œè‡ªç”±åº¦ä¸ºç‹¬ç«‹å‚æ•°çš„ä¸ªæ•°ï¼ˆéœ€è¦æ£€éªŒå‚æ•°çš„ç»´åº¦ï¼‰

ğŸ”¥ä¾‹å­:å‡è®¾è§‚å¯ŸæŸç§ç–¾ç—…çš„å‘ç”Ÿæƒ…å†µ:  $n=100$  äººä¸­å‘ç”Ÿäº†  $k=10$  ä¸ªäº‹ä»¶ã€‚å‡å®šæ•°æ®æœä»äºŒé¡¹åˆ†å¸ƒ, ç†è®ºå·²çŸ¥äººç¾¤ä¸­æ¯ä¸ªäººå‘ç”Ÿè¯¥äº‹ä»¶çš„æ¦‚ç‡ä¸º  $\pi_{0}=0.2$  ã€‚è¯•å¯¹è¯¥å‡è®¾åšä¼¼ç„¶æ¯”å‡è®¾æ£€éªŒï¼ˆæ˜¾è‘—æ€§æ°´å¹³$\alpha=0.05$ï¼‰?

ğŸ¦Šè§£ï¼š
1. ä½œå‡ºå‡è®¾
$$
H_{0}: \pi = \pi_{0}=0.2; \quad H_{1}: \pi\ne \pi_{0}=0.2
$$
2. å†™å‡ºå‚æ•°ç©ºé—´
$$
\Theta_{0}=\{\pi_{0}\}, \quad \Theta = \{\pi, \pi \in \textbf{R}\}
$$
3. è®¡ç®—å…¨å‚æ•°ç©ºé—´ï¼ˆ$\Theta$ï¼‰ä¸‹çš„æå¤§ä¼¼ç„¶ä¼°è®¡
$$
\begin{aligned}
&f(x) = C_{n}^{k}p^{k}(1-p)^{n-k}\\
&ln f(x) = lnC_{n}^{k} + lnp^{k}+ ln(1-p)^{n-k}\\
&ä»¤ \frac{d}{dp}ln f(x) = 0 \\
&è§£å¾— \\
&p = \frac{k}{n}
\end{aligned}
$$
4. åœ¨$H_{0}$å‡è®¾ä¸‹ï¼Œ$p = 0.2$ï¼Œè®¡ç®—$2ln\frac{\sup_{\theta\in\Theta }p(x_{1}, x_{2}, \cdots, x_{n})}{\sup_{\theta\in\Theta_{0}} p(x_{1}, x_{2}, \cdots, x_{n})}$ï¼Œä¸º
$$
check = 2ln\frac{k/n}{0.2}
$$
5. å› ä¸º
$$2ln\frac{\sup_{\theta\in\Theta }p(x_{1}, x_{2}, \cdots, x_{n})}{\sup_{\theta\in\Theta_{0}} p(x_{1}, x_{2}, \cdots, x_{n})}\sim \chi^{2}(1)$$
6. å› æ­¤ï¼Œæ‹’ç»åŸŸä¸º
$$
check \ge \chi_{\alpha/2}(1) æˆ– check \le \chi_{1 - \alpha/2}(1)
$$
7. åˆ¤æ–­$check$å€¼æ˜¯å¦åœ¨æ‹’ç»åŸŸï¼Œè‹¥åœ¨ï¼Œåˆ™æ‹’ç»$H_{0}$ï¼Œå¦åˆ™æ¥å—$H_{0}$.

pythonä»£ç ï¼ˆæ±‚è§£ä¸Šé¢˜ï¼‰


```python
import numpy as np 
from scipy.stats import chi2 

p0 = 0.2
n = 100
k = 10
alpha = 0.05
check = 2 * np.log((k/n)/p0)
left = chi2.ppf(df=1, q=alpha/2)
right = chi2.ppf(df=1, q=(1-alpha/2))
print("ä¼¼ç„¶æ¯”ç»Ÿè®¡é‡ä¸º:{}".format(check))
print("æ‹’ç»åŸŸä¸º(0, {})æˆ–({}, oo)".format(left, right))
if check <= left or right >= right:
    print("æ‹’ç»å‡è®¾H0, å³æ¯ä¸ªäººå‘ç”Ÿè¯¥äº‹ä»¶å¾—æ¦‚ç‡ä¸ä¸º0.2")
```

    ä¼¼ç„¶æ¯”ç»Ÿè®¡é‡ä¸º:-1.3862943611198906
    æ‹’ç»åŸŸä¸º(0, 0.0009820691171752555)æˆ–(5.023886187314888, oo)
    æ‹’ç»å‡è®¾H0, å³æ¯ä¸ªäººå‘ç”Ÿè¯¥äº‹ä»¶å¾—æ¦‚ç‡ä¸ä¸º0.2
    

* Bootstrapæ–¹æ³•ï¼šåœ¨ä¸Šè¿°æ–¹æ³•ä¸­ï¼Œå¦‚æœåˆ†å¸ƒçš„è‡ªç”±åº¦éš¾ä»¥ç¡®å®šï¼Œè¿™ä¸ªæ–¹æ³•å°†éš¾ä»¥è¿›è¡Œä¸‹å»ã€‚æ¢å¥è¯è¯´ï¼Œå½“ç¢°åˆ°æŸä¸ªç»Ÿè®¡é‡çš„åˆ†å¸ƒéš¾ä»¥ç¡®å®šæˆ–è€…æœªçŸ¥çš„æ—¶å€™å¦‚ä½•åšå‡è®¾æ£€éªŒå‘¢ï¼ŸBootstrapæ–¹æ³•å°±æ˜¯åœ¨è¿™ä¸€èƒŒæ™¯ä¸‹äº§ç”Ÿçš„ã€‚è®¾æ€»ä½“å¾—åˆ†å¸ƒ$F$æœªçŸ¥ï¼Œä½†å·²ç»æœ‰ä¸€ä¸ªå®¹é‡ä¸º$n$å¾—æ¥è‡ªåˆ†å¸ƒ$F$çš„æ•°æ®æ ·æœ¬ï¼Œè‡ªè¿™ä¸€æ ·æœ¬æŒ‰æ”¾å›æŠ½æ ·çš„æ–¹æ³•æŠ½å–ä¸€ä¸ªå®¹é‡ä¸º$n$çš„æ ·æœ¬ï¼Œè¿™ç§æ ·æœ¬ç§°ä¸º**bootstrap**æ ·æœ¬æˆ–è‡ªåŠ©æ ·æœ¬ï¼Œç›¸ç»§åœ°ã€ç‹¬ç«‹åœ°è‡ªåŸå§‹æ ·æœ¬ä¸­æŠ½å–å¾ˆå¤šä¸ªbootstrapæ ·æœ¬ï¼Œåˆ©ç”¨è¿™äº›æ ·æœ¬å¯¹æ€»ä½“$F$è¿›è¡Œç»Ÿè®¡æ¨æ–­ï¼Œè¿™ç§æ–¹æ³•ç§°ä¸º**éå‚æ•°bootstrapæ–¹æ³•**ã€‚

> bootstrapç½®ä¿¡åŒºé—´ï¼šè®¾$X=X_{1}, X_{2}, \cdots, X_{n}$æ˜¯æ¥è‡ªæ€»ä½“$F$å®¹é‡ä¸º$n$çš„æ ·æœ¬ï¼Œ$x=x_{1}, x_{2}, \cdots, x_{n}$æ˜¯ä¸€ä¸ªå·²çŸ¥çš„æ ·æœ¬å€¼ï¼Œ$F$ä¸­å«æœ‰æœªçŸ¥å‚æ•°$\theta$ï¼Œ$\hat{\theta}=\hat{\theta}(X_{1}, X_{2}, \cdots, X_{n})$æ˜¯$\theta$çš„ä¼°è®¡é‡ï¼Œ$\theta$çš„ç½®ä¿¡æ°´å¹³ä¸º$1-\alpha$ï¼ˆæ˜¾è‘—æ€§æ°´å¹³ä¸º$\alpha$ï¼‰çš„ç½®ä¿¡åŒºé—´ä¸º:ç›¸ç»§åœ°ã€ç‹¬ç«‹åœ°ä»æ ·æœ¬$x=x_{1}, x_{2}, \cdots, x_{n}$ä¸­æŠ½å‡ºBä¸ªå®¹é‡ä¸ºnçš„bootstrapæ ·æœ¬ï¼Œå¯¹äºæ¯ä¸ªæ ·æœ¬æ±‚å‡ºçš„$\theta$çš„bootstrapä¼°è®¡ï¼š$\hat{\theta_{1}}, \hat{\theta_{2}}, \cdots, \hat{\theta_{n}}$,å°†ä»–ä»¬ä»å°åˆ°å¤§æ’åºï¼š$$\hat{\theta_{(1)}}<\hat{\theta_{(2)}}< \cdots< \hat{\theta_{(n)}}$$ ç½®ä¿¡åŒºé—´å–$$(\hat{\theta}(k_{1}), \hat{\theta}(k_{2}))$$å…¶ä¸­ï¼Œ$k_{1}=[B \frac{\alpha}{2}], k_{2}=[B (1-\frac{\alpha}{2})], \quad ([ \cdot]è¡¨ç¤ºå–æ•´)$

ğŸ”¥ä¾‹å­ï¼šæŸå·¥å‚ç”Ÿäº§ä»¥å‘å…‰äº§å“ï¼Œå‘å…‰äº§å“çš„å‘å…‰æ—¶é•¿æœä»æ­£æ€åˆ†å¸ƒ  $N\left(\mu, \sigma^{2}\right)$  ï¼Œäº§å“çš„å‘å…‰æ—¶é•¿è®¾å®šå‡å€¼ä¸º  $250 \mathrm{~h}$  ã€‚ç°åœ¨ä»ä¸€æ‰¹äº§å“ä¸­æŠ½å– $10$ ä¸ªäº§å“ï¼Œæµ‹å¾—å‘å…‰æ—¶é•¿ä¸ºï¼ˆå•ä½ ä¸º: $ h  $) :

$$248.8, \quad 249.2, \quad 250.7, \quad 251.2, \quad 248.0, \quad 253.0, \quad 248.9, \quad 250.2, \quad 251.2, \quad 249.2$$

é—®è¯¥å‚çš„å‘å…‰äº§å“æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼ˆæ˜¾è‘—æ€§æ°´å¹³$\alpha = 0.05$ï¼‰?

ğŸ¦Šè§£ï¼šè¯¥é—®é¢˜ä¸ºå·¦è¾¹æ£€éªŒï¼Œå•ä¾§ç½®ä¿¡åŒºé—´çš„å½¢å¼åº”ä¸º$(a, +oo)$

1. ä½œå‡ºå‡è®¾
$$
H_{0}:\mu \ge \mu_{0}=250; \quad H_{1}:\mu < \mu_{0}=250
$$
2. ç¡®å®šæ£€éªŒç»Ÿè®¡é‡$\overline{x}$
3. è¿›è¡Œ$B$æ¬¡bootstrapé‡‡æ ·å¹¶è®¡ç®—å‚æ•°$\mu_{i}, (i=1, 2, \cdots, B)$åä»å°åˆ°å¤§æ’åº$\mu_{(1)}<\mu_{(2)}<\cdots<\mu_{(B)}$
4. å–$\alpha/2, 1-\alpha/2$åˆ†ä½ç‚¹ï¼Œå¾—åˆ°ç½®ä¿¡åŒºé—´$(\hat{\theta}(k_{1}), \hat{\theta}(k_{2}))ï¼ˆè¿™æ˜¯åŒè¾¹æ£€éªŒçš„ç½®ä¿¡åŒºé—´ï¼Œè¿™é‡Œé¡»ä¿®æ”¹ä¸ºå•è¾¹ï¼‰$, $k_{1}=[B \frac{\alpha}{2}], k_{2}=[B (1-\frac{\alpha}{2})], \quad ([ \cdot]è¡¨ç¤ºå–æ•´)$
5. åˆ¤æ–­æ£€éªŒç»Ÿè®¡é‡æ˜¯å¦åœ¨ç½®ä¿¡åŒºé—´å†…ï¼Œè‹¥åœ¨æ¥å—$h_{0}$ï¼Œå¦åˆ™ï¼Œæ‹’ç»$H_{0}$.


pythonä»£ç (è®¡ç®—ä¸Šé¢˜)


```python
import numpy as np

# ä¾‹é¢˜ä¸ºå·¦è¾¹æ£€éªŒï¼Œå•ä¾§ç½®ä¿¡åŒºé—´ä¸ºï¼ˆk1, ooï¼‰,æ‹’ç»åŸŸä¸º(-oo, k1]

mu0 = 250
alpha = 0.05
B = 1000
x = [248.8, 249.2, 250.7, 251.2, 248.0, 253.0, 248.9, 250.2, 251.2, 249.2]
x_mean= np.mean(x)
params = []
for i in range(B):
    x_resample = np.random.choice(x, len(x), replace=True)
    params.append(np.mean(x_resample))

params = np.sort(params)

k1 = int(B*alpha)
left = params[k1-1]
# right = np.percentile(params, (1-alpha)*100-1)
print("æ£€éªŒç»Ÿè®¡é‡ä¸º:{}".format(x_mean))
print("æ‹’ç»åŸŸä¸º:(-oo, {}]".format(left))
if x_mean > left:
    print("æ¥å—H0, è¯¥å‚çš„å‘å…‰äº§å“ç¬¦åˆè¦æ±‚")
else:
    print("æ‹’ç»H0, è¯¥å‚çš„å‘å…‰äº§å“ä¸ç¬¦åˆè¦æ±‚")
```

    æ£€éªŒç»Ÿè®¡é‡ä¸º:250.03999999999996
    æ‹’ç»åŸŸä¸º:(-oo, 249.32000000000002]
    æ¥å—H0, è¯¥å‚çš„å‘å…‰äº§å“ç¬¦åˆè¦æ±‚
    
